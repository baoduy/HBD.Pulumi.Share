{"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/z_tests/_tools/Mocks.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/z_tests/_tools/Mocks.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":15},"end":{"line":26,"column":54}},"26":{"start":{"line":27,"column":20},"end":{"line":39,"column":1}},"27":{"start":{"line":28,"column":15},"end":{"line":28,"column":47}},"28":{"start":{"line":29,"column":4},"end":{"line":36,"column":5}},"29":{"start":{"line":30,"column":21},"end":{"line":30,"column":39}},"30":{"start":{"line":32,"column":18},"end":{"line":32,"column":54}},"31":{"start":{"line":32,"column":35},"end":{"line":32,"column":53}},"32":{"start":{"line":33,"column":8},"end":{"line":35,"column":9}},"33":{"start":{"line":34,"column":12},"end":{"line":34,"column":30}},"34":{"start":{"line":38,"column":4},"end":{"line":38,"column":16}},"35":{"start":{"line":40,"column":0},"end":{"line":62,"column":3}},"36":{"start":{"line":42,"column":21},"end":{"line":42,"column":45}},"37":{"start":{"line":44,"column":8},"end":{"line":59,"column":10}},"38":{"start":{"line":61,"column":20},"end":{"line":61,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":27,"column":20},"end":{"line":27,"column":21}},"loc":{"start":{"line":27,"column":31},"end":{"line":39,"column":1}},"line":27},"7":{"name":"(anonymous_7)","decl":{"start":{"line":32,"column":28},"end":{"line":32,"column":29}},"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":53}},"line":32},"8":{"name":"(anonymous_8)","decl":{"start":{"line":41,"column":17},"end":{"line":41,"column":18}},"loc":{"start":{"line":41,"column":27},"end":{"line":60,"column":5}},"line":41},"9":{"name":"(anonymous_9)","decl":{"start":{"line":61,"column":10},"end":{"line":61,"column":11}},"loc":{"start":{"line":61,"column":20},"end":{"line":61,"column":31}},"line":61}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":28,"column":15},"end":{"line":28,"column":47}},"type":"binary-expr","locations":[{"start":{"line":28,"column":15},"end":{"line":28,"column":25}},{"start":{"line":28,"column":29},"end":{"line":28,"column":47}}],"line":28},"17":{"loc":{"start":{"line":29,"column":4},"end":{"line":36,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":36,"column":5}},{"start":{"line":29,"column":4},"end":{"line":36,"column":5}}],"line":29},"18":{"loc":{"start":{"line":33,"column":8},"end":{"line":35,"column":9}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":35,"column":9}},{"start":{"line":33,"column":8},"end":{"line":35,"column":9}}],"line":33},"19":{"loc":{"start":{"line":50,"column":24},"end":{"line":57,"column":28}},"type":"cond-expr","locations":[{"start":{"line":51,"column":22},"end":{"line":51,"column":60}},{"start":{"line":52,"column":22},"end":{"line":57,"column":28}}],"line":50},"20":{"loc":{"start":{"line":52,"column":22},"end":{"line":57,"column":28}},"type":"cond-expr","locations":[{"start":{"line":53,"column":26},"end":{"line":56,"column":25}},{"start":{"line":57,"column":26},"end":{"line":57,"column":28}}],"line":52}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/z_tests/_tools/Mocks.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/z_tests/_tools/Mocks.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uDAAyC;AAEzC,MAAM,WAAW,GAAG,CAAC,KAAU,EAAE,EAAE;IACjC,IAAI,IAAI,GAAW,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,YAAY,CAAC;IAEpD,IAAI,CAAC,IAAI,EAAE;QACT,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAChC,sDAAsD;QACtD,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QAE/C,IAAI,GAAG,EAAE;YACP,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;SACnB;KACF;IACD,yDAAyD;IACzD,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AAEF,kBAAe,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;IACrC,WAAW,EAAE,CACX,IAAqC,EAKrC,EAAE;QACF,MAAM,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACtC,wCAAwC;QAExC,OAAO;YACL,EAAE,EAAE,4DAA4D,IAAI,EAAE;YACtE,IAAI;YACJ,KAAK,EAAE;gBACL,IAAI;gBACJ,GAAG,IAAI,CAAC,MAAM;gBACd,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;oBAClC,CAAC,CAAC,sCAAsC;oBACxC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;wBACtB,CAAC,CAAC;4BACE,SAAS,EAAE,YAAY;4BACvB,UAAU,EAAE,YAAY;yBACzB;wBACH,CAAC,CAAC,EAAE;aACP;SACF,CAAC;IACJ,CAAC;IACD,IAAI,EAAE,CAAC,IAAiC,EAAE,EAAE,CAAC,IAAI,CAAC,MAAM;CACzD,CAAC,CAAC","sourcesContent":["import * as pulumi from '@pulumi/pulumi';\n\nconst tryFindName = (props: any) => {\n  let name: string = props.name || props.resourceName;\n\n  if (!name) {\n    const keys = Object.keys(props);\n    //Try to find the name that is not a resourceGroupName\n    let key = keys.find((k) => k.endsWith('Name'));\n\n    if (key) {\n      name = props[key];\n    }\n  }\n  //if (!name) console.error('Unable to find name', props);\n  return name;\n};\n\nexport default pulumi.runtime.setMocks({\n  newResource: (\n    args: pulumi.runtime.MockResourceArgs\n  ): {\n    id: string;\n    name: string;\n    state: any;\n  } => {\n    const name = tryFindName(args.inputs);\n    //console.log(`Mocks resource ${name}`);\n\n    return {\n      id: `/subscriptions/12345/resourceGroups/resr-group/providers/${name}`,\n      name,\n      state: {\n        name,\n        ...args.inputs,\n        result: args.type.includes('Random')\n          ? '5c1c5657-085b-41c8-8d11-de897e70eae7'\n          : name.endsWith('ssh')\n          ? {\n              publicKey: '1234567890',\n              privateKey: '1234567890',\n            }\n          : '',\n      },\n    };\n  },\n  call: (args: pulumi.runtime.MockCallArgs) => args.inputs,\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5982008187328efd294ff78ccff5a30ecfb26e30","contentHash":"3159996dc5ce342e8d99b95d898e29837eb08ba98554f3fd7a23f24d516d093a"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/ContainerRegistry/index.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/ContainerRegistry/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"25":{"start":{"line":26,"column":4},"end":{"line":26,"column":62}},"26":{"start":{"line":28,"column":0},"end":{"line":28,"column":62}},"27":{"start":{"line":29,"column":26},"end":{"line":29,"column":89}},"28":{"start":{"line":30,"column":26},"end":{"line":30,"column":77}},"29":{"start":{"line":31,"column":15},"end":{"line":31,"column":59}},"30":{"start":{"line":32,"column":17},"end":{"line":32,"column":44}},"31":{"start":{"line":33,"column":26},"end":{"line":33,"column":77}},"32":{"start":{"line":34,"column":23},"end":{"line":34,"column":58}},"33":{"start":{"line":38,"column":0},"end":{"line":128,"column":2}},"34":{"start":{"line":39,"column":4},"end":{"line":39,"column":42}},"35":{"start":{"line":40,"column":19},"end":{"line":40,"column":32}},"36":{"start":{"line":41,"column":24},"end":{"line":41,"column":43}},"37":{"start":{"line":42,"column":31},"end":{"line":42,"column":77}},"38":{"start":{"line":43,"column":33},"end":{"line":43,"column":81}},"39":{"start":{"line":44,"column":45},"end":{"line":62,"column":6}},"40":{"start":{"line":54,"column":55},"end":{"line":54,"column":79}},"41":{"start":{"line":63,"column":4},"end":{"line":73,"column":5}},"42":{"start":{"line":64,"column":8},"end":{"line":72,"column":11}},"43":{"start":{"line":74,"column":4},"end":{"line":115,"column":5}},"44":{"start":{"line":75,"column":8},"end":{"line":114,"column":11}},"45":{"start":{"line":77,"column":12},"end":{"line":78,"column":23}},"46":{"start":{"line":78,"column":16},"end":{"line":78,"column":23}},"47":{"start":{"line":80,"column":25},"end":{"line":83,"column":14}},"48":{"start":{"line":84,"column":12},"end":{"line":90,"column":15}},"49":{"start":{"line":91,"column":12},"end":{"line":97,"column":15}},"50":{"start":{"line":98,"column":12},"end":{"line":105,"column":15}},"51":{"start":{"line":106,"column":12},"end":{"line":113,"column":15}},"52":{"start":{"line":116,"column":4},"end":{"line":127,"column":6}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":56},"end":{"line":25,"column":57}},"loc":{"start":{"line":25,"column":71},"end":{"line":27,"column":1}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":38,"column":18},"end":{"line":38,"column":19}},"loc":{"start":{"line":38,"column":172},"end":{"line":128,"column":1}},"line":38},"8":{"name":"(anonymous_8)","decl":{"start":{"line":54,"column":46},"end":{"line":54,"column":47}},"loc":{"start":{"line":54,"column":55},"end":{"line":54,"column":79}},"line":54},"9":{"name":"(anonymous_9)","decl":{"start":{"line":75,"column":26},"end":{"line":75,"column":27}},"loc":{"start":{"line":75,"column":40},"end":{"line":114,"column":9}},"line":75}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":51}},{"start":{"line":25,"column":56},"end":{"line":27,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":61}},"type":"cond-expr","locations":[{"start":{"line":26,"column":37},"end":{"line":26,"column":40}},{"start":{"line":26,"column":43},"end":{"line":26,"column":61}}],"line":26},"18":{"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":33}},"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":33}}],"line":26},"19":{"loc":{"start":{"line":38,"column":33},"end":{"line":38,"column":57}},"type":"default-arg","locations":[{"start":{"line":38,"column":41},"end":{"line":38,"column":57}}],"line":38},"20":{"loc":{"start":{"line":38,"column":59},"end":{"line":38,"column":96}},"type":"default-arg","locations":[{"start":{"line":38,"column":65},"end":{"line":38,"column":96}}],"line":38},"21":{"loc":{"start":{"line":38,"column":98},"end":{"line":38,"column":121}},"type":"default-arg","locations":[{"start":{"line":38,"column":117},"end":{"line":38,"column":121}}],"line":38},"22":{"loc":{"start":{"line":38,"column":123},"end":{"line":38,"column":134}},"type":"default-arg","locations":[{"start":{"line":38,"column":130},"end":{"line":38,"column":134}}],"line":38},"23":{"loc":{"start":{"line":50,"column":24},"end":{"line":60,"column":23}},"type":"cond-expr","locations":[{"start":{"line":51,"column":14},"end":{"line":59,"column":13}},{"start":{"line":60,"column":14},"end":{"line":60,"column":23}}],"line":50},"24":{"loc":{"start":{"line":50,"column":24},"end":{"line":50,"column":52}},"type":"binary-expr","locations":[{"start":{"line":50,"column":24},"end":{"line":50,"column":41}},{"start":{"line":50,"column":45},"end":{"line":50,"column":52}}],"line":50},"25":{"loc":{"start":{"line":53,"column":25},"end":{"line":55,"column":31}},"type":"cond-expr","locations":[{"start":{"line":54,"column":22},"end":{"line":54,"column":81}},{"start":{"line":55,"column":22},"end":{"line":55,"column":31}}],"line":53},"26":{"loc":{"start":{"line":56,"column":37},"end":{"line":58,"column":31}},"type":"cond-expr","locations":[{"start":{"line":57,"column":22},"end":{"line":57,"column":70}},{"start":{"line":58,"column":22},"end":{"line":58,"column":31}}],"line":56},"27":{"loc":{"start":{"line":63,"column":4},"end":{"line":73,"column":5}},"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":73,"column":5}},{"start":{"line":63,"column":4},"end":{"line":73,"column":5}}],"line":63},"28":{"loc":{"start":{"line":63,"column":8},"end":{"line":63,"column":70}},"type":"binary-expr","locations":[{"start":{"line":63,"column":8},"end":{"line":63,"column":25}},{"start":{"line":63,"column":29},"end":{"line":63,"column":49}},{"start":{"line":63,"column":53},"end":{"line":63,"column":70}}],"line":63},"29":{"loc":{"start":{"line":74,"column":4},"end":{"line":115,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":115,"column":5}},{"start":{"line":74,"column":4},"end":{"line":115,"column":5}}],"line":74},"30":{"loc":{"start":{"line":74,"column":8},"end":{"line":74,"column":37}},"type":"binary-expr","locations":[{"start":{"line":74,"column":8},"end":{"line":74,"column":17}},{"start":{"line":74,"column":21},"end":{"line":74,"column":37}}],"line":74},"31":{"loc":{"start":{"line":77,"column":12},"end":{"line":78,"column":23}},"type":"if","locations":[{"start":{"line":77,"column":12},"end":{"line":78,"column":23}},{"start":{"line":77,"column":12},"end":{"line":78,"column":23}}],"line":77}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":2,"16":2,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":2,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":2,"6":2,"7":0,"8":0,"9":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[2,0],"12":[2,2],"13":[0,0],"14":[0,0],"15":[0,0],"16":[1,1,1],"17":[2,0],"18":[2,2],"19":[0],"20":[0],"21":[0],"22":[0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/ContainerRegistry/index.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/ContainerRegistry/index.ts"],"names":[],"mappings":"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","sourcesContent":["import * as containerregistry from '@pulumi/azure-native/containerregistry';\nimport {\n  BasicResourceArgs,\n  KeyVaultInfo,\n  NetworkRulesProps,\n  ResourceGroupInfo,\n} from './../types.d';\nimport { DefaultResourceArgs } from '../types';\nimport creator from '../Core/ResourceCreator';\nimport * as global from '../Common/GlobalEnv';\nimport {\n  getAcrName,\n  getPasswordName,\n  getPrivateEndpointName,\n} from '../Common/Naming';\nimport PrivateEndpoint from '../VNet/PrivateEndpoint';\nimport { addCustomSecret } from '../KeyVault/CustomHelper';\n\ninterface Props extends DefaultResourceArgs {\n  name: string;\n  group?: ResourceGroupInfo;\n  adminUserEnabled?: boolean;\n  enableStorageAccount?: boolean;\n  vaultInfo?: KeyVaultInfo;\n  sku?: containerregistry.SkuName;\n  /**Only support Premium sku*/\n  network?: NetworkRulesProps;\n}\n\n/** The Azure Container Registry will be created at the GLobal Group.\n * Follow ReadMe file to setup the cleaning tasks for this Registry\n */\nexport default async ({\n  name,\n  group = global.groupInfo,\n  sku = containerregistry.SkuName.Basic,\n  adminUserEnabled = true,\n  lock = true,\n  vaultInfo,\n  network,\n  ...others\n}: Props) => {\n  name = getAcrName(name);\n\n  const urlKey = `${name}-url`;\n  const userNameKey = `${name}-user-name`;\n  const primaryPasswordKey = getPasswordName(name, 'primary');\n  const secondaryPasswordKey = getPasswordName(name, 'secondary');\n\n  const { resource, diagnostic, locker } = await creator(\n    containerregistry.Registry,\n    {\n      registryName: name,\n      ...group,\n\n      adminUserEnabled,\n      lock,\n      sku: { name: sku },\n      networkRuleSet:\n        sku === 'Premium' && network\n          ? {\n              defaultAction: containerregistry.DefaultAction.Allow,\n\n              ipRules: network.ipAddresses\n                ? network.ipAddresses.map((ip) => ({ iPAddressOrRange: ip }))\n                : undefined,\n\n              virtualNetworkRules: network.subnetId\n                ? [{ virtualNetworkResourceId: network.subnetId }]\n                : undefined,\n            }\n          : undefined,\n      ...others,\n    } as containerregistry.RegistryArgs & DefaultResourceArgs\n  );\n\n  if (sku === 'Premium' && network?.privateLink && network?.subnetId) {\n    PrivateEndpoint({\n      name: getPrivateEndpointName(name),\n      group,\n      privateDnsZoneName: 'privatelink.azurecr.io',\n      subnetId: network.subnetId,\n      ...network.privateLink,\n      linkServiceGroupIds: ['azurecr'],\n      resourceId: resource.id,\n    });\n  }\n\n  if (vaultInfo && adminUserEnabled) {\n    resource.id.apply(async (id) => {\n      //The Resource is not created in Azure yet.\n      if (!id) return;\n      //Only able to gert the secret once the resource is created.\n      const keys = await containerregistry.listRegistryCredentials({\n        registryName: name,\n        resourceGroupName: global.groupInfo.resourceGroupName,\n      });\n\n      await addCustomSecret({\n        name: urlKey,\n        value: `https://${name}.azurecr.io`,\n        vaultInfo,\n        contentType: 'Container Registry',\n        dependsOn: resource,\n      });\n\n      await addCustomSecret({\n        name: userNameKey,\n        value: keys.username!,\n        vaultInfo,\n        contentType: 'Container Registry',\n        dependsOn: resource,\n      });\n\n      await addCustomSecret({\n        name: primaryPasswordKey,\n        formattedName: true,\n        value: keys.passwords![0].value!,\n        vaultInfo,\n        contentType: 'Container Registry',\n        dependsOn: resource,\n      });\n\n      await addCustomSecret({\n        name: secondaryPasswordKey,\n        formattedName: true,\n        value: keys.passwords![1].value!,\n        vaultInfo,\n        contentType: 'Container Registry',\n        dependsOn: resource,\n      });\n    });\n  }\n\n  return {\n    name,\n    registry: resource as containerregistry.Registry,\n    vaultKeyNames: {\n      userNameKey,\n      primaryPasswordKey,\n      secondaryPasswordKey,\n      urlKey,\n    },\n    locker,\n    diagnostic,\n  };\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f4ae69c6c2fca5b13add193f1ea207033cae848b","contentHash":"e570d9ad96757679f63d5f450a124f781f45f74842d448393cd1954b9b348c8b"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/ResourceCreator.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/ResourceCreator.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":17},"end":{"line":6,"column":53}},"4":{"start":{"line":7,"column":18},"end":{"line":7,"column":44}},"5":{"start":{"line":8,"column":19},"end":{"line":8,"column":48}},"6":{"start":{"line":9,"column":20},"end":{"line":26,"column":1}},"7":{"start":{"line":11,"column":4},"end":{"line":12,"column":53}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":53}},"9":{"start":{"line":13,"column":15},"end":{"line":13,"column":47}},"10":{"start":{"line":14,"column":4},"end":{"line":22,"column":5}},"11":{"start":{"line":15,"column":21},"end":{"line":15,"column":39}},"12":{"start":{"line":17,"column":18},"end":{"line":17,"column":83}},"13":{"start":{"line":17,"column":35},"end":{"line":17,"column":82}},"14":{"start":{"line":18,"column":8},"end":{"line":21,"column":9}},"15":{"start":{"line":20,"column":12},"end":{"line":20,"column":30}},"16":{"start":{"line":23,"column":4},"end":{"line":24,"column":81}},"17":{"start":{"line":24,"column":8},"end":{"line":24,"column":81}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":16}},"19":{"start":{"line":29,"column":28},"end":{"line":29,"column":64}},"20":{"start":{"line":31,"column":17},"end":{"line":31,"column":52}},"21":{"start":{"line":32,"column":21},"end":{"line":32,"column":162}},"22":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"23":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"24":{"start":{"line":36,"column":8},"end":{"line":36,"column":95}},"25":{"start":{"line":39,"column":21},"end":{"line":39,"column":30}},"26":{"start":{"line":40,"column":4},"end":{"line":47,"column":5}},"27":{"start":{"line":41,"column":8},"end":{"line":46,"column":11}},"28":{"start":{"line":48,"column":4},"end":{"line":48,"column":44}},"29":{"start":{"line":50,"column":0},"end":{"line":50,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":20},"end":{"line":9,"column":21}},"loc":{"start":{"line":9,"column":48},"end":{"line":26,"column":1}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":17,"column":28},"end":{"line":17,"column":29}},"loc":{"start":{"line":17,"column":35},"end":{"line":17,"column":82}},"line":17},"3":{"name":"default_1","decl":{"start":{"line":28,"column":15},"end":{"line":28,"column":24}},"loc":{"start":{"line":28,"column":101},"end":{"line":49,"column":1}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":11,"column":4},"end":{"line":12,"column":53}},"type":"if","locations":[{"start":{"line":11,"column":4},"end":{"line":12,"column":53}},{"start":{"line":11,"column":4},"end":{"line":12,"column":53}}],"line":11},"4":{"loc":{"start":{"line":12,"column":15},"end":{"line":12,"column":52}},"type":"binary-expr","locations":[{"start":{"line":12,"column":15},"end":{"line":12,"column":38}},{"start":{"line":12,"column":42},"end":{"line":12,"column":52}}],"line":12},"5":{"loc":{"start":{"line":13,"column":15},"end":{"line":13,"column":47}},"type":"binary-expr","locations":[{"start":{"line":13,"column":15},"end":{"line":13,"column":33}},{"start":{"line":13,"column":37},"end":{"line":13,"column":47}}],"line":13},"6":{"loc":{"start":{"line":14,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":22,"column":5}},{"start":{"line":14,"column":4},"end":{"line":22,"column":5}}],"line":14},"7":{"loc":{"start":{"line":17,"column":35},"end":{"line":17,"column":82}},"type":"binary-expr","locations":[{"start":{"line":17,"column":35},"end":{"line":17,"column":53}},{"start":{"line":17,"column":57},"end":{"line":17,"column":82}}],"line":17},"8":{"loc":{"start":{"line":18,"column":8},"end":{"line":21,"column":9}},"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":21,"column":9}},{"start":{"line":18,"column":8},"end":{"line":21,"column":9}}],"line":18},"9":{"loc":{"start":{"line":23,"column":4},"end":{"line":24,"column":81}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":24,"column":81}},{"start":{"line":23,"column":4},"end":{"line":24,"column":81}}],"line":23},"10":{"loc":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},{"start":{"line":35,"column":4},"end":{"line":37,"column":5}}],"line":35},"11":{"loc":{"start":{"line":40,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":47,"column":5}},{"start":{"line":40,"column":4},"end":{"line":47,"column":5}}],"line":40}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1},"f":{"0":1,"1":0,"2":0,"3":0},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/ResourceCreator.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/ResourceCreator.ts"],"names":[],"mappings":";;;;;AAKA,sDAA8B;AAC9B,6CAAmD;AACnD,iDAAiD;AAEjD,MAAM,WAAW,GAAG,CAAC,KAAU,EAAE,eAAwB,EAAE,EAAE;IAC3D,mEAAmE;IACnE,IAAI,eAAe;QAAE,OAAO,KAAK,CAAC,iBAAiB,IAAI,KAAK,CAAC,IAAI,CAAC;IAElE,IAAI,IAAI,GAAG,KAAK,CAAC,YAAY,IAAI,KAAK,CAAC,IAAI,CAAC;IAE5C,IAAI,CAAC,IAAI,EAAE;QACT,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAChC,sDAAsD;QACtD,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,mBAAmB,CAAC,CAAC;QAE5E,IAAI,GAAG,EAAE;YACP,0CAA0C;YAC1C,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;SACnB;KACF;IAED,IAAI,CAAC,IAAI;QACP,MAAM,IAAI,KAAK,CAAC,+BAA+B,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;IAE3E,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AAWF,kCAAkC;AACnB,KAAK,oBAIlB,KAAa,EACb,EAAE,IAAI,EAAE,UAAU,EAAE,SAAS,EAAE,aAAa,EAAE,SAAS,EAAE,GAAG,KAAK,EAAU;IAE3E,MAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;IAC7D,iDAAiD;IAEjD,MAAM,IAAI,GAAG,WAAW,CAAC,KAAK,EAAE,eAAe,CAAC,CAAC;IAEjD,MAAM,QAAQ,GAAG,IAAI,KAAK,CACxB,IAAI,EACJ,EAAE,IAAI,EAAE,GAAG,KAAK,EAAE,IAAI,EAAE,sBAAW,EAAE,EACrC,EAAE,SAAS,EAAE,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE,mBAAmB,EAAE,IAAI,EAAE,CAC3E,CAAC;IAEF,iCAAiC;IACjC,IAAI,MAAM,GAAoD,SAAS,CAAC;IACxE,IAAI,IAAI,EAAE;QACR,MAAM,GAAG,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,UAAU,EAAE,QAAQ,CAAC,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,CAAC,CAAC;KACzE;IAED,yBAAyB;IACzB,IAAI,UAAU,GAAkC,SAAS,CAAC;IAC1D,IAAI,UAAU,EAAE;QACd,UAAU,GAAG,MAAM,IAAA,0BAAgB,EAAC;YAClC,IAAI;YACJ,gBAAgB,EAAE,QAAQ,CAAC,EAAE;YAC7B,GAAG,UAAU;YACb,SAAS,EAAE,QAAQ;SACpB,CAAC,CAAC;KACJ;IAED,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC;AAC1C,CAAC;AApCD,4BAoCC","sourcesContent":["import * as authorization from '@pulumi/azure-native/authorization';\nimport * as pulumi from '@pulumi/pulumi';\n\nimport { DefaultResourceArgs } from '../types';\nimport { DiagnosticSetting } from '@pulumi/azure-native/aadiam/diagnosticSetting';\nimport Locker from './Locker';\nimport { createDiagnostic } from '../Logs/Helpers';\nimport { defaultTags } from '../Common/AzureEnv';\n\nconst tryFindName = (props: any, isResourceGroup: boolean) => {\n  //If resource group then just return the resourceGroupName or name.\n  if (isResourceGroup) return props.resourceGroupName || props.name;\n\n  let name = props.resourceName || props.name;\n\n  if (!name) {\n    const keys = Object.keys(props);\n    //Try to find the name that is not a resourceGroupName\n    let key = keys.find((k) => k.endsWith('Name') && k !== 'resourceGroupName');\n\n    if (key) {\n      //console.log('Found the Name is: ', key);\n      name = props[key];\n    }\n  }\n\n  if (!name)\n    throw new Error('Name is not able to find in: ' + JSON.stringify(props));\n\n  return name;\n};\n\ntype ClassOf<T> = new (\n  name: string,\n  props: any,\n  opts?: pulumi.CustomResourceOptions\n) => T & {\n  id: pulumi.Output<string>;\n  urn: pulumi.Output<string>;\n};\n\n/** Create Resource with Locker */\nexport default async function <\n  TClass extends ClassOf<pulumi.CustomResource>,\n  TProps extends Omit<DefaultResourceArgs, 'name' | 'group'>\n>(\n  Class: TClass,\n  { lock, monitoring, dependsOn, ignoreChanges, importUri, ...props }: TProps\n) {\n  const isResourceGroup = Class.name.endsWith('ResourceGroup');\n  //console.log('Creating Resource: ', Class.name);\n\n  const name = tryFindName(props, isResourceGroup);\n\n  const resource = new Class(\n    name,\n    { name, ...props, tags: defaultTags },\n    { dependsOn, import: importUri, ignoreChanges, deleteBeforeReplace: true }\n  );\n\n  //Lock Azure Resource from Delete\n  let locker: authorization.ManagementLockByScope | undefined = undefined;\n  if (lock) {\n    locker = Locker({ name, resourceId: resource.id, dependsOn: resource });\n  }\n\n  //Azure DiagnosticSetting\n  let diagnostic: DiagnosticSetting | undefined = undefined;\n  if (monitoring) {\n    diagnostic = await createDiagnostic({\n      name,\n      targetResourceId: resource.id,\n      ...monitoring,\n      dependsOn: resource,\n    });\n  }\n\n  return { resource, locker, diagnostic };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1f5c322294ee052d0901a0d6e2997e2eae3beb4f","contentHash":"d89a1e8271d412a5645c2ce59865ba50a05c57b588140f4fcb96991876c0d892"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/Locker.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/Locker.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":22},"end":{"line":26,"column":81}},"26":{"start":{"line":28,"column":0},"end":{"line":36,"column":2}},"27":{"start":{"line":29,"column":14},"end":{"line":29,"column":32}},"28":{"start":{"line":30,"column":4},"end":{"line":35,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":28,"column":18},"end":{"line":28,"column":19}},"loc":{"start":{"line":28,"column":118},"end":{"line":36,"column":1}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":28,"column":39},"end":{"line":28,"column":83}},"type":"default-arg","locations":[{"start":{"line":28,"column":47},"end":{"line":28,"column":83}}],"line":28},"17":{"loc":{"start":{"line":28,"column":85},"end":{"line":28,"column":99}},"type":"default-arg","locations":[{"start":{"line":28,"column":95},"end":{"line":28,"column":99}}],"line":28}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":0,"28":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0],"17":[0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/Locker.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Core/Locker.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,kFAAoE;AAYpE,4CAA4C;AAC5C,kBAAe,CAAC,EACd,IAAI,EACJ,UAAU,EACV,KAAK,GAAG,aAAa,CAAC,SAAS,CAAC,YAAY,EAC5C,OAAO,GAAG,IAAI,EACd,SAAS,GACH,EAAE,EAAE;IACV,MAAM,CAAC,GAAG,GAAG,IAAI,IAAI,KAAK,EAAE,CAAC;IAE7B,OAAO,IAAI,aAAa,CAAC,qBAAqB,CAC5C,IAAI,EACJ;QACE,QAAQ,EAAE,CAAC;QACX,KAAK;QACL,KAAK,EAAE,UAAU;QACjB,KAAK,EAAE,QAAQ,IAAI,SAAS,KAAK,EAAE;KACpC,EACD,EAAE,SAAS,EAAE,OAAO,EAAE,CACvB,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import * as authorization from '@pulumi/azure-native/authorization';\nimport * as pulumi from '@pulumi/pulumi';\nimport { Input, Resource } from '@pulumi/pulumi';\n\ninterface Props {\n  name: string;\n  resourceId: pulumi.Output<string>;\n  level?: authorization.LockLevel;\n  protect?: boolean;\n  dependsOn?: Input<Input<Resource>[]> | Input<Resource>;\n}\n\n/** Lock Delete from Resource group level.*/\nexport default ({\n  name,\n  resourceId,\n  level = authorization.LockLevel.CanNotDelete,\n  protect = true,\n  dependsOn,\n}: Props) => {\n  const n = `${name}-${level}`;\n\n  return new authorization.ManagementLockByScope(\n    name,\n    {\n      lockName: n,\n      level,\n      scope: resourceId,\n      notes: `Lock ${name} from ${level}`,\n    },\n    { dependsOn, protect }\n  );\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2351a16774acb7c903d6c8b65b8c01ac1efe44f8","contentHash":"5d0834481cd8c0760bbf0002d55b5de3d59d963ed9a4cf3f548bc392bfa8825e"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Logs/Helpers.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Logs/Helpers.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":144}},"26":{"start":{"line":27,"column":14},"end":{"line":27,"column":52}},"27":{"start":{"line":28,"column":15},"end":{"line":28,"column":60}},"28":{"start":{"line":29,"column":17},"end":{"line":29,"column":42}},"29":{"start":{"line":30,"column":19},"end":{"line":30,"column":48}},"30":{"start":{"line":31,"column":20},"end":{"line":31,"column":50}},"31":{"start":{"line":32,"column":17},"end":{"line":32,"column":44}},"32":{"start":{"line":33,"column":17},"end":{"line":33,"column":46}},"33":{"start":{"line":34,"column":17},"end":{"line":34,"column":45}},"34":{"start":{"line":35,"column":25},"end":{"line":70,"column":1}},"35":{"start":{"line":37,"column":4},"end":{"line":40,"column":5}},"36":{"start":{"line":38,"column":8},"end":{"line":38,"column":98}},"37":{"start":{"line":39,"column":8},"end":{"line":39,"column":25}},"38":{"start":{"line":42,"column":4},"end":{"line":45,"column":5}},"39":{"start":{"line":43,"column":8},"end":{"line":43,"column":72}},"40":{"start":{"line":44,"column":8},"end":{"line":44,"column":25}},"41":{"start":{"line":46,"column":14},"end":{"line":46,"column":28}},"42":{"start":{"line":47,"column":4},"end":{"line":69,"column":22}},"43":{"start":{"line":55,"column":44},"end":{"line":59,"column":13}},"44":{"start":{"line":63,"column":41},"end":{"line":67,"column":13}},"45":{"start":{"line":71,"column":0},"end":{"line":71,"column":44}},"46":{"start":{"line":72,"column":31},"end":{"line":77,"column":1}},"47":{"start":{"line":73,"column":4},"end":{"line":76,"column":7}},"48":{"start":{"line":78,"column":0},"end":{"line":78,"column":56}},"49":{"start":{"line":79,"column":24},"end":{"line":89,"column":1}},"50":{"start":{"line":80,"column":31},"end":{"line":80,"column":43}},"51":{"start":{"line":81,"column":27},"end":{"line":81,"column":68}},"52":{"start":{"line":82,"column":29},"end":{"line":82,"column":72}},"53":{"start":{"line":83,"column":45},"end":{"line":87,"column":6}},"54":{"start":{"line":88,"column":4},"end":{"line":88,"column":46}},"55":{"start":{"line":90,"column":0},"end":{"line":90,"column":42}},"56":{"start":{"line":91,"column":21},"end":{"line":97,"column":1}},"57":{"start":{"line":92,"column":17},"end":{"line":92,"column":54}},"58":{"start":{"line":93,"column":18},"end":{"line":93,"column":42}},"59":{"start":{"line":94,"column":15},"end":{"line":94,"column":187}},"60":{"start":{"line":95,"column":20},"end":{"line":95,"column":106}},"61":{"start":{"line":96,"column":4},"end":{"line":96,"column":40}},"62":{"start":{"line":98,"column":0},"end":{"line":98,"column":36}},"63":{"start":{"line":99,"column":26},"end":{"line":107,"column":1}},"64":{"start":{"line":100,"column":17},"end":{"line":100,"column":58}},"65":{"start":{"line":101,"column":18},"end":{"line":101,"column":42}},"66":{"start":{"line":102,"column":15},"end":{"line":102,"column":180}},"67":{"start":{"line":103,"column":20},"end":{"line":105,"column":19}},"68":{"start":{"line":106,"column":4},"end":{"line":106,"column":40}},"69":{"start":{"line":108,"column":0},"end":{"line":108,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":35,"column":25},"end":{"line":35,"column":26}},"loc":{"start":{"line":35,"column":150},"end":{"line":70,"column":1}},"line":35},"7":{"name":"(anonymous_7)","decl":{"start":{"line":55,"column":36},"end":{"line":55,"column":37}},"loc":{"start":{"line":55,"column":44},"end":{"line":59,"column":13}},"line":55},"8":{"name":"(anonymous_8)","decl":{"start":{"line":63,"column":33},"end":{"line":63,"column":34}},"loc":{"start":{"line":63,"column":41},"end":{"line":67,"column":13}},"line":63},"9":{"name":"(anonymous_9)","decl":{"start":{"line":72,"column":31},"end":{"line":72,"column":32}},"loc":{"start":{"line":72,"column":64},"end":{"line":77,"column":1}},"line":72},"10":{"name":"(anonymous_10)","decl":{"start":{"line":79,"column":24},"end":{"line":79,"column":25}},"loc":{"start":{"line":79,"column":62},"end":{"line":89,"column":1}},"line":79},"11":{"name":"(anonymous_11)","decl":{"start":{"line":91,"column":21},"end":{"line":91,"column":22}},"loc":{"start":{"line":91,"column":58},"end":{"line":97,"column":1}},"line":91},"12":{"name":"(anonymous_12)","decl":{"start":{"line":99,"column":26},"end":{"line":99,"column":27}},"loc":{"start":{"line":99,"column":65},"end":{"line":107,"column":1}},"line":99}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":35,"column":81},"end":{"line":35,"column":115}},"type":"default-arg","locations":[{"start":{"line":35,"column":101},"end":{"line":35,"column":115}}],"line":35},"17":{"loc":{"start":{"line":37,"column":4},"end":{"line":40,"column":5}},"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":40,"column":5}},{"start":{"line":37,"column":4},"end":{"line":40,"column":5}}],"line":37},"18":{"loc":{"start":{"line":37,"column":8},"end":{"line":37,"column":33}},"type":"binary-expr","locations":[{"start":{"line":37,"column":8},"end":{"line":37,"column":16}},{"start":{"line":37,"column":20},"end":{"line":37,"column":33}}],"line":37},"19":{"loc":{"start":{"line":42,"column":4},"end":{"line":45,"column":5}},"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":45,"column":5}},{"start":{"line":42,"column":4},"end":{"line":45,"column":5}}],"line":42},"20":{"loc":{"start":{"line":52,"column":26},"end":{"line":52,"column":60}},"type":"cond-expr","locations":[{"start":{"line":52,"column":36},"end":{"line":52,"column":45}},{"start":{"line":52,"column":48},"end":{"line":52,"column":60}}],"line":52},"21":{"loc":{"start":{"line":54,"column":17},"end":{"line":60,"column":23}},"type":"cond-expr","locations":[{"start":{"line":55,"column":14},"end":{"line":59,"column":15}},{"start":{"line":60,"column":14},"end":{"line":60,"column":23}}],"line":54},"22":{"loc":{"start":{"line":62,"column":14},"end":{"line":68,"column":23}},"type":"cond-expr","locations":[{"start":{"line":63,"column":14},"end":{"line":67,"column":15}},{"start":{"line":68,"column":14},"end":{"line":68,"column":23}}],"line":62},"23":{"loc":{"start":{"line":95,"column":20},"end":{"line":95,"column":106}},"type":"cond-expr","locations":[{"start":{"line":95,"column":32},"end":{"line":95,"column":94}},{"start":{"line":95,"column":97},"end":{"line":95,"column":106}}],"line":95},"24":{"loc":{"start":{"line":103,"column":20},"end":{"line":105,"column":19}},"type":"cond-expr","locations":[{"start":{"line":104,"column":10},"end":{"line":104,"column":75}},{"start":{"line":105,"column":10},"end":{"line":105,"column":19}}],"line":103}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":2,"16":2,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":1,"47":0,"48":1,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":1,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[2,0],"12":[2,2],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Logs/Helpers.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Logs/Helpers.ts"],"names":[],"mappings":"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","sourcesContent":["import * as azure from '@pulumi/azure';\nimport * as native from '@pulumi/azure-native';\nimport { Input, interpolate } from '@pulumi/pulumi';\n\nimport { subscriptionId } from '../Common/AzureEnv';\nimport { logGroupInfo } from '../Common/GlobalEnv';\nimport { getKeyName, getLogWpName, getStorageName } from '../Common/Naming';\nimport { getSecret } from '../KeyVault/Helper';\nimport { getStorageSecrets } from '../Storage/Helper';\nimport { DiagnosticProps, KeyVaultInfo } from '../types';\nimport { ResourceGroupInfo } from './../types.d';\n\nexport const createDiagnostic = async ({\n  name,\n  targetResourceId,\n  logWpId,\n  logStorageId,\n  metricsCategories = [\"AllMetrics\"],\n  logsCategories,\n  dependsOn,\n}: DiagnosticProps) => {\n  //Ensure logWpId or logStorageId is provided\n  if (!logWpId && !logStorageId) {\n    console.error(\n      `Diagnostic for \"${name}\" must have either a \"logWpId\" or \"logStorageId\".`\n    );\n    return undefined;\n  }\n\n  //Ensure targetResourceId is valid\n  if (!targetResourceId) {\n    console.error(`Target resource of \"${name}\" must beprovided .`);\n    return undefined;\n  }\n\n  const n = `${name}-diag`;\n  return new native.insights.DiagnosticSetting(\n    n,\n    {\n      name: n,\n      resourceUri: targetResourceId,\n      logAnalyticsDestinationType: \"AzureDiagnostics\",\n\n      workspaceId: logWpId,\n      storageAccountId: logWpId ? undefined : logStorageId,\n\n      //Metric\n      metrics: metricsCategories\n        ? metricsCategories.map((c) => ({\n          category: c,\n          retentionPolicy: { enabled: false, days: 7 },\n          enabled: true,\n        }))\n        : undefined,\n      //Logs\n      logs: logsCategories\n        ? logsCategories.map((c) => ({\n          category: c,\n          retentionPolicy: { enabled: false, days: 7 },\n          enabled: true,\n        }))\n        : undefined,\n    },\n    { dependsOn }\n  );\n};\n\ninterface ThreatProtectionProps {\n  name: string;\n  targetResourceId: Input<string>;\n}\n\nexport const createThreatProtection = ({\n  name,\n  targetResourceId,\n}: ThreatProtectionProps) => {\n  return new azure.securitycenter.AdvancedThreatProtection(name, {\n    enabled: true,\n    targetResourceId,\n  });\n};\n\nexport const getLogWpSecrets = async ({ name, group, vaultInfo }: { name: string, group: ResourceGroupInfo, vaultInfo: KeyVaultInfo }) => {\n\n  const workspaceIdKeyName = `${name}-Id`;\n  const primaryKeyName = getKeyName(name, \"primary\");\n  const secondaryKeyName = getKeyName(name, \"secondary\");\n\n  const [wpId, primaryKey, secondaryKey] = await Promise.all([\n    getSecret({ name: workspaceIdKeyName, vaultInfo }),\n    getSecret({ name: primaryKeyName, nameFormatted: true, vaultInfo }),\n    getSecret({ name: secondaryKeyName, nameFormatted: true, vaultInfo }),\n  ]);\n\n  return { wpId, primaryKey, secondaryKey };\n};\n\nexport const getLogWpInfo = async ({\n  logWpName,\n  vaultInfo,\n}: {\n  logWpName: string;\n  vaultInfo?: KeyVaultInfo;\n}) => {\n  const name = getLogWpName(logWpName);\n  const group = logGroupInfo;\n  const id = interpolate`/subscriptions/${subscriptionId}/resourcegroups/${group.resourceGroupName}/providers/microsoft.operationalinsights/workspaces/${name}`;\n\n  const secrets = vaultInfo ? await getLogWpSecrets({ name, group, vaultInfo }) : undefined;\n\n  return { name, group, id, secrets };\n};\n\nexport const getLogStorageInfo = async ({\n  storageName,\n  vaultInfo,\n}: {\n  storageName: string;\n  vaultInfo?: KeyVaultInfo;\n}) => {\n  const name = getStorageName(storageName);\n  const group = logGroupInfo;\n  const id = interpolate`/subscriptions/${subscriptionId}/resourcegroups/${group.resourceGroupName}/providers/Microsoft.Storage/storageAccounts/${name}`;\n\n  const secrets = vaultInfo\n    ? await getStorageSecrets({ name, group, vaultInfo })\n    : undefined;\n\n  return { name, group, id, secrets };\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7266d59db41365a8d2a3f579f7be370774d9de1c","contentHash":"3631760c76d7b3ba8db3f54f0808f520d5e26fff40eb8d976ddae78dd2819480"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/AzureEnv.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/AzureEnv.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":360}},"26":{"start":{"line":27,"column":15},"end":{"line":27,"column":60}},"27":{"start":{"line":28,"column":19},"end":{"line":28,"column":40}},"28":{"start":{"line":29,"column":17},"end":{"line":29,"column":42}},"29":{"start":{"line":30,"column":17},"end":{"line":30,"column":36}},"30":{"start":{"line":31,"column":15},"end":{"line":31,"column":75}},"31":{"start":{"line":32,"column":0},"end":{"line":32,"column":35}},"32":{"start":{"line":33,"column":0},"end":{"line":33,"column":47}},"33":{"start":{"line":34,"column":0},"end":{"line":34,"column":50}},"34":{"start":{"line":35,"column":0},"end":{"line":35,"column":42}},"35":{"start":{"line":36,"column":0},"end":{"line":36,"column":82}},"36":{"start":{"line":36,"column":59},"end":{"line":36,"column":80}},"37":{"start":{"line":38,"column":0},"end":{"line":40,"column":3}},"38":{"start":{"line":39,"column":4},"end":{"line":39,"column":70}},"39":{"start":{"line":42,"column":0},"end":{"line":46,"column":2}},"40":{"start":{"line":48,"column":0},"end":{"line":53,"column":71}},"41":{"start":{"line":49,"column":4},"end":{"line":49,"column":38}},"42":{"start":{"line":50,"column":4},"end":{"line":50,"column":32}},"43":{"start":{"line":51,"column":4},"end":{"line":51,"column":40}},"44":{"start":{"line":52,"column":4},"end":{"line":52,"column":32}},"45":{"start":{"line":54,"column":14},"end":{"line":54,"column":53}},"46":{"start":{"line":54,"column":23},"end":{"line":54,"column":53}},"47":{"start":{"line":55,"column":0},"end":{"line":55,"column":22}},"48":{"start":{"line":56,"column":0},"end":{"line":56,"column":53}},"49":{"start":{"line":57,"column":0},"end":{"line":57,"column":61}},"50":{"start":{"line":58,"column":0},"end":{"line":58,"column":53}},"51":{"start":{"line":61,"column":22},"end":{"line":71,"column":1}},"52":{"start":{"line":62,"column":4},"end":{"line":63,"column":32}},"53":{"start":{"line":63,"column":8},"end":{"line":63,"column":32}},"54":{"start":{"line":64,"column":4},"end":{"line":65,"column":36}},"55":{"start":{"line":65,"column":8},"end":{"line":65,"column":36}},"56":{"start":{"line":66,"column":4},"end":{"line":67,"column":32}},"57":{"start":{"line":67,"column":8},"end":{"line":67,"column":32}},"58":{"start":{"line":68,"column":4},"end":{"line":69,"column":32}},"59":{"start":{"line":69,"column":8},"end":{"line":69,"column":32}},"60":{"start":{"line":70,"column":4},"end":{"line":70,"column":31}},"61":{"start":{"line":72,"column":0},"end":{"line":72,"column":37}},"62":{"start":{"line":73,"column":32},"end":{"line":76,"column":1}},"63":{"start":{"line":75,"column":4},"end":{"line":75,"column":21}},"64":{"start":{"line":77,"column":0},"end":{"line":77,"column":58}},"65":{"start":{"line":79,"column":24},"end":{"line":87,"column":1}},"66":{"start":{"line":80,"column":22},"end":{"line":80,"column":62}},"67":{"start":{"line":81,"column":30},"end":{"line":81,"column":75}},"68":{"start":{"line":82,"column":4},"end":{"line":86,"column":6}},"69":{"start":{"line":88,"column":0},"end":{"line":88,"column":42}},"70":{"start":{"line":89,"column":30},"end":{"line":95,"column":1}},"71":{"start":{"line":90,"column":4},"end":{"line":93,"column":156}},"72":{"start":{"line":91,"column":8},"end":{"line":91,"column":126}},"73":{"start":{"line":92,"column":9},"end":{"line":93,"column":156}},"74":{"start":{"line":93,"column":8},"end":{"line":93,"column":156}},"75":{"start":{"line":94,"column":4},"end":{"line":94,"column":49}},"76":{"start":{"line":96,"column":0},"end":{"line":96,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":36,"column":52},"end":{"line":36,"column":53}},"loc":{"start":{"line":36,"column":59},"end":{"line":36,"column":80}},"line":36},"7":{"name":"(anonymous_7)","decl":{"start":{"line":38,"column":68},"end":{"line":38,"column":69}},"loc":{"start":{"line":38,"column":80},"end":{"line":40,"column":1}},"line":38},"8":{"name":"(anonymous_8)","decl":{"start":{"line":48,"column":1},"end":{"line":48,"column":2}},"loc":{"start":{"line":48,"column":25},"end":{"line":53,"column":1}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":54,"column":14},"end":{"line":54,"column":15}},"loc":{"start":{"line":54,"column":23},"end":{"line":54,"column":53}},"line":54},"10":{"name":"(anonymous_10)","decl":{"start":{"line":61,"column":22},"end":{"line":61,"column":23}},"loc":{"start":{"line":61,"column":28},"end":{"line":71,"column":1}},"line":61},"11":{"name":"(anonymous_11)","decl":{"start":{"line":73,"column":32},"end":{"line":73,"column":33}},"loc":{"start":{"line":73,"column":41},"end":{"line":76,"column":1}},"line":73},"12":{"name":"(anonymous_12)","decl":{"start":{"line":79,"column":24},"end":{"line":79,"column":25}},"loc":{"start":{"line":79,"column":39},"end":{"line":87,"column":1}},"line":79},"13":{"name":"(anonymous_13)","decl":{"start":{"line":89,"column":30},"end":{"line":89,"column":31}},"loc":{"start":{"line":89,"column":62},"end":{"line":95,"column":1}},"line":89}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":53,"column":18},"end":{"line":53,"column":69}},"type":"binary-expr","locations":[{"start":{"line":53,"column":18},"end":{"line":53,"column":38}},{"start":{"line":53,"column":43},"end":{"line":53,"column":68}}],"line":53},"17":{"loc":{"start":{"line":62,"column":4},"end":{"line":63,"column":32}},"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":63,"column":32}},{"start":{"line":62,"column":4},"end":{"line":63,"column":32}}],"line":62},"18":{"loc":{"start":{"line":64,"column":4},"end":{"line":65,"column":36}},"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":65,"column":36}},{"start":{"line":64,"column":4},"end":{"line":65,"column":36}}],"line":64},"19":{"loc":{"start":{"line":66,"column":4},"end":{"line":67,"column":32}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":67,"column":32}},{"start":{"line":66,"column":4},"end":{"line":67,"column":32}}],"line":66},"20":{"loc":{"start":{"line":68,"column":4},"end":{"line":69,"column":32}},"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":69,"column":32}},{"start":{"line":68,"column":4},"end":{"line":69,"column":32}}],"line":68},"21":{"loc":{"start":{"line":90,"column":4},"end":{"line":93,"column":156}},"type":"if","locations":[{"start":{"line":90,"column":4},"end":{"line":93,"column":156}},{"start":{"line":90,"column":4},"end":{"line":93,"column":156}}],"line":90},"22":{"loc":{"start":{"line":90,"column":8},"end":{"line":90,"column":26}},"type":"binary-expr","locations":[{"start":{"line":90,"column":8},"end":{"line":90,"column":13}},{"start":{"line":90,"column":17},"end":{"line":90,"column":26}}],"line":90},"23":{"loc":{"start":{"line":92,"column":9},"end":{"line":93,"column":156}},"type":"if","locations":[{"start":{"line":92,"column":9},"end":{"line":93,"column":156}},{"start":{"line":92,"column":9},"end":{"line":93,"column":156}}],"line":92},"24":{"loc":{"start":{"line":92,"column":13},"end":{"line":92,"column":29}},"type":"binary-expr","locations":[{"start":{"line":92,"column":13},"end":{"line":92,"column":17}},{"start":{"line":92,"column":21},"end":{"line":92,"column":29}}],"line":92}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":0,"37":1,"38":0,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":0,"54":1,"55":0,"56":1,"57":0,"58":1,"59":1,"60":0,"61":1,"62":1,"63":0,"64":1,"65":1,"66":0,"67":0,"68":0,"69":1,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":1,"9":3,"10":1,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[1,1],"17":[0,1],"18":[0,1],"19":[0,1],"20":[1,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/AzureEnv.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/AzureEnv.ts"],"names":[],"mappings":"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","sourcesContent":["import * as native from \"@pulumi/azure-native\";\nimport { projectName, stack, testMode, organization } from \"./StackEnv\";\nimport { all, output, interpolate } from \"@pulumi/pulumi\";\nimport { KeyVaultInfo } from \"../types\";\nimport { getKeyVaultName, getResourceGroupName } from \"./Naming\";\nimport { ResourceInfoArg } from \"./ResourceEnv\";\n\nconst config = output(native.authorization.getClientConfig());\nexport const tenantId = config.tenantId;\nexport const subscriptionId = config.subscriptionId;\nexport const currentServicePrincipal = config.objectId;\nexport const defaultLocation = \"SoutheastAsia\";\nexport const defaultScope = subscriptionId.apply((s) => `/subscriptions/${s}`);\n\n//Print and Check\nall([subscriptionId, tenantId]).apply(([s, t]) => {\n  console.log(`Current Azure:`, { TenantId: t, SubscriptionId: s });\n});\n\n/** ======== Default Variables ================*/\n\nexport const defaultTags = {\n  environment: stack,\n  organization: organization,\n  \"pulumi-project\": projectName,\n};\nexport enum Environments {\n  Global = \"global\",\n  Dev = \"dev\",\n  Sandbox = \"sandbox\",\n  Prd = \"prd\",\n}\n\nexport const isEnv = (env: Environments) => stack.includes(env);\nexport const isDev = isEnv(Environments.Dev);\nexport const isSandbox = isEnv(Environments.Sandbox);\nexport const isPrd = isEnv(Environments.Prd);\n/** Protect Private API that only allows accessing from APIM */\n//export const apimEnabled = isPrd;\n\nconst getCurrentEnv = () => {\n  if (isPrd) return Environments.Prd;\n  if (isSandbox) return Environments.Sandbox;\n  if (isDev) return Environments.Dev;\n\n  if (testMode) return Environments.Dev;\n  return Environments.Global;\n};\n\nexport const currentEnv = getCurrentEnv();\n\nexport const getAlertActionGroupInfo = (\n  env: Environments\n):\n  | {\n      name: string;\n      resourceGroupName: string;\n    }\n  | undefined => {\n  //TODO: Define the alert action group name\n  return undefined;\n};\n\n/** Get Key Vault by Group Name. Group Name is the name use to create the resource and resource group together. */\nexport const getKeyVaultInfo = (groupName: string): KeyVaultInfo => {\n  const vaultName = getKeyVaultName(groupName);\n  const resourceGroupName = getResourceGroupName(groupName);\n\n  return {\n    name: vaultName,\n    group: { resourceGroupName: resourceGroupName },\n    id: interpolate`/subscriptions/${subscriptionId}/resourceGroups/${resourceGroupName}/providers/Microsoft.KeyVault/vaults/${vaultName}`,\n  };\n};\n\nexport const getResourceIdFromInfo = ({\n  group,\n  name,\n  provider,\n}: ResourceInfoArg) => {\n  if (!name && !provider)\n    return interpolate`/subscriptions/${subscriptionId}/resourceGroups/${group.resourceGroupName}`;\n  else if (name && provider)\n    return interpolate`/subscriptions/${subscriptionId}/resourceGroups/${group.resourceGroupName}/providers/${provider}/${name}`;\n\n  throw new Error(\"Resource Info is invalid.\");\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"96e7fd4451bd29eebfc516881938fe40b5d81cde","contentHash":"d3c1d5fcb0aaffdb1a1a16f65fe97b8f5aa2298f5b91f8e9ffafc560f90f9c2f"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/StackEnv.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/StackEnv.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":87}},"26":{"start":{"line":27,"column":15},"end":{"line":27,"column":54}},"27":{"start":{"line":28,"column":0},"end":{"line":28,"column":50}},"28":{"start":{"line":29,"column":0},"end":{"line":29,"column":89}},"29":{"start":{"line":30,"column":0},"end":{"line":30,"column":56}},"30":{"start":{"line":31,"column":0},"end":{"line":31,"column":48}},"31":{"start":{"line":32,"column":0},"end":{"line":32,"column":129}},"32":{"start":{"line":33,"column":0},"end":{"line":34,"column":44}},"33":{"start":{"line":34,"column":4},"end":{"line":34,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":88}},"type":"cond-expr","locations":[{"start":{"line":29,"column":42},"end":{"line":29,"column":47}},{"start":{"line":29,"column":50},"end":{"line":29,"column":88}}],"line":29},"17":{"loc":{"start":{"line":33,"column":0},"end":{"line":34,"column":44}},"type":"if","locations":[{"start":{"line":33,"column":0},"end":{"line":34,"column":44}},{"start":{"line":33,"column":0},"end":{"line":34,"column":44}}],"line":33}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[1,0],"17":[1,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/StackEnv.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/StackEnv.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uDAAyC;AAE5B,QAAA,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;AAC1C,QAAA,YAAY,GAAE,gBAAQ,CAAA,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC,WAAW,EAAE,CAAC;AACvE,QAAA,WAAW,GAAG,MAAM,CAAC,UAAU,EAAE,CAAC,WAAW,EAAE,CAAC;AAChD,QAAA,KAAK,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,CAAC;AAErD,OAAO,CAAC,GAAG,CAAC,2BAA2B,mBAAW,mBAAmB,oBAAY,eAAe,aAAK,EAAE,CAAC,CAAC;AACzG,IAAI,gBAAQ;IAAE,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC","sourcesContent":["import * as pulumi from '@pulumi/pulumi';\n\nexport const testMode = Boolean(process.env.TEST_MODE);\nexport const organization =testMode? \"hbd\" : pulumi.getOrganization().toLowerCase();\nexport const projectName = pulumi.getProject().toLowerCase();\nexport const stack = pulumi.getStack().toLowerCase();\n\nconsole.log(`Current Pulumi Project: ${projectName}, Organization: ${organization} and Stack: ${stack}`);\nif (testMode) console.log(` & Running in Test mode.`);\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b875f362392e1e192301d80a94d40dc8b566c4c5","contentHash":"1c2b4427908de586fb8bd051a1ff55fdf3c385e27deb432788dfa82e17aab103"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Naming/index.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Naming/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":1269}},"2":{"start":{"line":4,"column":18},"end":{"line":4,"column":39}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":47}},"4":{"start":{"line":6,"column":19},"end":{"line":6,"column":41}},"5":{"start":{"line":8,"column":29},"end":{"line":10,"column":2}},"6":{"start":{"line":8,"column":39},"end":{"line":10,"column":2}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":52}},"8":{"start":{"line":13,"column":23},"end":{"line":18,"column":1}},"9":{"start":{"line":14,"column":4},"end":{"line":14,"column":71}},"10":{"start":{"line":15,"column":4},"end":{"line":15,"column":52}},"11":{"start":{"line":16,"column":4},"end":{"line":16,"column":52}},"12":{"start":{"line":17,"column":4},"end":{"line":17,"column":47}},"13":{"start":{"line":19,"column":0},"end":{"line":19,"column":40}},"14":{"start":{"line":21,"column":22},"end":{"line":26,"column":1}},"15":{"start":{"line":22,"column":4},"end":{"line":22,"column":52}},"16":{"start":{"line":23,"column":4},"end":{"line":23,"column":46}},"17":{"start":{"line":24,"column":4},"end":{"line":24,"column":53}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":67}},"19":{"start":{"line":27,"column":0},"end":{"line":27,"column":38}},"20":{"start":{"line":28,"column":20},"end":{"line":31,"column":1}},"21":{"start":{"line":29,"column":4},"end":{"line":29,"column":44}},"22":{"start":{"line":30,"column":4},"end":{"line":30,"column":26}},"23":{"start":{"line":32,"column":0},"end":{"line":32,"column":34}},"24":{"start":{"line":33,"column":26},"end":{"line":33,"column":92}},"25":{"start":{"line":33,"column":42},"end":{"line":33,"column":92}},"26":{"start":{"line":34,"column":0},"end":{"line":34,"column":46}},"27":{"start":{"line":35,"column":19},"end":{"line":35,"column":84}},"28":{"start":{"line":35,"column":35},"end":{"line":35,"column":84}},"29":{"start":{"line":36,"column":0},"end":{"line":36,"column":32}},"30":{"start":{"line":37,"column":24},"end":{"line":39,"column":55}},"31":{"start":{"line":37,"column":40},"end":{"line":39,"column":55}},"32":{"start":{"line":40,"column":0},"end":{"line":40,"column":42}},"33":{"start":{"line":41,"column":33},"end":{"line":41,"column":107}},"34":{"start":{"line":41,"column":43},"end":{"line":41,"column":107}},"35":{"start":{"line":42,"column":0},"end":{"line":42,"column":60}},"36":{"start":{"line":43,"column":19},"end":{"line":43,"column":88}},"37":{"start":{"line":43,"column":29},"end":{"line":43,"column":88}},"38":{"start":{"line":44,"column":0},"end":{"line":44,"column":32}},"39":{"start":{"line":45,"column":24},"end":{"line":45,"column":93}},"40":{"start":{"line":45,"column":34},"end":{"line":45,"column":93}},"41":{"start":{"line":46,"column":0},"end":{"line":46,"column":42}},"42":{"start":{"line":47,"column":25},"end":{"line":47,"column":94}},"43":{"start":{"line":47,"column":35},"end":{"line":47,"column":94}},"44":{"start":{"line":48,"column":0},"end":{"line":48,"column":44}},"45":{"start":{"line":49,"column":20},"end":{"line":49,"column":90}},"46":{"start":{"line":49,"column":30},"end":{"line":49,"column":90}},"47":{"start":{"line":50,"column":0},"end":{"line":50,"column":34}},"48":{"start":{"line":51,"column":19},"end":{"line":51,"column":88}},"49":{"start":{"line":51,"column":29},"end":{"line":51,"column":88}},"50":{"start":{"line":52,"column":0},"end":{"line":52,"column":32}},"51":{"start":{"line":53,"column":24},"end":{"line":53,"column":74}},"52":{"start":{"line":53,"column":34},"end":{"line":53,"column":74}},"53":{"start":{"line":54,"column":0},"end":{"line":54,"column":42}},"54":{"start":{"line":55,"column":31},"end":{"line":55,"column":100}},"55":{"start":{"line":55,"column":41},"end":{"line":55,"column":100}},"56":{"start":{"line":56,"column":0},"end":{"line":56,"column":56}},"57":{"start":{"line":57,"column":19},"end":{"line":57,"column":88}},"58":{"start":{"line":57,"column":29},"end":{"line":57,"column":88}},"59":{"start":{"line":58,"column":0},"end":{"line":58,"column":32}},"60":{"start":{"line":59,"column":27},"end":{"line":59,"column":99}},"61":{"start":{"line":59,"column":37},"end":{"line":59,"column":99}},"62":{"start":{"line":60,"column":0},"end":{"line":60,"column":48}},"63":{"start":{"line":61,"column":26},"end":{"line":61,"column":95}},"64":{"start":{"line":61,"column":36},"end":{"line":61,"column":95}},"65":{"start":{"line":62,"column":0},"end":{"line":62,"column":46}},"66":{"start":{"line":63,"column":21},"end":{"line":63,"column":89}},"67":{"start":{"line":63,"column":31},"end":{"line":63,"column":89}},"68":{"start":{"line":64,"column":0},"end":{"line":64,"column":36}},"69":{"start":{"line":65,"column":23},"end":{"line":65,"column":92}},"70":{"start":{"line":65,"column":33},"end":{"line":65,"column":92}},"71":{"start":{"line":66,"column":0},"end":{"line":66,"column":40}},"72":{"start":{"line":67,"column":21},"end":{"line":67,"column":90}},"73":{"start":{"line":67,"column":31},"end":{"line":67,"column":90}},"74":{"start":{"line":68,"column":0},"end":{"line":68,"column":36}},"75":{"start":{"line":69,"column":26},"end":{"line":69,"column":95}},"76":{"start":{"line":69,"column":36},"end":{"line":69,"column":95}},"77":{"start":{"line":70,"column":0},"end":{"line":70,"column":46}},"78":{"start":{"line":71,"column":26},"end":{"line":71,"column":95}},"79":{"start":{"line":71,"column":36},"end":{"line":71,"column":95}},"80":{"start":{"line":72,"column":0},"end":{"line":72,"column":46}},"81":{"start":{"line":73,"column":31},"end":{"line":73,"column":100}},"82":{"start":{"line":73,"column":41},"end":{"line":73,"column":100}},"83":{"start":{"line":74,"column":0},"end":{"line":74,"column":56}},"84":{"start":{"line":75,"column":23},"end":{"line":75,"column":93}},"85":{"start":{"line":75,"column":33},"end":{"line":75,"column":93}},"86":{"start":{"line":76,"column":0},"end":{"line":76,"column":40}},"87":{"start":{"line":77,"column":27},"end":{"line":77,"column":96}},"88":{"start":{"line":77,"column":37},"end":{"line":77,"column":96}},"89":{"start":{"line":78,"column":0},"end":{"line":78,"column":48}},"90":{"start":{"line":79,"column":21},"end":{"line":79,"column":89}},"91":{"start":{"line":79,"column":31},"end":{"line":79,"column":89}},"92":{"start":{"line":80,"column":0},"end":{"line":80,"column":36}},"93":{"start":{"line":81,"column":25},"end":{"line":81,"column":94}},"94":{"start":{"line":81,"column":35},"end":{"line":81,"column":94}},"95":{"start":{"line":82,"column":0},"end":{"line":82,"column":44}},"96":{"start":{"line":83,"column":24},"end":{"line":83,"column":92}},"97":{"start":{"line":83,"column":34},"end":{"line":83,"column":92}},"98":{"start":{"line":84,"column":0},"end":{"line":84,"column":42}},"99":{"start":{"line":85,"column":30},"end":{"line":85,"column":99}},"100":{"start":{"line":85,"column":40},"end":{"line":85,"column":99}},"101":{"start":{"line":86,"column":0},"end":{"line":86,"column":54}},"102":{"start":{"line":87,"column":35},"end":{"line":87,"column":106}},"103":{"start":{"line":87,"column":45},"end":{"line":87,"column":106}},"104":{"start":{"line":88,"column":0},"end":{"line":88,"column":64}},"105":{"start":{"line":89,"column":18},"end":{"line":89,"column":86}},"106":{"start":{"line":89,"column":28},"end":{"line":89,"column":86}},"107":{"start":{"line":90,"column":0},"end":{"line":90,"column":30}},"108":{"start":{"line":91,"column":19},"end":{"line":91,"column":88}},"109":{"start":{"line":91,"column":29},"end":{"line":91,"column":88}},"110":{"start":{"line":92,"column":0},"end":{"line":92,"column":32}},"111":{"start":{"line":93,"column":20},"end":{"line":93,"column":89}},"112":{"start":{"line":93,"column":30},"end":{"line":93,"column":89}},"113":{"start":{"line":94,"column":0},"end":{"line":94,"column":34}},"114":{"start":{"line":95,"column":19},"end":{"line":95,"column":88}},"115":{"start":{"line":95,"column":29},"end":{"line":95,"column":88}},"116":{"start":{"line":96,"column":0},"end":{"line":96,"column":32}},"117":{"start":{"line":97,"column":19},"end":{"line":97,"column":88}},"118":{"start":{"line":97,"column":29},"end":{"line":97,"column":88}},"119":{"start":{"line":98,"column":0},"end":{"line":98,"column":32}},"120":{"start":{"line":99,"column":21},"end":{"line":99,"column":92}},"121":{"start":{"line":99,"column":31},"end":{"line":99,"column":92}},"122":{"start":{"line":100,"column":0},"end":{"line":100,"column":36}},"123":{"start":{"line":101,"column":25},"end":{"line":101,"column":114}},"124":{"start":{"line":101,"column":35},"end":{"line":101,"column":114}},"125":{"start":{"line":102,"column":0},"end":{"line":102,"column":44}},"126":{"start":{"line":103,"column":36},"end":{"line":103,"column":105}},"127":{"start":{"line":103,"column":46},"end":{"line":103,"column":105}},"128":{"start":{"line":104,"column":0},"end":{"line":104,"column":66}},"129":{"start":{"line":105,"column":25},"end":{"line":105,"column":93}},"130":{"start":{"line":105,"column":35},"end":{"line":105,"column":93}},"131":{"start":{"line":106,"column":0},"end":{"line":106,"column":44}},"132":{"start":{"line":107,"column":31},"end":{"line":107,"column":100}},"133":{"start":{"line":107,"column":41},"end":{"line":107,"column":100}},"134":{"start":{"line":108,"column":0},"end":{"line":108,"column":56}},"135":{"start":{"line":109,"column":26},"end":{"line":109,"column":95}},"136":{"start":{"line":109,"column":36},"end":{"line":109,"column":95}},"137":{"start":{"line":110,"column":0},"end":{"line":110,"column":46}},"138":{"start":{"line":111,"column":23},"end":{"line":111,"column":92}},"139":{"start":{"line":111,"column":33},"end":{"line":111,"column":92}},"140":{"start":{"line":112,"column":0},"end":{"line":112,"column":40}},"141":{"start":{"line":114,"column":24},"end":{"line":116,"column":126}},"142":{"start":{"line":116,"column":6},"end":{"line":116,"column":126}},"143":{"start":{"line":117,"column":0},"end":{"line":117,"column":42}},"144":{"start":{"line":118,"column":27},"end":{"line":118,"column":96}},"145":{"start":{"line":118,"column":37},"end":{"line":118,"column":96}},"146":{"start":{"line":119,"column":0},"end":{"line":119,"column":48}},"147":{"start":{"line":121,"column":26},"end":{"line":121,"column":99}},"148":{"start":{"line":121,"column":36},"end":{"line":121,"column":99}},"149":{"start":{"line":122,"column":0},"end":{"line":122,"column":46}},"150":{"start":{"line":124,"column":19},"end":{"line":124,"column":136}},"151":{"start":{"line":124,"column":29},"end":{"line":124,"column":136}},"152":{"start":{"line":125,"column":0},"end":{"line":125,"column":32}},"153":{"start":{"line":127,"column":25},"end":{"line":127,"column":123}},"154":{"start":{"line":127,"column":35},"end":{"line":127,"column":123}},"155":{"start":{"line":128,"column":0},"end":{"line":128,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":29},"end":{"line":8,"column":30}},"loc":{"start":{"line":8,"column":39},"end":{"line":10,"column":2}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":23},"end":{"line":13,"column":24}},"loc":{"start":{"line":13,"column":33},"end":{"line":18,"column":1}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":21,"column":22},"end":{"line":21,"column":23}},"loc":{"start":{"line":21,"column":32},"end":{"line":26,"column":1}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":28,"column":20},"end":{"line":28,"column":21}},"loc":{"start":{"line":28,"column":30},"end":{"line":31,"column":1}},"line":28},"4":{"name":"(anonymous_4)","decl":{"start":{"line":33,"column":26},"end":{"line":33,"column":27}},"loc":{"start":{"line":33,"column":42},"end":{"line":33,"column":92}},"line":33},"5":{"name":"(anonymous_5)","decl":{"start":{"line":35,"column":19},"end":{"line":35,"column":20}},"loc":{"start":{"line":35,"column":35},"end":{"line":35,"column":84}},"line":35},"6":{"name":"(anonymous_6)","decl":{"start":{"line":37,"column":24},"end":{"line":37,"column":25}},"loc":{"start":{"line":37,"column":40},"end":{"line":39,"column":55}},"line":37},"7":{"name":"(anonymous_7)","decl":{"start":{"line":41,"column":33},"end":{"line":41,"column":34}},"loc":{"start":{"line":41,"column":43},"end":{"line":41,"column":107}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":43,"column":19},"end":{"line":43,"column":20}},"loc":{"start":{"line":43,"column":29},"end":{"line":43,"column":88}},"line":43},"9":{"name":"(anonymous_9)","decl":{"start":{"line":45,"column":24},"end":{"line":45,"column":25}},"loc":{"start":{"line":45,"column":34},"end":{"line":45,"column":93}},"line":45},"10":{"name":"(anonymous_10)","decl":{"start":{"line":47,"column":25},"end":{"line":47,"column":26}},"loc":{"start":{"line":47,"column":35},"end":{"line":47,"column":94}},"line":47},"11":{"name":"(anonymous_11)","decl":{"start":{"line":49,"column":20},"end":{"line":49,"column":21}},"loc":{"start":{"line":49,"column":30},"end":{"line":49,"column":90}},"line":49},"12":{"name":"(anonymous_12)","decl":{"start":{"line":51,"column":19},"end":{"line":51,"column":20}},"loc":{"start":{"line":51,"column":29},"end":{"line":51,"column":88}},"line":51},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":24},"end":{"line":53,"column":25}},"loc":{"start":{"line":53,"column":34},"end":{"line":53,"column":74}},"line":53},"14":{"name":"(anonymous_14)","decl":{"start":{"line":55,"column":31},"end":{"line":55,"column":32}},"loc":{"start":{"line":55,"column":41},"end":{"line":55,"column":100}},"line":55},"15":{"name":"(anonymous_15)","decl":{"start":{"line":57,"column":19},"end":{"line":57,"column":20}},"loc":{"start":{"line":57,"column":29},"end":{"line":57,"column":88}},"line":57},"16":{"name":"(anonymous_16)","decl":{"start":{"line":59,"column":27},"end":{"line":59,"column":28}},"loc":{"start":{"line":59,"column":37},"end":{"line":59,"column":99}},"line":59},"17":{"name":"(anonymous_17)","decl":{"start":{"line":61,"column":26},"end":{"line":61,"column":27}},"loc":{"start":{"line":61,"column":36},"end":{"line":61,"column":95}},"line":61},"18":{"name":"(anonymous_18)","decl":{"start":{"line":63,"column":21},"end":{"line":63,"column":22}},"loc":{"start":{"line":63,"column":31},"end":{"line":63,"column":89}},"line":63},"19":{"name":"(anonymous_19)","decl":{"start":{"line":65,"column":23},"end":{"line":65,"column":24}},"loc":{"start":{"line":65,"column":33},"end":{"line":65,"column":92}},"line":65},"20":{"name":"(anonymous_20)","decl":{"start":{"line":67,"column":21},"end":{"line":67,"column":22}},"loc":{"start":{"line":67,"column":31},"end":{"line":67,"column":90}},"line":67},"21":{"name":"(anonymous_21)","decl":{"start":{"line":69,"column":26},"end":{"line":69,"column":27}},"loc":{"start":{"line":69,"column":36},"end":{"line":69,"column":95}},"line":69},"22":{"name":"(anonymous_22)","decl":{"start":{"line":71,"column":26},"end":{"line":71,"column":27}},"loc":{"start":{"line":71,"column":36},"end":{"line":71,"column":95}},"line":71},"23":{"name":"(anonymous_23)","decl":{"start":{"line":73,"column":31},"end":{"line":73,"column":32}},"loc":{"start":{"line":73,"column":41},"end":{"line":73,"column":100}},"line":73},"24":{"name":"(anonymous_24)","decl":{"start":{"line":75,"column":23},"end":{"line":75,"column":24}},"loc":{"start":{"line":75,"column":33},"end":{"line":75,"column":93}},"line":75},"25":{"name":"(anonymous_25)","decl":{"start":{"line":77,"column":27},"end":{"line":77,"column":28}},"loc":{"start":{"line":77,"column":37},"end":{"line":77,"column":96}},"line":77},"26":{"name":"(anonymous_26)","decl":{"start":{"line":79,"column":21},"end":{"line":79,"column":22}},"loc":{"start":{"line":79,"column":31},"end":{"line":79,"column":89}},"line":79},"27":{"name":"(anonymous_27)","decl":{"start":{"line":81,"column":25},"end":{"line":81,"column":26}},"loc":{"start":{"line":81,"column":35},"end":{"line":81,"column":94}},"line":81},"28":{"name":"(anonymous_28)","decl":{"start":{"line":83,"column":24},"end":{"line":83,"column":25}},"loc":{"start":{"line":83,"column":34},"end":{"line":83,"column":92}},"line":83},"29":{"name":"(anonymous_29)","decl":{"start":{"line":85,"column":30},"end":{"line":85,"column":31}},"loc":{"start":{"line":85,"column":40},"end":{"line":85,"column":99}},"line":85},"30":{"name":"(anonymous_30)","decl":{"start":{"line":87,"column":35},"end":{"line":87,"column":36}},"loc":{"start":{"line":87,"column":45},"end":{"line":87,"column":106}},"line":87},"31":{"name":"(anonymous_31)","decl":{"start":{"line":89,"column":18},"end":{"line":89,"column":19}},"loc":{"start":{"line":89,"column":28},"end":{"line":89,"column":86}},"line":89},"32":{"name":"(anonymous_32)","decl":{"start":{"line":91,"column":19},"end":{"line":91,"column":20}},"loc":{"start":{"line":91,"column":29},"end":{"line":91,"column":88}},"line":91},"33":{"name":"(anonymous_33)","decl":{"start":{"line":93,"column":20},"end":{"line":93,"column":21}},"loc":{"start":{"line":93,"column":30},"end":{"line":93,"column":89}},"line":93},"34":{"name":"(anonymous_34)","decl":{"start":{"line":95,"column":19},"end":{"line":95,"column":20}},"loc":{"start":{"line":95,"column":29},"end":{"line":95,"column":88}},"line":95},"35":{"name":"(anonymous_35)","decl":{"start":{"line":97,"column":19},"end":{"line":97,"column":20}},"loc":{"start":{"line":97,"column":29},"end":{"line":97,"column":88}},"line":97},"36":{"name":"(anonymous_36)","decl":{"start":{"line":99,"column":21},"end":{"line":99,"column":22}},"loc":{"start":{"line":99,"column":31},"end":{"line":99,"column":92}},"line":99},"37":{"name":"(anonymous_37)","decl":{"start":{"line":101,"column":25},"end":{"line":101,"column":26}},"loc":{"start":{"line":101,"column":35},"end":{"line":101,"column":114}},"line":101},"38":{"name":"(anonymous_38)","decl":{"start":{"line":103,"column":36},"end":{"line":103,"column":37}},"loc":{"start":{"line":103,"column":46},"end":{"line":103,"column":105}},"line":103},"39":{"name":"(anonymous_39)","decl":{"start":{"line":105,"column":25},"end":{"line":105,"column":26}},"loc":{"start":{"line":105,"column":35},"end":{"line":105,"column":93}},"line":105},"40":{"name":"(anonymous_40)","decl":{"start":{"line":107,"column":31},"end":{"line":107,"column":32}},"loc":{"start":{"line":107,"column":41},"end":{"line":107,"column":100}},"line":107},"41":{"name":"(anonymous_41)","decl":{"start":{"line":109,"column":26},"end":{"line":109,"column":27}},"loc":{"start":{"line":109,"column":36},"end":{"line":109,"column":95}},"line":109},"42":{"name":"(anonymous_42)","decl":{"start":{"line":111,"column":23},"end":{"line":111,"column":24}},"loc":{"start":{"line":111,"column":33},"end":{"line":111,"column":92}},"line":111},"43":{"name":"(anonymous_43)","decl":{"start":{"line":114,"column":24},"end":{"line":114,"column":25}},"loc":{"start":{"line":116,"column":6},"end":{"line":116,"column":126}},"line":116},"44":{"name":"(anonymous_44)","decl":{"start":{"line":118,"column":27},"end":{"line":118,"column":28}},"loc":{"start":{"line":118,"column":37},"end":{"line":118,"column":96}},"line":118},"45":{"name":"(anonymous_45)","decl":{"start":{"line":121,"column":26},"end":{"line":121,"column":27}},"loc":{"start":{"line":121,"column":36},"end":{"line":121,"column":99}},"line":121},"46":{"name":"(anonymous_46)","decl":{"start":{"line":124,"column":19},"end":{"line":124,"column":20}},"loc":{"start":{"line":124,"column":29},"end":{"line":124,"column":136}},"line":124},"47":{"name":"(anonymous_47)","decl":{"start":{"line":127,"column":25},"end":{"line":127,"column":26}},"loc":{"start":{"line":127,"column":35},"end":{"line":127,"column":123}},"line":127}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":12},"end":{"line":9,"column":78}},"type":"cond-expr","locations":[{"start":{"line":9,"column":38},"end":{"line":9,"column":70}},{"start":{"line":9,"column":73},"end":{"line":9,"column":78}}],"line":9},"1":{"loc":{"start":{"line":37,"column":40},"end":{"line":39,"column":55}},"type":"cond-expr","locations":[{"start":{"line":38,"column":6},"end":{"line":38,"column":65}},{"start":{"line":39,"column":6},"end":{"line":39,"column":55}}],"line":37},"2":{"loc":{"start":{"line":114,"column":31},"end":{"line":116,"column":1}},"type":"default-arg","locations":[{"start":{"line":114,"column":44},"end":{"line":116,"column":1}}],"line":114},"3":{"loc":{"start":{"line":116,"column":47},"end":{"line":116,"column":108}},"type":"cond-expr","locations":[{"start":{"line":116,"column":69},"end":{"line":116,"column":95}},{"start":{"line":116,"column":98},"end":{"line":116,"column":108}}],"line":116}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":1,"20":1,"21":0,"22":0,"23":1,"24":1,"25":0,"26":1,"27":1,"28":0,"29":1,"30":1,"31":0,"32":1,"33":1,"34":0,"35":1,"36":1,"37":0,"38":1,"39":1,"40":0,"41":1,"42":1,"43":0,"44":1,"45":1,"46":0,"47":1,"48":1,"49":0,"50":1,"51":1,"52":0,"53":1,"54":1,"55":0,"56":1,"57":1,"58":0,"59":1,"60":1,"61":0,"62":1,"63":1,"64":0,"65":1,"66":1,"67":0,"68":1,"69":1,"70":0,"71":1,"72":1,"73":0,"74":1,"75":1,"76":0,"77":1,"78":1,"79":0,"80":1,"81":1,"82":0,"83":1,"84":1,"85":0,"86":1,"87":1,"88":0,"89":1,"90":1,"91":0,"92":1,"93":1,"94":0,"95":1,"96":1,"97":0,"98":1,"99":1,"100":0,"101":1,"102":1,"103":0,"104":1,"105":1,"106":0,"107":1,"108":1,"109":0,"110":1,"111":1,"112":0,"113":1,"114":1,"115":0,"116":1,"117":1,"118":0,"119":1,"120":1,"121":0,"122":1,"123":1,"124":0,"125":1,"126":1,"127":0,"128":1,"129":1,"130":0,"131":1,"132":1,"133":0,"134":1,"135":1,"136":0,"137":1,"138":1,"139":0,"140":1,"141":1,"142":0,"143":1,"144":1,"145":0,"146":1,"147":1,"148":0,"149":1,"150":1,"151":0,"152":1,"153":1,"154":0,"155":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0},"b":{"0":[0,0],"1":[0,0],"2":[0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Naming/index.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Naming/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { ConventionProps } from \"../../types\";\nimport { replaceAll } from \"../Helpers\";\nimport { getResourceName } from \"../ResourceEnv\";\nimport { organization, stack } from \"../StackEnv\";\n\n/** The method to get Resource group Name*/\nexport const getResourceGroupName = (name: string): string =>\n  getResourceName(name, {\n    suffix: organization ? `grp-${organization}` : \"grp\",\n  });\n\n/** Get Azure Storage Account and CosmosDb Name*/\nexport const getStorageName = (name: string): string => {\n  name = getResourceName(name, { suffix: \"stg\" });\n  name = replaceAll(name, \"-\", \"\");\n  name = replaceAll(name, \".\", \"\");\n  return name.toLowerCase().substring(0, 24);\n};\n\n/** Get Vault Secret Name. Remove the stack name and replace all _ with - then lower cases. */\nexport const getSecretName = (name: string) => {\n  name = name.replace(`${stack}-`, \"\");\n  name = name.replace(stack, \"\");\n  name = replaceAll(name, \" \", \"-\");\n  return replaceAll(name, \"_\", \"-\").toLowerCase();\n};\n\nexport const getCertName = (name: string) => {\n  name = getSecretName(name);\n  return `${name}-cert`;\n};\n\nexport const getConnectionName = (\n  name: string,\n  type: \"primary\" | \"secondary\"\n) => `${getSecretName(name)}-conn-${type}`;\n\nexport const getKeyName = (name: string, type: \"primary\" | \"secondary\") =>\n  `${getSecretName(name)}-key-${type}`;\n\nexport const getPasswordName = (\n  name: string,\n  type: \"primary\" | \"secondary\" | null\n) =>\n  type === null\n    ? getResourceName(name, { suffix: \"pwd\" })\n    : `${getSecretName(name)}-pwd-${type}`;\n\nexport const getAutomationAccountName = (name: string) =>\n  getResourceName(name, { suffix: \"acc-auto\" });\n\nexport const getB2cName = (name: string) =>\n  getResourceName(name, { suffix: \"b2c\" });\n\nexport const getCosmosDbName = (name: string) =>\n  getResourceName(name, { suffix: \"cdb\" });\n\nexport const getAppConfigName = (name: string) =>\n  getResourceName(name, { suffix: \"cfg\" });\n\nexport const getApimName = (name: string) =>\n  getResourceName(name, { suffix: \"apim\" });\n\nexport const getSshName = (name: string) =>\n  getResourceName(name, { suffix: \"ssh\" });\n\nexport const getIdentityName = (name: string) => getResourceName(name);\n\nexport const getManagedIdentityName = (name: string) =>\n  getResourceName(name, { suffix: \"mid\" });\n\nexport const getAksName = (name: string) =>\n  getResourceName(name, { suffix: \"aks\" });\n\nexport const getK8sProviderName = (name: string) =>\n  getResourceName(name, { suffix: \"ks-pvd\" });\n\nexport const getAppInsightName = (name: string) =>\n  getResourceName(name, { suffix: \"isg\" });\n\nexport const getLogWpName = (name: string) =>\n  getResourceName(name, { suffix: \"wp\" });\n\nexport const getWebTestName = (name: string) =>\n  getResourceName(name, { suffix: \"hlz\" });\n\nexport const getAlertName = (name: string) =>\n  getResourceName(name, { suffix: \"alt\" });\n\nexport const getRedisCacheName = (name: string) =>\n  getResourceName(name, { suffix: \"rds\" });\n\nexport const getServiceBusName = (name: string) =>\n  getResourceName(name, { suffix: \"bus\" });\n\nexport const getPrivateEndpointName = (name: string) =>\n  getResourceName(name, { suffix: \"pre\" });\n\nexport const getSignalRName = (name: string) =>\n  getResourceName(name, { suffix: \"sigr\" });\n\nexport const getElasticPoolName = (name: string) =>\n  getResourceName(name, { suffix: \"elp\" });\n\nexport const getSqlDbName = (name: string) =>\n  getResourceName(name, { suffix: \"db\" });\n\nexport const getSqlServerName = (name: string) =>\n  getResourceName(name, { suffix: \"sql\" });\n\nexport const getFirewallName = (name: string) =>\n  getResourceName(name, { suffix: \"fw\" });\n\nexport const getFirewallPolicyName = (name: string) =>\n  getResourceName(name, { suffix: \"fwp\" });\n\nexport const getFirewallPolicyGroupName = (name: string) =>\n  getResourceName(name, { suffix: \"fw-pg\" });\n\nexport const getVMName = (name: string) =>\n  getResourceName(name, { suffix: \"vm\" });\n\nexport const getNICName = (name: string) =>\n  getResourceName(name, { suffix: \"nic\" });\n\nexport const getVnetName = (name: string) =>\n  getResourceName(name, { suffix: \"vnt\" });\n\nexport const getWanName = (name: string) =>\n  getResourceName(name, { suffix: \"wan\" });\n\nexport const getHubName = (name: string) =>\n  getResourceName(name, { suffix: \"hub\" });\n\nexport const getRouteName = (name: string) =>\n  getResourceName(name, { suffix: \"route\" });\n\nexport const getRouteItemName = (name: string) =>\n  getResourceName(name, { suffix: \"\", includeOrgName: false });\n\nexport const getNetworkSecurityGroupName = (name: string) =>\n  getResourceName(name, { suffix: \"nsg\" });\n\nexport const getIpAddressName = (name: string) =>\n  getResourceName(name, { suffix: \"ip\" });\n\nexport const getIpAddressPrefixName = (name: string) =>\n  getResourceName(name, { suffix: \"ipx\" });\n\nexport const getAppGatewayName = (name: string) =>\n  getResourceName(name, { suffix: \"gtw\" });\n\nexport const getBastionName = (name: string) =>\n  getResourceName(name, { suffix: \"bst\" });\n\n/**Key vault allow to disable or custom the convention. The max length of vault name is 24*/\nexport const getKeyVaultName = (\n  name: string,\n  convention: ConventionProps | false = {\n    suffix: \"vlt\",\n  }\n) =>\n  getResourceName(\n    name,\n    convention == false ? { prefix: \"\", suffix: \"\" } : convention\n  ).substring(0, 24);\n\nexport const getCdnEndpointName = (name: string) =>\n  getResourceName(name, { suffix: \"cdn\" });\n\n/**The CDN Profile is created to Global group so no prefix*/\nexport const getCdnProfileName = (name: string) =>\n  getResourceName(name, { suffix: \"cdn-pfl\" });\n\n/**The Azure Container Registry is created to Global group so no prefix*/\nexport const getAcrName = (name: string) =>\n  replaceAll(getResourceName(name, { prefix: \"\", suffix: \"acr\" }), \"-\", \"\");\n\n/**The App Cert Order is created to Global group so no prefix*/\nexport const getCertOrderName = (name: string) =>\n  getResourceName(name.replace(\".\", \"-\"), { prefix: \"\", suffix: \"ca\" });\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a61309fbd1cb8e8d2d93348faee795e4ac781800","contentHash":"6440393481c8096ae3685ba216af7f408c10c9c8a951f3f9d5f0a35ac10a7e0b"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Helpers.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Helpers.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":128}},"2":{"start":{"line":6,"column":4},"end":{"line":7,"column":21}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":21}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":45}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":32}},"6":{"start":{"line":11,"column":22},"end":{"line":12,"column":61}},"7":{"start":{"line":11,"column":38},"end":{"line":12,"column":61}},"8":{"start":{"line":12,"column":37},"end":{"line":12,"column":60}},"9":{"start":{"line":13,"column":0},"end":{"line":13,"column":38}},"10":{"start":{"line":15,"column":25},"end":{"line":15,"column":98}},"11":{"start":{"line":15,"column":34},"end":{"line":15,"column":98}},"12":{"start":{"line":16,"column":0},"end":{"line":16,"column":44}},"13":{"start":{"line":18,"column":29},"end":{"line":21,"column":1}},"14":{"start":{"line":19,"column":18},"end":{"line":19,"column":63}},"15":{"start":{"line":20,"column":4},"end":{"line":20,"column":64}},"16":{"start":{"line":22,"column":0},"end":{"line":22,"column":52}},"17":{"start":{"line":24,"column":16},"end":{"line":24,"column":75}},"18":{"start":{"line":24,"column":28},"end":{"line":24,"column":75}},"19":{"start":{"line":24,"column":69},"end":{"line":24,"column":74}},"20":{"start":{"line":25,"column":0},"end":{"line":25,"column":26}}},"fnMap":{"0":{"name":"replaceAll","decl":{"start":{"line":5,"column":9},"end":{"line":5,"column":19}},"loc":{"start":{"line":5,"column":44},"end":{"line":9,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":38},"end":{"line":12,"column":61}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":28},"end":{"line":12,"column":29}},"loc":{"start":{"line":12,"column":37},"end":{"line":12,"column":60}},"line":12},"3":{"name":"(anonymous_3)","decl":{"start":{"line":15,"column":25},"end":{"line":15,"column":26}},"loc":{"start":{"line":15,"column":34},"end":{"line":15,"column":98}},"line":15},"4":{"name":"(anonymous_4)","decl":{"start":{"line":18,"column":29},"end":{"line":18,"column":30}},"loc":{"start":{"line":18,"column":38},"end":{"line":21,"column":1}},"line":18},"5":{"name":"(anonymous_5)","decl":{"start":{"line":24,"column":16},"end":{"line":24,"column":17}},"loc":{"start":{"line":24,"column":28},"end":{"line":24,"column":75}},"line":24},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":59},"end":{"line":24,"column":60}},"loc":{"start":{"line":24,"column":69},"end":{"line":24,"column":74}},"line":24}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":4},"end":{"line":7,"column":21}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":7,"column":21}},{"start":{"line":6,"column":4},"end":{"line":7,"column":21}}],"line":6},"1":{"loc":{"start":{"line":11,"column":38},"end":{"line":12,"column":61}},"type":"binary-expr","locations":[{"start":{"line":11,"column":38},"end":{"line":11,"column":91}},{"start":{"line":12,"column":4},"end":{"line":12,"column":61}}],"line":11}},"s":{"0":1,"1":1,"2":2,"3":0,"4":2,"5":1,"6":1,"7":0,"8":0,"9":1,"10":1,"11":0,"12":1,"13":1,"14":0,"15":0,"16":1,"17":1,"18":0,"19":0,"20":1},"f":{"0":2,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{"0":[0,2],"1":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Helpers.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/Helpers.ts"],"names":[],"mappings":";;;AAAA,sCAAsC;AACtC,SAAgB,UAAU,CAAC,KAAa,EAAE,MAAc,EAAE,OAAe;IACvE,IAAI,CAAC,KAAK;QAAE,OAAO,KAAK,CAAC;IACzB,OAAO,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AAC3C,CAAC;AAHD,gCAGC;AAEM,MAAM,aAAa,GAAG,CAAC,IAAS,EAAE,IAAS,EAAE,EAAE,CACpD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM;IACrD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AAF/C,QAAA,aAAa,iBAEkC;AAE5D,yBAAyB;AAClB,MAAM,gBAAgB,GAAG,CAAC,GAAW,EAAE,EAAE,CAC9C,GAAG,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AADtD,QAAA,gBAAgB,oBACsC;AAEnE,4CAA4C;AACrC,MAAM,oBAAoB,GAAG,CAAC,GAAW,EAAE,EAAE;IAClD,MAAM,KAAK,GAAG,IAAA,wBAAgB,EAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC/C,OAAO,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAC9D,CAAC,CAAC;AAHW,QAAA,oBAAoB,wBAG/B;AAEF,kBAAkB;AACX,MAAM,OAAO,GAAG,CAAC,MAAc,EAAE,EAAE,CACxC,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;AADrC,QAAA,OAAO,WAC8B","sourcesContent":["/** Replace all characters in string*/\nexport function replaceAll(value: string, search: string, replace: string) {\n  if (!value) return value;\n  return value.split(search).join(replace);\n}\n\nexport const shallowEquals = (obj1: any, obj2: any) =>\n  Object.keys(obj1).length === Object.keys(obj2).length &&\n  Object.keys(obj1).every((key) => obj1[key] === obj2[key]);\n\n/** Get Domain from Url*/\nexport const getDomainFromUrl = (url: string) =>\n  url.replace(\"https://\", \"\").replace(\"http://\", \"\").split(\"/\")[0];\n\n/** Get Root Domain from Url or Sub domain*/\nexport const getRootDomainFromUrl = (url: string) => {\n  const array = getDomainFromUrl(url).split(\".\");\n  return array.slice(Math.max(array.length - 2, 0)).join(\".\");\n};\n\n/** Create Range*/\nexport const RangeOf = (length: number) =>\n  Array.from({ length: length }, (v, k) => k + 1);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a16d5b91b174218cd081769c5b78d8747515908","contentHash":"4484f24822412406bbe736489377a78d0db945eb0c64ba7ac0ca0f082c82cde7"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/ResourceEnv.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/ResourceEnv.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":94}},"2":{"start":{"line":4,"column":18},"end":{"line":4,"column":38}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":40}},"4":{"start":{"line":6,"column":0},"end":{"line":9,"column":2}},"5":{"start":{"line":11,"column":16},"end":{"line":22,"column":1}},"6":{"start":{"line":12,"column":4},"end":{"line":13,"column":20}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":20}},"8":{"start":{"line":14,"column":4},"end":{"line":14,"column":53}},"9":{"start":{"line":16,"column":4},"end":{"line":17,"column":46}},"10":{"start":{"line":17,"column":8},"end":{"line":17,"column":46}},"11":{"start":{"line":19,"column":4},"end":{"line":20,"column":46}},"12":{"start":{"line":20,"column":8},"end":{"line":20,"column":46}},"13":{"start":{"line":21,"column":4},"end":{"line":21,"column":30}},"14":{"start":{"line":24,"column":24},"end":{"line":24,"column":109}},"15":{"start":{"line":24,"column":46},"end":{"line":24,"column":109}},"16":{"start":{"line":25,"column":0},"end":{"line":25,"column":42}},"17":{"start":{"line":26,"column":30},"end":{"line":42,"column":1}},"18":{"start":{"line":27,"column":4},"end":{"line":28,"column":25}},"19":{"start":{"line":28,"column":8},"end":{"line":28,"column":25}},"20":{"start":{"line":29,"column":20},"end":{"line":29,"column":33}},"21":{"start":{"line":30,"column":15},"end":{"line":30,"column":17}},"22":{"start":{"line":31,"column":20},"end":{"line":31,"column":22}},"23":{"start":{"line":32,"column":25},"end":{"line":32,"column":27}},"24":{"start":{"line":33,"column":4},"end":{"line":40,"column":7}},"25":{"start":{"line":34,"column":8},"end":{"line":35,"column":48}},"26":{"start":{"line":35,"column":12},"end":{"line":35,"column":48}},"27":{"start":{"line":36,"column":8},"end":{"line":37,"column":43}},"28":{"start":{"line":37,"column":12},"end":{"line":37,"column":43}},"29":{"start":{"line":38,"column":8},"end":{"line":39,"column":21}},"30":{"start":{"line":39,"column":12},"end":{"line":39,"column":21}},"31":{"start":{"line":41,"column":4},"end":{"line":41,"column":81}},"32":{"start":{"line":43,"column":0},"end":{"line":43,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":16},"end":{"line":11,"column":17}},"loc":{"start":{"line":11,"column":38},"end":{"line":22,"column":1}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":24,"column":24},"end":{"line":24,"column":25}},"loc":{"start":{"line":24,"column":46},"end":{"line":24,"column":109}},"line":24},"2":{"name":"(anonymous_2)","decl":{"start":{"line":26,"column":30},"end":{"line":26,"column":31}},"loc":{"start":{"line":26,"column":38},"end":{"line":42,"column":1}},"line":26},"3":{"name":"(anonymous_3)","decl":{"start":{"line":33,"column":20},"end":{"line":33,"column":21}},"loc":{"start":{"line":33,"column":34},"end":{"line":40,"column":5}},"line":33}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":4},"end":{"line":13,"column":20}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":13,"column":20}},{"start":{"line":12,"column":4},"end":{"line":13,"column":20}}],"line":12},"1":{"loc":{"start":{"line":16,"column":4},"end":{"line":17,"column":46}},"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":17,"column":46}},{"start":{"line":16,"column":4},"end":{"line":17,"column":46}}],"line":16},"2":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":64}},"type":"binary-expr","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":25}},{"start":{"line":16,"column":29},"end":{"line":16,"column":64}}],"line":16},"3":{"loc":{"start":{"line":19,"column":4},"end":{"line":20,"column":46}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":20,"column":46}},{"start":{"line":19,"column":4},"end":{"line":20,"column":46}}],"line":19},"4":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":62}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":25}},{"start":{"line":19,"column":29},"end":{"line":19,"column":62}}],"line":19},"5":{"loc":{"start":{"line":27,"column":4},"end":{"line":28,"column":25}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":28,"column":25}},{"start":{"line":27,"column":4},"end":{"line":28,"column":25}}],"line":27},"6":{"loc":{"start":{"line":34,"column":8},"end":{"line":35,"column":48}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":35,"column":48}},{"start":{"line":34,"column":8},"end":{"line":35,"column":48}}],"line":34},"7":{"loc":{"start":{"line":36,"column":8},"end":{"line":37,"column":43}},"type":"if","locations":[{"start":{"line":36,"column":8},"end":{"line":37,"column":43}},{"start":{"line":36,"column":8},"end":{"line":37,"column":43}}],"line":36},"8":{"loc":{"start":{"line":36,"column":12},"end":{"line":36,"column":60}},"type":"binary-expr","locations":[{"start":{"line":36,"column":12},"end":{"line":36,"column":34}},{"start":{"line":36,"column":38},"end":{"line":36,"column":60}}],"line":36},"9":{"loc":{"start":{"line":38,"column":8},"end":{"line":39,"column":21}},"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":39,"column":21}},{"start":{"line":38,"column":8},"end":{"line":39,"column":21}}],"line":38}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":2,"7":0,"8":2,"9":2,"10":1,"11":2,"12":2,"13":2,"14":1,"15":2,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1},"f":{"0":2,"1":2,"2":0,"3":0},"b":{"0":[0,2],"1":[1,1],"2":[2,2],"3":[2,0],"4":[2,2],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/ResourceEnv.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/ResourceEnv.ts"],"names":[],"mappings":";;;AAAA,uCAAuC;AAIvC,yCAAiC;AAEpB,QAAA,kBAAkB,GAAG;IAChC,MAAM,EAAE,gBAAK;IACb,MAAM,EAAE,SAAS,EAAE,6CAA6C;CACjE,CAAC;AAEF,yEAAyE;AAEzE,MAAM,OAAO,GAAG,CAAC,IAAY,EAAE,UAA2B,EAAU,EAAE;IACpE,IAAI,CAAC,IAAI;QAAE,OAAO,IAAI,CAAC;IACvB,IAAI,GAAG,IAAA,oBAAU,EAAC,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAElC,YAAY;IACZ,IAAI,UAAU,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,MAAM,CAAC;QAC1D,IAAI,GAAG,UAAU,CAAC,MAAM,GAAG,GAAG,GAAG,IAAI,CAAC;IAExC,gBAAgB;IAChB,IAAI,UAAU,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC;QACxD,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,UAAU,CAAC,MAAM,CAAC;IAExC,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC;AAC5B,CAAC,CAAC;AAEF,oGAAoG;AAC7F,MAAM,eAAe,GAAG,CAC7B,IAAY,EACZ,UAA4B,EACpB,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,GAAG,0BAAkB,EAAE,GAAG,UAAU,EAAE,CAAC,CAAC;AAHxD,QAAA,eAAe,mBAGyC;AAW9D,MAAM,qBAAqB,GAAG,CAAC,EAAU,EAA4B,EAAE;IAC5E,IAAI,CAAC,EAAE;QAAE,OAAO,SAAS,CAAC;IAE1B,MAAM,OAAO,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC9B,IAAI,IAAI,GAAG,EAAE,CAAC;IACd,IAAI,SAAS,GAAG,EAAE,CAAC;IACnB,IAAI,cAAc,GAAG,EAAE,CAAC;IAExB,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE;QAC3B,IAAI,CAAC,KAAK,eAAe;YAAE,cAAc,GAAG,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;QAC/D,IAAI,CAAC,KAAK,gBAAgB,IAAI,CAAC,KAAK,gBAAgB;YAClD,SAAS,GAAG,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;QACjC,IAAI,KAAK,KAAK,OAAO,CAAC,MAAM,GAAG,CAAC;YAAE,IAAI,GAAG,CAAC,CAAC;IAC7C,CAAC,CAAC,CAAC;IAEH,OAAO,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,iBAAiB,EAAE,SAAS,EAAE,EAAE,cAAc,EAAE,CAAC;AAC/E,CAAC,CAAC;AAhBW,QAAA,qBAAqB,yBAgBhC","sourcesContent":["import { replaceAll } from './Helpers';\nimport { ConventionProps, ResourceGroupInfo } from '../types';\nimport { Input } from '@pulumi/pulumi';\nimport { BaseOptions } from '../CustomProviders/Base';\nimport {stack} from \"./StackEnv\";\n\nexport const resourceConvention = {\n  prefix: stack,\n  suffix: undefined, //This may be specified by each resource name\n};\n\n/** ==================== Resources Variables ========================= */\n\nconst getName = (name: string, convention: ConventionProps): string => {\n  if (!name) return name;\n  name = replaceAll(name, ' ', '-');\n\n  //Add prefix\n  if (convention.prefix && !name.startsWith(convention.prefix))\n    name = convention.prefix + '-' + name;\n\n  //Add the suffix\n  if (convention.suffix && !name.endsWith(convention.suffix))\n    name = name + '-' + convention.suffix;\n\n  return name.toLowerCase();\n};\n\n/** The method to get Resource Name. This is not applicable for Azure Storage Account and CosmosDb*/\nexport const getResourceName = (\n  name: string,\n  convention?: ConventionProps\n): string => getName(name, { ...resourceConvention, ...convention });\n\n/**Get Resource Info from Resource Id. Sample Id is \"/subscriptions/01af663e-76dd-45ac-9e57-9c8e0d3ee350/resourceGroups/sandbox-codehbd-group-hbd/providers/Microsoft.Network/virtualNetworks/sandbox-codehbd-vnet-hbd\"*/\n\nexport interface ResourceInfo {\n  name: string;\n  group: ResourceGroupInfo;\n  subscriptionId: string;\n  id: string;\n}\n\nexport const getResourceInfoFromId = (id: string): ResourceInfo | undefined => {\n  if (!id) return undefined;\n\n  const details = id.split('/');\n  let name = '';\n  let groupName = '';\n  let subscriptionId = '';\n\n  details.forEach((d, index) => {\n    if (d === 'subscriptions') subscriptionId = details[index + 1];\n    if (d === 'resourceGroups' || d === 'resourcegroups')\n      groupName = details[index + 1];\n    if (index === details.length - 1) name = d;\n  });\n\n  return { name, id, group: { resourceGroupName: groupName }, subscriptionId };\n};\n\nexport interface ResourceInfoArg {\n  /**If name and provider of the resource is not provided then the Id will be resource group Id*/\n  name?: Input<string>;\n  /**The provider name of the resource ex: \"Microsoft.Network/virtualNetworks\" or \"Microsoft.Network/networkSecurityGroups\"*/\n  provider?: string;\n\n  group: BaseOptions<ResourceGroupInfo>;\n  subscriptionId?: Input<string>;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f2fbb6037fb4002bda1b7e9bc2b4b38fc0bad6a4","contentHash":"b143903aba9c2896cbdd69cb77e525f2023c88f1d7f0e08b6c874099e5f0c350"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/GlobalEnv.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/GlobalEnv.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":194}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":46}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":42}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":40}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":33}},"7":{"start":{"line":10,"column":0},"end":{"line":13,"column":2}},"8":{"start":{"line":14,"column":0},"end":{"line":16,"column":2}},"9":{"start":{"line":17,"column":0},"end":{"line":19,"column":2}},"10":{"start":{"line":20,"column":0},"end":{"line":23,"column":2}},"11":{"start":{"line":25,"column":0},"end":{"line":29,"column":2}},"12":{"start":{"line":31,"column":0},"end":{"line":33,"column":2}},"13":{"start":{"line":34,"column":0},"end":{"line":36,"column":2}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":78}},"type":"cond-expr","locations":[{"start":{"line":12,"column":38},"end":{"line":12,"column":70}},{"start":{"line":12,"column":73},"end":{"line":12,"column":78}}],"line":12}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1},"f":{},"b":{"0":[1,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/GlobalEnv.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Common/GlobalEnv.ts"],"names":[],"mappings":";;;AACA,yCAA4C;AAC5C,+CAAgD;AAChD,2CAA6C;AAC7C,yCAAwC;AAC3B,QAAA,aAAa,GAAG,QAAQ,CAAC;AAEtC,oCAAoC;AACvB,QAAA,gBAAgB,GAAoB;IAC/C,MAAM,EAAE,qBAAa;IACrB,MAAM,EAAE,uBAAY,CAAC,CAAC,CAAC,OAAO,uBAAY,EAAE,CAAC,CAAC,CAAC,KAAK;CACrD,CAAC;AAEW,QAAA,SAAS,GAAsB;IAC1C,iBAAiB,EAAE,IAAA,6BAAe,EAAC,qBAAa,EAAE,wBAAgB,CAAC;CACpE,CAAC;AAEW,QAAA,YAAY,GAAsB;IAC7C,iBAAiB,EAAE,IAAA,6BAAe,EAAC,MAAM,EAAE,wBAAgB,CAAC;CAC7D,CAAC;AAEW,QAAA,cAAc,GAAG;IAC5B,WAAW,EAAE,GAAG,qBAAa,IAAI,uBAAY,UAAU;IACvD,GAAG,iBAAS;CACb,CAAC;AAEF,4BAA4B;AACf,QAAA,YAAY,GAAiB;IACxC,IAAI,EAAE,GAAG,qBAAa,IAAI,uBAAY,MAAM;IAC5C,KAAK,EAAE,iBAAS;IAChB,EAAE,EAAE,IAAA,oBAAW,EAAA,kBAAkB,yBAAc,mBAAmB,iBAAS,CAAC,iBAAiB,wCAAwC,qBAAa,IAAI,uBAAY,MAAM;CACzK,CAAC;AAEF,6HAA6H;AAChH,QAAA,SAAS,GAAqB;IACzC,OAAO,EAAE,IAAA,oBAAW,EAAA,kBAAkB,yBAAc,mBAAmB,oBAAY,CAAC,iBAAiB,uDAAuD,qBAAa,IAAI,uBAAY,WAAW;CACrM,CAAC;AAEW,QAAA,cAAc,GAAqB;IAC9C,YAAY,EAAE,IAAA,oBAAW,EAAA,kBAAkB,yBAAc,mBAAmB,oBAAY,CAAC,iBAAiB,gDAAgD,qBAAa,GAAG,uBAAY,SAAS;CAChM,CAAC","sourcesContent":["import {BasicMonitorArgs, ConventionProps, KeyVaultInfo, ResourceGroupInfo} from '../types';\nimport { subscriptionId } from './AzureEnv';\nimport { getResourceName } from './ResourceEnv';\nimport { interpolate } from '@pulumi/pulumi';\nimport {organization} from \"./StackEnv\";\nexport const globalKeyName = 'global';\n\n/**The Global resource group name.*/\nexport const globalConvention: ConventionProps = {\n  prefix: globalKeyName,\n  suffix: organization ? `grp-${organization}` : 'grp',\n};\n\nexport const groupInfo: ResourceGroupInfo = {\n  resourceGroupName: getResourceName(globalKeyName, globalConvention),\n};\n\nexport const logGroupInfo: ResourceGroupInfo = {\n  resourceGroupName: getResourceName('logs', globalConvention),\n};\n\nexport const cdnProfileInfo = {\n  profileName: `${globalKeyName}-${organization}-cdn-pfl`,\n  ...groupInfo,\n};\n\n/** Global Key Vault Info */\nexport const keyVaultInfo: KeyVaultInfo = {\n  name: `${globalKeyName}-${organization}-vlt`,\n  group: groupInfo,\n  id: interpolate`/subscriptions/${subscriptionId}/resourceGroups/${groupInfo.resourceGroupName}/providers/Microsoft.KeyVault/vaults/${globalKeyName}-${organization}-vlt`,\n};\n\n/** Log will send to either storage or log workspace. Only a few important resources will use workspace like Firewall, Aks */\nexport const logWpInfo: BasicMonitorArgs = {\n  logWpId: interpolate`/subscriptions/${subscriptionId}/resourcegroups/${logGroupInfo.resourceGroupName}/providers/microsoft.operationalinsights/workspaces/${globalKeyName}-${organization}-logs-log`,\n};\n\nexport const logStorageInfo: BasicMonitorArgs = {\n  logStorageId: interpolate`/subscriptions/${subscriptionId}/resourceGroups/${logGroupInfo.resourceGroupName}/providers/Microsoft.Storage/storageAccounts/${globalKeyName}${organization}logsstg`,\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"72d17ea89b435b36c41c8a953dc944b6f6a63b18","contentHash":"2bcba1eb91fbb8a65bc18175069936e4df403fa332ffe97786bcaf5d9a2a378e"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/Helper.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/Helper.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":128}},"26":{"start":{"line":27,"column":17},"end":{"line":27,"column":71}},"27":{"start":{"line":28,"column":17},"end":{"line":28,"column":42}},"28":{"start":{"line":29,"column":15},"end":{"line":29,"column":49}},"29":{"start":{"line":30,"column":24},"end":{"line":30,"column":55}},"30":{"start":{"line":31,"column":27},"end":{"line":31,"column":61}},"31":{"start":{"line":32,"column":17},"end":{"line":32,"column":44}},"32":{"start":{"line":33,"column":18},"end":{"line":46,"column":1}},"33":{"start":{"line":34,"column":14},"end":{"line":34,"column":47}},"34":{"start":{"line":35,"column":4},"end":{"line":45,"column":22}},"35":{"start":{"line":40,"column":68},"end":{"line":40,"column":75}},"36":{"start":{"line":47,"column":0},"end":{"line":47,"column":30}},"37":{"start":{"line":48,"column":15},"end":{"line":71,"column":1}},"38":{"start":{"line":49,"column":14},"end":{"line":49,"column":47}},"39":{"start":{"line":50,"column":4},"end":{"line":70,"column":22}},"40":{"start":{"line":72,"column":0},"end":{"line":72,"column":24}},"41":{"start":{"line":73,"column":19},"end":{"line":73,"column":21}},"42":{"start":{"line":75,"column":15},"end":{"line":90,"column":1}},"43":{"start":{"line":76,"column":14},"end":{"line":76,"column":70}},"44":{"start":{"line":77,"column":21},"end":{"line":77,"column":45}},"45":{"start":{"line":79,"column":4},"end":{"line":80,"column":36}},"46":{"start":{"line":80,"column":8},"end":{"line":80,"column":36}},"47":{"start":{"line":81,"column":16},"end":{"line":81,"column":75}},"48":{"start":{"line":82,"column":19},"end":{"line":82,"column":84}},"49":{"start":{"line":83,"column":15},"end":{"line":86,"column":6}},"50":{"start":{"line":84,"column":8},"end":{"line":84,"column":66}},"51":{"start":{"line":85,"column":8},"end":{"line":85,"column":25}},"52":{"start":{"line":88,"column":4},"end":{"line":88,"column":33}},"53":{"start":{"line":89,"column":4},"end":{"line":89,"column":14}},"54":{"start":{"line":91,"column":0},"end":{"line":91,"column":24}},"55":{"start":{"line":92,"column":22},"end":{"line":92,"column":24}},"56":{"start":{"line":94,"column":18},"end":{"line":109,"column":1}},"57":{"start":{"line":95,"column":14},"end":{"line":95,"column":70}},"58":{"start":{"line":96,"column":21},"end":{"line":96,"column":45}},"59":{"start":{"line":98,"column":4},"end":{"line":99,"column":39}},"60":{"start":{"line":99,"column":8},"end":{"line":99,"column":39}},"61":{"start":{"line":100,"column":16},"end":{"line":100,"column":75}},"62":{"start":{"line":101,"column":19},"end":{"line":101,"column":90}},"63":{"start":{"line":102,"column":15},"end":{"line":105,"column":6}},"64":{"start":{"line":103,"column":8},"end":{"line":103,"column":66}},"65":{"start":{"line":104,"column":8},"end":{"line":104,"column":25}},"66":{"start":{"line":107,"column":4},"end":{"line":107,"column":33}},"67":{"start":{"line":108,"column":4},"end":{"line":108,"column":14}},"68":{"start":{"line":110,"column":0},"end":{"line":110,"column":30}},"69":{"start":{"line":111,"column":23},"end":{"line":118,"column":1}},"70":{"start":{"line":112,"column":19},"end":{"line":112,"column":37}},"71":{"start":{"line":113,"column":4},"end":{"line":117,"column":6}},"72":{"start":{"line":119,"column":0},"end":{"line":119,"column":40}},"73":{"start":{"line":121,"column":20},"end":{"line":129,"column":1}},"74":{"start":{"line":122,"column":19},"end":{"line":122,"column":36}},"75":{"start":{"line":123,"column":4},"end":{"line":128,"column":6}},"76":{"start":{"line":130,"column":0},"end":{"line":130,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":33,"column":18},"end":{"line":33,"column":19}},"loc":{"start":{"line":33,"column":81},"end":{"line":46,"column":1}},"line":33},"7":{"name":"(anonymous_7)","decl":{"start":{"line":40,"column":61},"end":{"line":40,"column":62}},"loc":{"start":{"line":40,"column":68},"end":{"line":40,"column":75}},"line":40},"8":{"name":"(anonymous_8)","decl":{"start":{"line":48,"column":15},"end":{"line":48,"column":16}},"loc":{"start":{"line":48,"column":58},"end":{"line":71,"column":1}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":75,"column":15},"end":{"line":75,"column":16}},"loc":{"start":{"line":75,"column":62},"end":{"line":90,"column":1}},"line":75},"10":{"name":"(anonymous_10)","decl":{"start":{"line":83,"column":44},"end":{"line":83,"column":45}},"loc":{"start":{"line":83,"column":53},"end":{"line":86,"column":5}},"line":83},"11":{"name":"(anonymous_11)","decl":{"start":{"line":94,"column":18},"end":{"line":94,"column":19}},"loc":{"start":{"line":94,"column":65},"end":{"line":109,"column":1}},"line":94},"12":{"name":"(anonymous_12)","decl":{"start":{"line":102,"column":47},"end":{"line":102,"column":48}},"loc":{"start":{"line":102,"column":56},"end":{"line":105,"column":5}},"line":102},"13":{"name":"(anonymous_13)","decl":{"start":{"line":111,"column":23},"end":{"line":111,"column":24}},"loc":{"start":{"line":111,"column":36},"end":{"line":118,"column":1}},"line":111},"14":{"name":"(anonymous_14)","decl":{"start":{"line":121,"column":20},"end":{"line":121,"column":21}},"loc":{"start":{"line":121,"column":32},"end":{"line":129,"column":1}},"line":121}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":40,"column":19},"end":{"line":40,"column":81}},"type":"cond-expr","locations":[{"start":{"line":40,"column":27},"end":{"line":40,"column":76}},{"start":{"line":40,"column":79},"end":{"line":40,"column":81}}],"line":40},"17":{"loc":{"start":{"line":40,"column":68},"end":{"line":40,"column":75}},"type":"binary-expr","locations":[{"start":{"line":40,"column":68},"end":{"line":40,"column":69}},{"start":{"line":40,"column":73},"end":{"line":40,"column":75}}],"line":40},"18":{"loc":{"start":{"line":41,"column":25},"end":{"line":41,"column":44}},"type":"binary-expr","locations":[{"start":{"line":41,"column":25},"end":{"line":41,"column":36}},{"start":{"line":41,"column":40},"end":{"line":41,"column":44}}],"line":41},"19":{"loc":{"start":{"line":76,"column":14},"end":{"line":76,"column":70}},"type":"cond-expr","locations":[{"start":{"line":76,"column":30},"end":{"line":76,"column":34}},{"start":{"line":76,"column":37},"end":{"line":76,"column":70}}],"line":76},"20":{"loc":{"start":{"line":79,"column":4},"end":{"line":80,"column":36}},"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":80,"column":36}},{"start":{"line":79,"column":4},"end":{"line":80,"column":36}}],"line":79},"21":{"loc":{"start":{"line":84,"column":44},"end":{"line":84,"column":62}},"type":"binary-expr","locations":[{"start":{"line":84,"column":44},"end":{"line":84,"column":55}},{"start":{"line":84,"column":59},"end":{"line":84,"column":62}}],"line":84},"22":{"loc":{"start":{"line":95,"column":14},"end":{"line":95,"column":70}},"type":"cond-expr","locations":[{"start":{"line":95,"column":30},"end":{"line":95,"column":34}},{"start":{"line":95,"column":37},"end":{"line":95,"column":70}}],"line":95},"23":{"loc":{"start":{"line":98,"column":4},"end":{"line":99,"column":39}},"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":99,"column":39}},{"start":{"line":98,"column":4},"end":{"line":99,"column":39}}],"line":98},"24":{"loc":{"start":{"line":103,"column":44},"end":{"line":103,"column":62}},"type":"binary-expr","locations":[{"start":{"line":103,"column":44},"end":{"line":103,"column":55}},{"start":{"line":103,"column":59},"end":{"line":103,"column":62}}],"line":103},"25":{"loc":{"start":{"line":126,"column":17},"end":{"line":126,"column":51}},"type":"cond-expr","locations":[{"start":{"line":126,"column":37},"end":{"line":126,"column":46}},{"start":{"line":126,"column":49},"end":{"line":126,"column":51}}],"line":126}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":1,"37":1,"38":0,"39":0,"40":1,"41":1,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":1,"55":1,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":1,"70":0,"71":0,"72":1,"73":1,"74":0,"75":0,"76":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/Helper.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/Helper.ts"],"names":[],"mappings":"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","sourcesContent":["import * as keyvault from \"@pulumi/azure-native/keyvault\";\nimport { Input, output, Resource } from \"@pulumi/pulumi\";\nimport { ClientCredential } from \"../CustomProviders/Base\";\nimport { KeyClient, KeyVaultKey } from \"@azure/keyvault-keys\";\nimport { KeyVaultInfo } from \"../types\";\nimport { KeyVaultSecret, SecretClient } from \"@azure/keyvault-secrets\";\nimport { getSecretName } from \"../Common/Naming\";\n//known issue: https://github.com/pulumi/pulumi-azure-native/issues/1013\n\ntype SecretProps = {\n  name: string;\n\n  value: Input<string>;\n  vaultInfo: KeyVaultInfo;\n\n  contentType?: Input<string>;\n\n  tags?: Input<{\n    [key: string]: Input<string>;\n  }>;\n  dependsOn?: Input<Resource> | Input<Input<Resource>[]>;\n};\n\nexport const addSecret = ({\n  name,\n  vaultInfo,\n  value,\n  contentType,\n  tags,\n  dependsOn,\n}: SecretProps) => {\n  const n = getSecretName(name);\n\n  return new keyvault.Secret(\n    name,\n    {\n      secretName: n,\n      vaultName: vaultInfo.name,\n      ...vaultInfo.group,\n      properties: {\n        value: value ? output(value).apply((v) => v || \"\") : \"\",\n        contentType: contentType || name,\n        attributes: { enabled: true },\n      },\n      tags,\n    },\n    { dependsOn }\n  );\n};\n\nexport const addKey = ({\n  name,\n  vaultInfo,\n  tags,\n  dependsOn,\n}: Omit<SecretProps, \"value\" | \"contentType\">) => {\n  const n = getSecretName(name);\n\n  return new keyvault.Key(\n    name,\n    {\n      keyName: n,\n      vaultName: vaultInfo.name,\n      ...vaultInfo.group,\n      //https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.keyvault.webkey?view=azure-dotnet-legacy\n      properties: {\n        keySize: 2048,\n        kty: \"RSA\",\n        keyOps: [\n          \"decrypt\",\n          \"encrypt\",\n          \"sign\",\n          \"verify\",\n          \"wrapKey\",\n          \"unwrapKey\",\n        ],\n        //curveName: 'P512',\n        attributes: { enabled: true },\n      },\n      tags,\n    },\n    { dependsOn }\n  );\n};\n\ntype GetVaultItemProps = {\n  name: string;\n  vaultInfo: KeyVaultInfo;\n  nameFormatted?: boolean;\n};\nconst _keysCache: any = {};\n/** Get Key */\nexport const getKey = async ({\n  name,\n  vaultInfo,\n  nameFormatted,\n}: GetVaultItemProps): Promise<KeyVaultKey | undefined> => {\n  const n = nameFormatted ? name : getSecretName(name);\n  const cacheKey = `${vaultInfo.name}-${n}`;\n  //Try get key from cache\n  if (_keysCache[cacheKey]) return _keysCache[cacheKey];\n\n  const url = `https://${vaultInfo.name}.vault.azure.net?api-version=7.0`;\n  const client = new KeyClient(url, new ClientCredential());\n\n  const rs = await client.getKey(n).catch((err) => {\n    console.error(`${vaultInfo.name}: ${err.message || err}`);\n    return undefined;\n  });\n\n  //Put value to cache\n  _secretsCache[cacheKey] = rs;\n  return rs;\n};\n\nconst _secretsCache: any = {};\n/** Get Secret */\nexport const getSecret = async ({\n  name,\n  vaultInfo,\n  nameFormatted,\n}: GetVaultItemProps): Promise<KeyVaultSecret | undefined> => {\n  const n = nameFormatted ? name : getSecretName(name);\n  const cacheKey = `${vaultInfo.name}-${n}`;\n  //Try get key from cache\n  if (_secretsCache[cacheKey]) return _secretsCache[cacheKey];\n\n  const url = `https://${vaultInfo.name}.vault.azure.net?api-version=7.0`;\n  const client = new SecretClient(url, new ClientCredential());\n\n  const rs = await client.getSecret(n).catch((err) => {\n    console.error(`${vaultInfo.name}: ${err.message || err}`);\n    return undefined;\n  });\n\n  //Put value to cache\n  _secretsCache[cacheKey] = rs;\n  return rs;\n};\n\nexport const parseVaultInfo = (vaultId: string): KeyVaultInfo => {\n  const splits = vaultId.split(\"/\");\n  return {\n    name: splits[8],\n    group: { resourceGroupName: splits[4] },\n    id: vaultId,\n  };\n};\n\ninterface KeyResult {\n  name: string;\n  /** The version may be empty if it is not found in the url */\n  version: string;\n  keyIdentityUrl: string;\n  vaultUrl: string;\n}\n\n/** Convert VaultId to VaultInfo */\nexport const parseKeyUrl = (keyUrl: string): KeyResult => {\n  const splits = keyUrl.split(\"/\");\n  return {\n    keyIdentityUrl: keyUrl,\n    name: splits[4],\n    version: splits.length > 4 ? splits[5] : \"\",\n    vaultUrl: `https://${splits[2]}`,\n  };\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9dcd99d63fa781eef44970818e78eed359fe6107","contentHash":"3d8c995452159a47fb28151d1522330a7f801ad25244671363a6a145e3a38196"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/index.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":19},"end":{"line":15,"column":1}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":126}},"13":{"start":{"line":14,"column":21},"end":{"line":14,"column":126}},"14":{"start":{"line":14,"column":95},"end":{"line":14,"column":126}},"15":{"start":{"line":16,"column":0},"end":{"line":16,"column":62}},"16":{"start":{"line":17,"column":0},"end":{"line":17,"column":49}},"17":{"start":{"line":18,"column":0},"end":{"line":18,"column":48}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":50},"end":{"line":13,"column":51}},"loc":{"start":{"line":13,"column":71},"end":{"line":15,"column":1}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":19},"end":{"line":15,"column":1}},"type":"binary-expr","locations":[{"start":{"line":13,"column":20},"end":{"line":13,"column":24}},{"start":{"line":13,"column":28},"end":{"line":13,"column":45}},{"start":{"line":13,"column":50},"end":{"line":15,"column":1}}],"line":13},"9":{"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":126}},"type":"if","locations":[{"start":{"line":14,"column":21},"end":{"line":14,"column":126}},{"start":{"line":14,"column":21},"end":{"line":14,"column":126}}],"line":14},"10":{"loc":{"start":{"line":14,"column":25},"end":{"line":14,"column":93}},"type":"binary-expr","locations":[{"start":{"line":14,"column":25},"end":{"line":14,"column":40}},{"start":{"line":14,"column":44},"end":{"line":14,"column":93}}],"line":14}},"s":{"0":1,"1":3,"2":3,"3":3,"4":3,"5":3,"6":1,"7":3,"8":0,"9":0,"10":0,"11":1,"12":2,"13":3,"14":3,"15":1,"16":1,"17":1},"f":{"0":3,"1":1,"2":0,"3":2},"b":{"0":[1,1,1],"1":[1,0],"2":[3,0],"3":[3,0],"4":[3,3],"5":[0,3],"6":[3,0],"7":[0,0],"8":[1,1,1],"9":[3,0],"10":[3,3]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/index.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA,iDAA+B;AAC/B,gDAA8B","sourcesContent":["export * from './BaseProvider';\nexport * from './Credentials';\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f59d23a32eb6dfeb4e385a61ca06bcdc9829460e","contentHash":"485dbda3af1d806ebf3392e5d3010bbe27217e2a96e1cb392eaba1343d4b3613"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/BaseProvider.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/BaseProvider.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":30}},"26":{"start":{"line":27,"column":15},"end":{"line":27,"column":54}},"27":{"start":{"line":30,"column":8},"end":{"line":30,"column":42}},"28":{"start":{"line":33,"column":0},"end":{"line":33,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":29,"column":4},"end":{"line":29,"column":5}},"loc":{"start":{"line":29,"column":44},"end":{"line":31,"column":5}},"line":29}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":0,"28":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/BaseProvider.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/BaseProvider.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uDAAyC;AAuDzC,MAAsB,YAGpB,SAAQ,MAAM,CAAC,OAAO,CAAC,QAAQ;IAC/B,YACE,QAAyC,EACzC,IAAY,EACZ,IAA0B,EAC1B,IAAmC;QAEnC,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IACpC,CAAC;CACF;AAZD,oCAYC","sourcesContent":["import * as pulumi from '@pulumi/pulumi';\n\n/**\n * DynamicProviderInputs represents the inputs that are passed as inputs\n * to each function in the implementation of a `pulumi.dynamic.ResourceProvider`.\n */\nexport interface DefaultInputs {}\n\n/**\n * The Outputs represents the output type of `create` function in the\n * dynamic resource provider.\n */\nexport interface DefaultOutputs extends Omit<DefaultInputs, 'result'> {\n  name: string;\n}\n\n/**\n * The Base Options represents the inputs to the dynamic resource.\n * Any property of type `Input<T>` will automatically be resolved to their type `T`\n * by the custom dynamic resource before passing them to the functions in the\n * dynamic resource provider.\n */\nexport type BaseOptions<TOptions = DefaultInputs> = {\n  [K in keyof TOptions]: pulumi.Input<TOptions[K]>;\n};\n\nexport type BaseOutputs<TOptions = DefaultInputs> = {\n  [K in keyof TOptions]: pulumi.Output<TOptions[K]>;\n};\n\nexport interface BaseProvider<\n  TInputs extends DefaultInputs,\n  TOutputs extends DefaultOutputs\n> extends pulumi.dynamic.ResourceProvider {\n  check?: (olds: TInputs, news: TInputs) => Promise<pulumi.dynamic.CheckResult>;\n\n  diff?: (\n    id: string,\n    previousOutput: TOutputs,\n    news: TInputs\n  ) => Promise<pulumi.dynamic.DiffResult>;\n\n  create: (inputs: TInputs) => Promise<pulumi.dynamic.CreateResult>;\n\n  read?: (id: string, props: TOutputs) => Promise<pulumi.dynamic.ReadResult>;\n\n  update?: (\n    id: string,\n    olds: TOutputs,\n    news: TInputs\n  ) => Promise<pulumi.dynamic.UpdateResult>;\n\n  delete?: (id: string, props: TOutputs) => Promise<void>;\n}\n\nexport abstract class BaseResource<\n  TInputs extends DefaultInputs,\n  TOutputs extends DefaultOutputs\n> extends pulumi.dynamic.Resource {\n  constructor(\n    provider: BaseProvider<TInputs, TOutputs>,\n    name: string,\n    args: BaseOptions<TInputs>,\n    opts?: pulumi.CustomResourceOptions\n  ) {\n    super(provider, name, args, opts);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a02cddd6bb5330376a6496dab981193e9553222","contentHash":"bffcfca0305e05e9d7a9e7b12c0db41d692d9ef62c7115f1e1fe05e7379e1bfb"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/Credentials.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/Credentials.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":64}},"26":{"start":{"line":27,"column":20},"end":{"line":27,"column":68}},"27":{"start":{"line":28,"column":15},"end":{"line":28,"column":60}},"28":{"start":{"line":29,"column":19},"end":{"line":29,"column":45}},"29":{"start":{"line":33,"column":8},"end":{"line":34,"column":35}},"30":{"start":{"line":34,"column":12},"end":{"line":34,"column":35}},"31":{"start":{"line":35,"column":23},"end":{"line":35,"column":45}},"32":{"start":{"line":36,"column":27},"end":{"line":36,"column":53}},"33":{"start":{"line":37,"column":23},"end":{"line":37,"column":45}},"34":{"start":{"line":38,"column":29},"end":{"line":38,"column":57}},"35":{"start":{"line":40,"column":8},"end":{"line":46,"column":9}},"36":{"start":{"line":42,"column":12},"end":{"line":42,"column":52}},"37":{"start":{"line":43,"column":12},"end":{"line":43,"column":60}},"38":{"start":{"line":44,"column":12},"end":{"line":44,"column":52}},"39":{"start":{"line":45,"column":12},"end":{"line":45,"column":64}},"40":{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},"41":{"start":{"line":48,"column":12},"end":{"line":48,"column":102}},"42":{"start":{"line":50,"column":8},"end":{"line":50,"column":31}},"43":{"start":{"line":53,"column":20},"end":{"line":53,"column":41}},"44":{"start":{"line":54,"column":8},"end":{"line":55,"column":49}},"45":{"start":{"line":55,"column":12},"end":{"line":55,"column":49}},"46":{"start":{"line":56,"column":25},"end":{"line":56,"column":67}},"47":{"start":{"line":57,"column":22},"end":{"line":59,"column":10}},"48":{"start":{"line":60,"column":8},"end":{"line":63,"column":10}},"49":{"start":{"line":66,"column":0},"end":{"line":66,"column":44}},"50":{"start":{"line":72,"column":8},"end":{"line":72,"column":30}},"51":{"start":{"line":75,"column":8},"end":{"line":76,"column":36}},"52":{"start":{"line":76,"column":12},"end":{"line":76,"column":36}},"53":{"start":{"line":77,"column":23},"end":{"line":77,"column":45}},"54":{"start":{"line":78,"column":27},"end":{"line":78,"column":53}},"55":{"start":{"line":79,"column":8},"end":{"line":79,"column":47}},"56":{"start":{"line":80,"column":8},"end":{"line":80,"column":59}},"57":{"start":{"line":82,"column":8},"end":{"line":88,"column":9}},"58":{"start":{"line":84,"column":12},"end":{"line":84,"column":52}},"59":{"start":{"line":85,"column":12},"end":{"line":85,"column":60}},"60":{"start":{"line":86,"column":12},"end":{"line":86,"column":57}},"61":{"start":{"line":87,"column":12},"end":{"line":87,"column":69}},"62":{"start":{"line":90,"column":8},"end":{"line":102,"column":9}},"63":{"start":{"line":93,"column":35},"end":{"line":93,"column":81}},"64":{"start":{"line":94,"column":12},"end":{"line":96,"column":55}},"65":{"start":{"line":97,"column":12},"end":{"line":97,"column":60}},"66":{"start":{"line":98,"column":12},"end":{"line":98,"column":46}},"67":{"start":{"line":101,"column":12},"end":{"line":101,"column":120}},"68":{"start":{"line":103,"column":8},"end":{"line":103,"column":32}},"69":{"start":{"line":107,"column":8},"end":{"line":107,"column":70}},"70":{"start":{"line":110,"column":18},"end":{"line":110,"column":45}},"71":{"start":{"line":111,"column":8},"end":{"line":111,"column":34}},"72":{"start":{"line":114,"column":0},"end":{"line":114,"column":50}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":21},"end":{"line":51,"column":5}},"line":32},"7":{"name":"(anonymous_7)","decl":{"start":{"line":52,"column":4},"end":{"line":52,"column":5}},"loc":{"start":{"line":52,"column":36},"end":{"line":64,"column":5}},"line":52},"8":{"name":"(anonymous_8)","decl":{"start":{"line":71,"column":4},"end":{"line":71,"column":5}},"loc":{"start":{"line":71,"column":18},"end":{"line":73,"column":5}},"line":71},"9":{"name":"(anonymous_9)","decl":{"start":{"line":74,"column":4},"end":{"line":74,"column":5}},"loc":{"start":{"line":74,"column":27},"end":{"line":104,"column":5}},"line":74},"10":{"name":"(anonymous_10)","decl":{"start":{"line":106,"column":4},"end":{"line":106,"column":5}},"loc":{"start":{"line":106,"column":35},"end":{"line":108,"column":5}},"line":106},"11":{"name":"(anonymous_11)","decl":{"start":{"line":109,"column":4},"end":{"line":109,"column":5}},"loc":{"start":{"line":109,"column":21},"end":{"line":112,"column":5}},"line":109}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":33,"column":8},"end":{"line":34,"column":35}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":34,"column":35}},{"start":{"line":33,"column":8},"end":{"line":34,"column":35}}],"line":33},"17":{"loc":{"start":{"line":40,"column":8},"end":{"line":46,"column":9}},"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":46,"column":9}},{"start":{"line":40,"column":8},"end":{"line":46,"column":9}}],"line":40},"18":{"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":70}},"type":"binary-expr","locations":[{"start":{"line":40,"column":12},"end":{"line":40,"column":21}},{"start":{"line":40,"column":25},"end":{"line":40,"column":38}},{"start":{"line":40,"column":42},"end":{"line":40,"column":51}},{"start":{"line":40,"column":55},"end":{"line":40,"column":70}}],"line":40},"19":{"loc":{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},{"start":{"line":47,"column":8},"end":{"line":49,"column":9}}],"line":47},"20":{"loc":{"start":{"line":47,"column":12},"end":{"line":47,"column":48}},"type":"binary-expr","locations":[{"start":{"line":47,"column":12},"end":{"line":47,"column":20}},{"start":{"line":47,"column":24},"end":{"line":47,"column":32}},{"start":{"line":47,"column":36},"end":{"line":47,"column":48}}],"line":47},"21":{"loc":{"start":{"line":54,"column":8},"end":{"line":55,"column":49}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":55,"column":49}},{"start":{"line":54,"column":8},"end":{"line":55,"column":49}}],"line":54},"22":{"loc":{"start":{"line":56,"column":25},"end":{"line":56,"column":67}},"type":"cond-expr","locations":[{"start":{"line":56,"column":49},"end":{"line":56,"column":58}},{"start":{"line":56,"column":61},"end":{"line":56,"column":67}}],"line":56},"23":{"loc":{"start":{"line":75,"column":8},"end":{"line":76,"column":36}},"type":"if","locations":[{"start":{"line":75,"column":8},"end":{"line":76,"column":36}},{"start":{"line":75,"column":8},"end":{"line":76,"column":36}}],"line":75},"24":{"loc":{"start":{"line":82,"column":8},"end":{"line":88,"column":9}},"type":"if","locations":[{"start":{"line":82,"column":8},"end":{"line":88,"column":9}},{"start":{"line":82,"column":8},"end":{"line":88,"column":9}}],"line":82},"25":{"loc":{"start":{"line":82,"column":12},"end":{"line":82,"column":80}},"type":"binary-expr","locations":[{"start":{"line":82,"column":12},"end":{"line":82,"column":21}},{"start":{"line":82,"column":25},"end":{"line":82,"column":38}},{"start":{"line":82,"column":42},"end":{"line":82,"column":56}},{"start":{"line":82,"column":60},"end":{"line":82,"column":80}}],"line":82},"26":{"loc":{"start":{"line":90,"column":8},"end":{"line":102,"column":9}},"type":"if","locations":[{"start":{"line":90,"column":8},"end":{"line":102,"column":9}},{"start":{"line":90,"column":8},"end":{"line":102,"column":9}}],"line":90},"27":{"loc":{"start":{"line":90,"column":12},"end":{"line":90,"column":80}},"type":"binary-expr","locations":[{"start":{"line":90,"column":12},"end":{"line":90,"column":21}},{"start":{"line":90,"column":25},"end":{"line":90,"column":38}},{"start":{"line":90,"column":42},"end":{"line":90,"column":56}},{"start":{"line":90,"column":60},"end":{"line":90,"column":80}}],"line":90},"28":{"loc":{"start":{"line":95,"column":16},"end":{"line":96,"column":54}},"type":"binary-expr","locations":[{"start":{"line":95,"column":16},"end":{"line":95,"column":53}},{"start":{"line":96,"column":20},"end":{"line":96,"column":54}}],"line":95}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":2,"16":2,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[2,0],"12":[2,2],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0,0,0],"19":[0,0],"20":[0,0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0,0,0],"26":[0,0],"27":[0,0,0,0],"28":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/Credentials.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/Base/Credentials.ts"],"names":[],"mappings":"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","sourcesContent":["import * as msRest from '@azure/ms-rest-js';\nimport * as msRestAzure from '@azure/ms-rest-nodeauth';\nimport * as native from '@pulumi/azure-native';\n\nimport { ClientSecretCredential, TokenCredential } from '@azure/identity';\n\nexport class ClientCredential implements TokenCredential {\n  credential!: ClientSecretCredential;\n\n  getCredentials() {\n    if (this.credential) return this.credential;\n\n    let clientID = native.config.clientId;\n    let clientSecret = native.config.clientSecret;\n    let tenantID = native.config.tenantId;\n    let subscriptionID = native.config.subscriptionId;\n\n    // If at least one of them is empty, try looking at the env vars.\n    if (!clientID || !clientSecret || !tenantID || !subscriptionID) {\n      //console.log('ClientCredential: getting auth info from ARM.');\n\n      clientID = process.env['ARM_CLIENT_ID'];\n      clientSecret = process.env['ARM_CLIENT_SECRET'];\n      tenantID = process.env['ARM_TENANT_ID'];\n      subscriptionID = process.env['ARM_SUBSCRIPTION_ID'];\n    }\n\n    if (tenantID && clientID && clientSecret) {\n      this.credential = new ClientSecretCredential(\n        tenantID,\n        clientID,\n        clientSecret\n      );\n    }\n    return this.credential;\n  }\n\n  async getToken(\n    scopes: string | string[],\n    options?: import('@azure/core-auth').GetTokenOptions | undefined\n  ): Promise<import('@azure/core-auth').AccessToken | null> {\n    const cre = this.getCredentials();\n    if (cre) return cre.getToken(scopes, options);\n\n    const resource = Array.isArray(scopes) ? scopes[0] : scopes;\n    const token = await msRestAzure.AzureCliCredentials.getAccessToken({\n      resource: resource.replace('/.default', ''),\n    });\n\n    return {\n      token: token.accessToken,\n      expiresOnTimestamp: 30,\n    };\n  }\n}\n\nexport class InternalCredentials implements msRest.ServiceClientCredentials {\n  private credentials!:\n    | msRestAzure.AzureCliCredentials\n    | msRestAzure.ApplicationTokenCredentials;\n  public subscriptionID!: string | undefined;\n  public tenantID!: string | undefined;\n\n  constructor() {\n    this.getCredentials();\n  }\n\n  public async getCredentials(): Promise<\n    msRestAzure.AzureCliCredentials | msRestAzure.ApplicationTokenCredentials\n  > {\n    if (this.credentials) return this.credentials;\n\n    let clientID = native.config.clientId;\n    let clientSecret = native.config.clientSecret;\n    this.tenantID = native.config.tenantId;\n    this.subscriptionID = native.config.subscriptionId;\n\n    // If at least one of them is empty, try looking at the env vars.\n    if (!clientID || !clientSecret || !this.tenantID || !this.subscriptionID) {\n      //console.log('ClientCredential: getting auth info from ARM.');\n\n      clientID = process.env['ARM_CLIENT_ID'];\n      clientSecret = process.env['ARM_CLIENT_SECRET'];\n      this.tenantID = process.env['ARM_TENANT_ID'];\n      this.subscriptionID = process.env['ARM_SUBSCRIPTION_ID'];\n    }\n\n    // If they are still empty, try to get the credentials from Az CLI.\n    if (!clientID || !clientSecret || !this.tenantID || !this.subscriptionID) {\n      //console.log('ClientCredential: getting auth info from Azure CLI.');\n      // `create()` will throw an error if the Az CLI is not installed or `az login` has never been run.\n      const cliCredentials = await msRestAzure.AzureCliCredentials.create();\n      this.subscriptionID =\n        cliCredentials.tokenInfo.subscription ||\n        cliCredentials.subscriptionInfo.id;\n      this.tenantID = cliCredentials.tokenInfo.tenant;\n      this.credentials = cliCredentials;\n    } else {\n      this.credentials = await msRestAzure.loginWithServicePrincipalSecret(\n        clientID,\n        clientSecret,\n        this.tenantID\n      );\n    }\n\n    return this.credentials;\n  }\n\n  /** Fixed some incompatible issue */\n  public async signRequest(webResource: any): Promise<any> {\n    return (await this.getCredentials()).signRequest(webResource);\n  }\n\n  public async getToken() {\n    const c = await this.getCredentials();\n    return await c.getToken();\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"68d4f600ff0de7840fae72e5910134919effab92","contentHash":"43c3b84f36e12c95d0c55811f763308c4d164f9a43a3ef7ae930d5367b88c62e"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Storage/Helper.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Storage/Helper.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"25":{"start":{"line":26,"column":4},"end":{"line":26,"column":62}},"26":{"start":{"line":28,"column":0},"end":{"line":28,"column":62}},"27":{"start":{"line":29,"column":0},"end":{"line":29,"column":59}},"28":{"start":{"line":30,"column":16},"end":{"line":30,"column":69}},"29":{"start":{"line":31,"column":16},"end":{"line":31,"column":49}},"30":{"start":{"line":32,"column":17},"end":{"line":32,"column":44}},"31":{"start":{"line":33,"column":17},"end":{"line":33,"column":46}},"32":{"start":{"line":34,"column":26},"end":{"line":61,"column":1}},"33":{"start":{"line":35,"column":27},"end":{"line":35,"column":68}},"34":{"start":{"line":36,"column":29},"end":{"line":36,"column":72}},"35":{"start":{"line":37,"column":37},"end":{"line":37,"column":85}},"36":{"start":{"line":38,"column":36},"end":{"line":38,"column":86}},"37":{"start":{"line":39,"column":79},"end":{"line":47,"column":7}},"38":{"start":{"line":45,"column":18},"end":{"line":45,"column":48}},"39":{"start":{"line":46,"column":8},"end":{"line":46,"column":84}},"40":{"start":{"line":48,"column":4},"end":{"line":60,"column":6}},"41":{"start":{"line":62,"column":0},"end":{"line":62,"column":46}},"42":{"start":{"line":63,"column":22},"end":{"line":72,"column":2}},"43":{"start":{"line":63,"column":43},"end":{"line":72,"column":2}},"44":{"start":{"line":73,"column":0},"end":{"line":73,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":56},"end":{"line":25,"column":57}},"loc":{"start":{"line":25,"column":71},"end":{"line":27,"column":1}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":34,"column":26},"end":{"line":34,"column":27}},"loc":{"start":{"line":34,"column":64},"end":{"line":61,"column":1}},"line":34},"8":{"name":"(anonymous_8)","decl":{"start":{"line":44,"column":10},"end":{"line":44,"column":11}},"loc":{"start":{"line":44,"column":17},"end":{"line":47,"column":5}},"line":44},"9":{"name":"(anonymous_9)","decl":{"start":{"line":63,"column":22},"end":{"line":63,"column":23}},"loc":{"start":{"line":63,"column":43},"end":{"line":72,"column":2}},"line":63}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":51}},{"start":{"line":25,"column":56},"end":{"line":27,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":61}},"type":"cond-expr","locations":[{"start":{"line":26,"column":37},"end":{"line":26,"column":40}},{"start":{"line":26,"column":43},"end":{"line":26,"column":61}}],"line":26},"18":{"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":33}},"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":33}}],"line":26}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":1,"43":0,"44":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":0,"8":0,"9":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[1,1,1],"17":[0,1],"18":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Storage/Helper.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Storage/Helper.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,sEAAwD;AACxD,kDAA0B;AAE1B,6CAAgF;AAChF,+CAA+C;AAKxC,MAAM,iBAAiB,GAAG,KAAK,EACpC,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAuE,EAC/F,EAAE;IACF,MAAM,cAAc,GAAG,IAAA,mBAAU,EAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IACnD,MAAM,gBAAgB,GAAG,IAAA,mBAAU,EAAC,IAAI,EAAE,WAAW,CAAC,CAAC;IACvD,MAAM,wBAAwB,GAAG,IAAA,0BAAiB,EAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IACpE,MAAM,uBAAuB,GAAG,IAAA,0BAAiB,EAAC,IAAI,EAAE,WAAW,CAAC,CAAC;IAErE,MAAM,CAAC,iBAAiB,EAAE,mBAAmB,EAAE,UAAU,EAAE,YAAY,CAAC,GACtE,MAAM,OAAO,CAAC,GAAG,CACf;QACE,wBAAwB;QACxB,uBAAuB;QACvB,cAAc;QACd,gBAAgB;KACjB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QACV,MAAM,CAAC,GAAG,IAAA,sBAAa,EAAC,CAAC,CAAC,CAAC;QAC3B,OAAO,IAAA,kBAAS,EAAC,EAAE,IAAI,EAAE,CAAC,EAAE,SAAS,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC;IAChE,CAAC,CAAC,CACH,CAAC;IAEJ,OAAO;QAEL,iBAAiB,EAAE,iBAAiB,EAAE,KAAK;QAC3C,mBAAmB,EAAE,mBAAmB,EAAE,KAAK;QAC/C,UAAU,EAAE,UAAU,EAAE,KAAK;QAC7B,YAAY,EAAE,YAAY,EAAE,KAAK;QAEjC,SAAS,EAAE;YACT,IAAI,EAAE,WAAW,IAAI,wBAAwB;YAC7C,IAAI,EAAE,WAAW,IAAI,wBAAwB;YAC7C,KAAK,EAAE,WAAW,IAAI,yBAAyB;YAC/C,UAAU,EAAE,WAAW,IAAI,2BAA2B;YACtD,QAAQ,EAAE,WAAW,IAAI,uBAAuB;SACjD;KACF,CAAC;AACJ,CAAC,CAAC;AApCW,QAAA,iBAAiB,qBAoC5B;AAEK,MAAM,aAAa,GAAG,CAAC,EAAE,KAAK,EAAE,IAAI,EAAqB,EAAE,EAAE,CAClE,OAAO,CAAC,qBAAqB,CAAC;IAC5B,WAAW,EAAE,IAAI;IACjB,GAAG,KAAK;IACR,aAAa,EAAE,OAAO,CAAC,mBAAmB,CAAC,CAAC;IAC5C,QAAQ,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC5B,WAAW,EAAE,OAAO,CAAC,WAAW,CAAC,CAAC;IAClC,SAAS,EAAE,OAAO,CAAC,YAAY,CAAC,KAAK;IACrC,qBAAqB,EAAE,IAAA,eAAK,GAAE,CAAC,WAAW,EAAE;IAC5C,sBAAsB,EAAE,IAAA,eAAK,GAAE,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,WAAW,EAAE;CAC7D,CAAC,CAAC;AAVQ,QAAA,aAAa,iBAUrB","sourcesContent":["import * as storage from '@pulumi/azure-native/storage';\nimport dayjs from 'dayjs';\n\nimport { getConnectionName, getKeyName, getSecretName } from '../Common/Naming';\nimport { getSecret } from '../KeyVault/Helper';\nimport { BasicResourceArgs, KeyVaultInfo } from '../types';\nimport { ResourceGroupInfo } from './../types.d';\n\n\nexport const getStorageSecrets = async (\n  { name, group, vaultInfo }: { name: string, group: ResourceGroupInfo, vaultInfo: KeyVaultInfo }\n) => {\n  const primaryKeyName = getKeyName(name, 'primary');\n  const secondaryKeyName = getKeyName(name, 'secondary');\n  const primaryConnectionKeyName = getConnectionName(name, 'primary');\n  const secondConnectionKeyName = getConnectionName(name, 'secondary');\n\n  const [primaryConnection, secondaryConnection, primaryKey, secondaryKey] =\n    await Promise.all(\n      [\n        primaryConnectionKeyName,\n        secondConnectionKeyName,\n        primaryKeyName,\n        secondaryKeyName,\n      ].map((k) => {\n        const n = getSecretName(k);\n        return getSecret({ name: n, vaultInfo, nameFormatted: true });\n      })\n    );\n\n  return {\n\n    primaryConnection: primaryConnection?.value,\n    secondaryConnection: secondaryConnection?.value,\n    primaryKey: primaryKey?.value,\n    secondaryKey: secondaryKey?.value,\n\n    endpoints: {\n      blob: `https://${name}.blob.core.windows.net`,\n      file: `https://${name}.file.core.windows.net`,\n      table: `https://${name}.table.core.windows.net`,\n      staticSite: `https://${name}.z23.web.core.windows.net`,\n      DataLake: `https://${name}.dfs.core.windows.net`,\n    },\n  };\n};\n\nexport const getAccountSAS = ({ group, name }: BasicResourceArgs) =>\n  storage.listStorageAccountSAS({\n    accountName: name,\n    ...group,\n    resourceTypes: storage.SignedResourceTypes.C,\n    services: storage.Services.B,\n    permissions: storage.Permissions.W,\n    protocols: storage.HttpProtocol.Https,\n    sharedAccessStartTime: dayjs().toISOString(),\n    sharedAccessExpiryTime: dayjs().add(3, 'year').toISOString(),\n  });\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"680f61152aa9189bd646fe9184ca7d6230f6f67c","contentHash":"d883b73d47fc0cada840af3467699bf7aa83239ad13c95abd41726d62cb3380a"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateEndpoint.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateEndpoint.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":16},"end":{"line":26,"column":69}},"26":{"start":{"line":27,"column":17},"end":{"line":27,"column":42}},"27":{"start":{"line":28,"column":19},"end":{"line":28,"column":48}},"28":{"start":{"line":29,"column":17},"end":{"line":29,"column":36}},"29":{"start":{"line":30,"column":21},"end":{"line":30,"column":58}},"30":{"start":{"line":31,"column":22},"end":{"line":31,"column":54}},"31":{"start":{"line":32,"column":0},"end":{"line":93,"column":2}},"32":{"start":{"line":33,"column":21},"end":{"line":45,"column":6}},"33":{"start":{"line":47,"column":24},"end":{"line":47,"column":95}},"34":{"start":{"line":47,"column":63},"end":{"line":47,"column":94}},"35":{"start":{"line":47,"column":80},"end":{"line":47,"column":93}},"36":{"start":{"line":48,"column":4},"end":{"line":90,"column":7}},"37":{"start":{"line":49,"column":29},"end":{"line":49,"column":73}},"38":{"start":{"line":50,"column":8},"end":{"line":89,"column":9}},"39":{"start":{"line":52,"column":12},"end":{"line":56,"column":15}},"40":{"start":{"line":58,"column":12},"end":{"line":64,"column":15}},"41":{"start":{"line":59,"column":31},"end":{"line":59,"column":71}},"42":{"start":{"line":60,"column":16},"end":{"line":63,"column":19}},"43":{"start":{"line":68,"column":25},"end":{"line":71,"column":14}},"44":{"start":{"line":73,"column":12},"end":{"line":78,"column":15}},"45":{"start":{"line":80,"column":12},"end":{"line":88,"column":15}},"46":{"start":{"line":81,"column":31},"end":{"line":81,"column":71}},"47":{"start":{"line":82,"column":16},"end":{"line":87,"column":19}},"48":{"start":{"line":92,"column":4},"end":{"line":92,"column":20}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":32,"column":18},"end":{"line":32,"column":19}},"loc":{"start":{"line":32,"column":121},"end":{"line":93,"column":1}},"line":32},"7":{"name":"(anonymous_7)","decl":{"start":{"line":47,"column":56},"end":{"line":47,"column":57}},"loc":{"start":{"line":47,"column":63},"end":{"line":47,"column":94}},"line":47},"8":{"name":"(anonymous_8)","decl":{"start":{"line":47,"column":73},"end":{"line":47,"column":74}},"loc":{"start":{"line":47,"column":80},"end":{"line":47,"column":93}},"line":47},"9":{"name":"(anonymous_9)","decl":{"start":{"line":48,"column":43},"end":{"line":48,"column":44}},"loc":{"start":{"line":48,"column":51},"end":{"line":90,"column":5}},"line":48},"10":{"name":"(anonymous_10)","decl":{"start":{"line":58,"column":49},"end":{"line":58,"column":50}},"loc":{"start":{"line":58,"column":58},"end":{"line":64,"column":13}},"line":58},"11":{"name":"(anonymous_11)","decl":{"start":{"line":80,"column":49},"end":{"line":80,"column":50}},"loc":{"start":{"line":80,"column":58},"end":{"line":88,"column":13}},"line":80}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":50,"column":8},"end":{"line":89,"column":9}},"type":"if","locations":[{"start":{"line":50,"column":8},"end":{"line":89,"column":9}},{"start":{"line":50,"column":8},"end":{"line":89,"column":9}}],"line":50},"17":{"loc":{"start":{"line":54,"column":28},"end":{"line":54,"column":52}},"type":"binary-expr","locations":[{"start":{"line":54,"column":28},"end":{"line":54,"column":46}},{"start":{"line":54,"column":50},"end":{"line":54,"column":52}}],"line":54}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":2,"16":2,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[2,0],"12":[2,2],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateEndpoint.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateEndpoint.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,sEAAwD;AAExD,2CAAuD;AAOvD,iDAAiD;AACjD,qCAAiD;AACjD,2DAIsB;AACtB,uDAA8D;AAQ9D,kBAAe,CAAC,EACd,IAAI,EACJ,KAAK,EACL,UAAU,EACV,QAAQ,EACR,kBAAkB,EAClB,gBAAgB,EAChB,mBAAmB,GACb,EAAE,EAAE;IACV,MAAM,QAAQ,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,IAAI,EAAE;QACjD,mBAAmB,EAAE,IAAI;QACzB,GAAG,KAAK;QAER,MAAM,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE;QACxB,6BAA6B,EAAE;YAC7B;gBACE,QAAQ,EAAE,mBAAmB;gBAC7B,IAAI,EAAE,GAAG,IAAI,OAAO;gBACpB,oBAAoB,EAAE,UAAU;aACjC;SACF;QACD,IAAI,EAAE,sBAAW;KAClB,CAAC,CAAC;IAEH,kBAAkB;IAClB,MAAM,WAAW,GAAG,QAAQ,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CACxD,CAAE,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,WAAY,CAAC,CAClC,CAAC;IAEF,IAAA,eAAM,EAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,EAAE;QAC9B,MAAM,YAAY,GAAG,IAAA,mCAAqB,EAAC,EAAE,CAAC,CAAC;QAE/C,IAAI,gBAAgB,EAAE;YACpB,cAAc;YACd,IAAA,uBAAU,EAAC;gBACT,WAAW;gBACX,UAAU,EAAE,YAAY,EAAE,IAAI,IAAI,EAAE;gBACpC,QAAQ,EAAE,kBAAkB;aAC7B,CAAC,CAAC;YAEH,cAAc;YACd,IAAA,eAAM,EAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE;gBAC7B,MAAM,MAAM,GAAG,IAAA,8BAAqB,EAAC,GAAG,CAAC,CAAC;gBAC1C,IAAA,iCAAoB,EAAC;oBACnB,QAAQ,EAAE,kBAAkB;oBAC5B,MAAM;iBACP,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;SACJ;aAAM;YACL,aAAa;YACb,MAAM,IAAI,GAAG,IAAA,oBAAW,EAAC;gBACvB,IAAI,EAAE,GAAG,YAAY,EAAE,IAAI,IAAI,kBAAkB,EAAE;gBACnD,KAAK;aACN,CAAC,CAAC;YAEH,iBAAiB;YACjB,IAAA,uBAAU,EAAC;gBACT,WAAW;gBACX,UAAU,EAAE,GAAG;gBACf,QAAQ,EAAE,kBAAkB;gBAC5B,SAAS,EAAE,IAAI;aAChB,CAAC,CAAC;YACH,cAAc;YACd,IAAA,eAAM,EAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE;gBAC7B,MAAM,MAAM,GAAG,IAAA,8BAAqB,EAAC,GAAG,CAAC,CAAC;gBAC1C,IAAA,iCAAoB,EAAC;oBACnB,QAAQ,EAAE,kBAAkB;oBAC5B,MAAM;oBACN,KAAK;oBACL,SAAS,EAAE,IAAI;iBAChB,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;SACJ;IACH,CAAC,CAAC,CAAC;IACH,2EAA2E;IAC3E,OAAO,QAAQ,CAAC;AAClB,CAAC,CAAC","sourcesContent":["import * as network from '@pulumi/azure-native/network';\n\nimport { Input, output, Output } from '@pulumi/pulumi';\n\nimport {\n  BasicResourceArgs,\n  PrivateLinkProps,\n  ResourceGroupInfo,\n} from '../types';\nimport { defaultTags } from '../Common/AzureEnv';\nimport { getVnetIdFromSubnetId } from './Helper';\nimport PrivateZone, {\n  linkVnetToPrivateDns,\n  addARecord,\n  getPrivateZone,\n} from './PrivateDns';\nimport { getResourceInfoFromId } from '../Common/ResourceEnv';\n\ninterface Props extends BasicResourceArgs, PrivateLinkProps {\n  resourceId: Input<string>;\n  privateDnsZoneName: string;\n  linkServiceGroupIds: string[];\n}\n\nexport default ({\n  name,\n  group,\n  resourceId,\n  subnetId,\n  privateDnsZoneName,\n  useGlobalDnsZone,\n  linkServiceGroupIds,\n}: Props) => {\n  const endpoint = new network.PrivateEndpoint(name, {\n    privateEndpointName: name,\n    ...group,\n\n    subnet: { id: subnetId },\n    privateLinkServiceConnections: [\n      {\n        groupIds: linkServiceGroupIds,\n        name: `${name}-conn`,\n        privateLinkServiceId: resourceId,\n      },\n    ],\n    tags: defaultTags,\n  });\n\n  //Get IpAddress in\n  const ipAddresses = endpoint.customDnsConfigs.apply((c) =>\n    c!.flatMap((i) => i.ipAddresses!)\n  );\n\n  output(resourceId).apply((id) => {\n    const resourceInfo = getResourceInfoFromId(id);\n\n    if (useGlobalDnsZone) {\n      //Add A Record\n      addARecord({\n        ipAddresses,\n        recordName: resourceInfo?.name || '',\n        zoneName: privateDnsZoneName,\n      });\n\n      //Link to Vnet\n      output(subnetId).apply((sId) => {\n        const vnetId = getVnetIdFromSubnetId(sId);\n        linkVnetToPrivateDns({\n          zoneName: privateDnsZoneName,\n          vnetId,\n        });\n      });\n    } else {\n      //Create Zone\n      const zone = PrivateZone({\n        name: `${resourceInfo?.name}.${privateDnsZoneName}`,\n        group,\n      });\n\n      //Add Root Record\n      addARecord({\n        ipAddresses,\n        recordName: '@',\n        zoneName: privateDnsZoneName,\n        dependsOn: zone,\n      });\n      //Link to Vnet\n      output(subnetId).apply((sId) => {\n        const vnetId = getVnetIdFromSubnetId(sId);\n        linkVnetToPrivateDns({\n          zoneName: privateDnsZoneName,\n          vnetId,\n          group,\n          dependsOn: zone,\n        });\n      });\n    }\n  });\n  //TODO: Create private DNS Zone in the same resource group and link to VNet\n  return endpoint;\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"91a9449d66fa017e0e31318b2f473e28f5f25a01","contentHash":"bea944b170bbfd622448a3c459e0f48be62234579fe5e577b71c379e68f2aab5"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/Helper.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/Helper.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":354}},"26":{"start":{"line":27,"column":16},"end":{"line":27,"column":69}},"27":{"start":{"line":28,"column":17},"end":{"line":28,"column":42}},"28":{"start":{"line":29,"column":16},"end":{"line":29,"column":48}},"29":{"start":{"line":30,"column":19},"end":{"line":30,"column":48}},"30":{"start":{"line":31,"column":17},"end":{"line":31,"column":44}},"31":{"start":{"line":32,"column":0},"end":{"line":32,"column":45}},"32":{"start":{"line":33,"column":0},"end":{"line":33,"column":44}},"33":{"start":{"line":34,"column":0},"end":{"line":34,"column":49}},"34":{"start":{"line":35,"column":0},"end":{"line":35,"column":69}},"35":{"start":{"line":36,"column":0},"end":{"line":36,"column":51}},"36":{"start":{"line":37,"column":20},"end":{"line":41,"column":1}},"37":{"start":{"line":38,"column":18},"end":{"line":38,"column":45}},"38":{"start":{"line":40,"column":4},"end":{"line":40,"column":17}},"39":{"start":{"line":42,"column":0},"end":{"line":42,"column":34}},"40":{"start":{"line":44,"column":25},"end":{"line":50,"column":2}},"41":{"start":{"line":44,"column":40},"end":{"line":50,"column":2}},"42":{"start":{"line":45,"column":4},"end":{"line":48,"column":5}},"43":{"start":{"line":46,"column":22},"end":{"line":46,"column":50}},"44":{"start":{"line":47,"column":8},"end":{"line":47,"column":59}},"45":{"start":{"line":49,"column":4},"end":{"line":49,"column":34}},"46":{"start":{"line":51,"column":0},"end":{"line":51,"column":44}},"47":{"start":{"line":52,"column":30},"end":{"line":57,"column":1}},"48":{"start":{"line":54,"column":15},"end":{"line":54,"column":44}},"49":{"start":{"line":56,"column":4},"end":{"line":56,"column":14}},"50":{"start":{"line":58,"column":0},"end":{"line":58,"column":54}},"51":{"start":{"line":60,"column":27},"end":{"line":85,"column":1}},"52":{"start":{"line":61,"column":39},"end":{"line":61,"column":50}},"53":{"start":{"line":62,"column":31},"end":{"line":62,"column":42}},"54":{"start":{"line":63,"column":35},"end":{"line":63,"column":46}},"55":{"start":{"line":65,"column":4},"end":{"line":75,"column":7}},"56":{"start":{"line":66,"column":8},"end":{"line":68,"column":9}},"57":{"start":{"line":67,"column":12},"end":{"line":67,"column":77}},"58":{"start":{"line":69,"column":8},"end":{"line":71,"column":9}},"59":{"start":{"line":70,"column":12},"end":{"line":70,"column":61}},"60":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"61":{"start":{"line":73,"column":12},"end":{"line":73,"column":69}},"62":{"start":{"line":77,"column":4},"end":{"line":77,"column":83}},"63":{"start":{"line":77,"column":50},"end":{"line":77,"column":80}},"64":{"start":{"line":78,"column":4},"end":{"line":78,"column":75}},"65":{"start":{"line":78,"column":42},"end":{"line":78,"column":72}},"66":{"start":{"line":79,"column":4},"end":{"line":79,"column":79}},"67":{"start":{"line":79,"column":46},"end":{"line":79,"column":76}},"68":{"start":{"line":80,"column":4},"end":{"line":84,"column":6}},"69":{"start":{"line":86,"column":0},"end":{"line":86,"column":48}},"70":{"start":{"line":88,"column":26},"end":{"line":92,"column":1}},"71":{"start":{"line":89,"column":21},"end":{"line":89,"column":59}},"72":{"start":{"line":90,"column":18},"end":{"line":90,"column":65}},"73":{"start":{"line":91,"column":4},"end":{"line":91,"column":185}},"74":{"start":{"line":93,"column":0},"end":{"line":93,"column":46}},"75":{"start":{"line":94,"column":23},"end":{"line":98,"column":1}},"76":{"start":{"line":95,"column":14},"end":{"line":95,"column":50}},"77":{"start":{"line":96,"column":18},"end":{"line":96,"column":63}},"78":{"start":{"line":97,"column":4},"end":{"line":97,"column":158}},"79":{"start":{"line":99,"column":0},"end":{"line":99,"column":40}},"80":{"start":{"line":100,"column":29},"end":{"line":107,"column":1}},"81":{"start":{"line":101,"column":14},"end":{"line":101,"column":50}},"82":{"start":{"line":102,"column":18},"end":{"line":102,"column":63}},"83":{"start":{"line":103,"column":4},"end":{"line":106,"column":7}},"84":{"start":{"line":108,"column":0},"end":{"line":108,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":37,"column":20},"end":{"line":37,"column":21}},"loc":{"start":{"line":37,"column":32},"end":{"line":41,"column":1}},"line":37},"7":{"name":"(anonymous_7)","decl":{"start":{"line":44,"column":25},"end":{"line":44,"column":26}},"loc":{"start":{"line":44,"column":40},"end":{"line":50,"column":2}},"line":44},"8":{"name":"(anonymous_8)","decl":{"start":{"line":44,"column":54},"end":{"line":44,"column":55}},"loc":{"start":{"line":44,"column":62},"end":{"line":50,"column":1}},"line":44},"9":{"name":"(anonymous_9)","decl":{"start":{"line":52,"column":30},"end":{"line":52,"column":31}},"loc":{"start":{"line":52,"column":44},"end":{"line":57,"column":1}},"line":52},"10":{"name":"(anonymous_10)","decl":{"start":{"line":60,"column":27},"end":{"line":60,"column":28}},"loc":{"start":{"line":60,"column":59},"end":{"line":85,"column":1}},"line":60},"11":{"name":"(anonymous_11)","decl":{"start":{"line":65,"column":18},"end":{"line":65,"column":19}},"loc":{"start":{"line":65,"column":25},"end":{"line":75,"column":5}},"line":65},"12":{"name":"(anonymous_12)","decl":{"start":{"line":77,"column":39},"end":{"line":77,"column":40}},"loc":{"start":{"line":77,"column":50},"end":{"line":77,"column":80}},"line":77},"13":{"name":"(anonymous_13)","decl":{"start":{"line":78,"column":31},"end":{"line":78,"column":32}},"loc":{"start":{"line":78,"column":42},"end":{"line":78,"column":72}},"line":78},"14":{"name":"(anonymous_14)","decl":{"start":{"line":79,"column":35},"end":{"line":79,"column":36}},"loc":{"start":{"line":79,"column":46},"end":{"line":79,"column":76}},"line":79},"15":{"name":"(anonymous_15)","decl":{"start":{"line":88,"column":26},"end":{"line":88,"column":27}},"loc":{"start":{"line":88,"column":60},"end":{"line":92,"column":1}},"line":88},"16":{"name":"(anonymous_16)","decl":{"start":{"line":94,"column":23},"end":{"line":94,"column":24}},"loc":{"start":{"line":94,"column":49},"end":{"line":98,"column":1}},"line":94},"17":{"name":"(anonymous_17)","decl":{"start":{"line":100,"column":29},"end":{"line":100,"column":30}},"loc":{"start":{"line":100,"column":55},"end":{"line":107,"column":1}},"line":100}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":45,"column":4},"end":{"line":48,"column":5}},"type":"if","locations":[{"start":{"line":45,"column":4},"end":{"line":48,"column":5}},{"start":{"line":45,"column":4},"end":{"line":48,"column":5}}],"line":45},"17":{"loc":{"start":{"line":60,"column":35},"end":{"line":60,"column":54}},"type":"default-arg","locations":[{"start":{"line":60,"column":51},"end":{"line":60,"column":54}}],"line":60},"18":{"loc":{"start":{"line":66,"column":8},"end":{"line":68,"column":9}},"type":"if","locations":[{"start":{"line":66,"column":8},"end":{"line":68,"column":9}},{"start":{"line":66,"column":8},"end":{"line":68,"column":9}}],"line":66},"19":{"loc":{"start":{"line":69,"column":8},"end":{"line":71,"column":9}},"type":"if","locations":[{"start":{"line":69,"column":8},"end":{"line":71,"column":9}},{"start":{"line":69,"column":8},"end":{"line":71,"column":9}}],"line":69},"20":{"loc":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},{"start":{"line":72,"column":8},"end":{"line":74,"column":9}}],"line":72}},"s":{"0":1,"1":3,"2":3,"3":3,"4":3,"5":3,"6":0,"7":3,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":2,"16":1,"17":1,"18":1,"19":1,"20":3,"21":3,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":0,"38":0,"39":1,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":1,"48":0,"49":0,"50":1,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1,"70":1,"71":0,"72":0,"73":0,"74":1,"75":1,"76":0,"77":0,"78":0,"79":1,"80":1,"81":0,"82":0,"83":0,"84":1},"f":{"0":3,"1":0,"2":0,"3":1,"4":0,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"0":[1,1,1],"1":[1,0],"2":[3,0],"3":[3,0],"4":[3,3],"5":[0,3],"6":[3,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,1],"12":[2,2],"13":[1,0],"14":[3,0],"15":[3,3],"16":[0,0],"17":[0],"18":[0,0],"19":[0,0],"20":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/Helper.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/Helper.ts"],"names":[],"mappings":"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","sourcesContent":["import * as network from \"@pulumi/azure-native/network\";\nimport { input as inputs } from \"@pulumi/azure-native/types\";\nimport { interpolate, Output } from \"@pulumi/pulumi\";\nimport * as netmask from \"netmask\";\n\nimport { subscriptionId } from \"../Common/AzureEnv\";\nimport {\n  getIpAddressName,\n  getResourceGroupName,\n  getVnetName,\n} from \"../Common/Naming\";\nimport { FirewallRuleResults } from \"./FirewallRules/types\";\n\nexport const appGatewaySubnetName = \"app-gateway\";\nexport const gatewaySubnetName = \"GatewaySubnet\";\nexport const azFirewallSubnet = \"AzureFirewallSubnet\";\nexport const azFirewallManagementSubnet = \"AzureFirewallManagementSubnet\";\nexport const azBastionSubnetName = \"AzureBastionSubnet\";\n\nexport const getIpsRange = (prefix: string) => {\n  const block = new netmask.Netmask(prefix);\n  //console.debug('getIpsRange', block);\n  return block;\n};\n\n/** Convert IP address and IP address group into range */\nexport const convertToIpRange = (\n  ipAddress: string[]\n): Array<{ start: string; end: string }> =>\n  ipAddress.map((ip) => {\n    if (ip.includes(\"/\")) {\n      const range = getIpsRange(ip);\n      return { start: range.base, end: range.broadcast };\n    }\n    return { start: ip, end: ip };\n  });\n\nexport const getVnetIdFromSubnetId = (subnetId: string) => {\n  //The sample SubnetId is /subscriptions/63a31b41-eb5d-4160-9fc9-d30fc00286c9/resourceGroups/sg-dev-aks-vnet/providers/Microsoft.Network/virtualNetworks/sg-vnet-trans/subnets/aks-main-nodes\n  const id = subnetId.split(\"/subnets\")[0];\n  //console.log(id);\n  return id;\n};\n\n/**Merge Firewall Rules Policies with starting priority*/\nexport const mergeFirewallRules = (\n  rules: Array<FirewallRuleResults>,\n  startPriority: number = 200\n): FirewallRuleResults => {\n  const applicationRuleCollections =\n    new Array<inputs.network.AzureFirewallApplicationRuleCollectionArgs>();\n  const natRuleCollections =\n    new Array<inputs.network.AzureFirewallNatRuleCollectionArgs>();\n  const networkRuleCollections =\n    new Array<inputs.network.AzureFirewallNetworkRuleCollectionArgs>();\n\n  //Combined Rules\n  rules.forEach((r) => {\n    if (r.applicationRuleCollections) {\n      applicationRuleCollections.push(...r.applicationRuleCollections);\n    }\n    if (r.natRuleCollections) {\n      natRuleCollections.push(...r.natRuleCollections);\n    }\n    if (r.networkRuleCollections) {\n      networkRuleCollections.push(...r.networkRuleCollections);\n    }\n  });\n\n  //Update Priority\n  applicationRuleCollections.forEach(\n    (a, i) => (a.priority = startPriority + i)\n  );\n  natRuleCollections.forEach((a, i) => (a.priority = startPriority + i));\n  networkRuleCollections.forEach((a, i) => (a.priority = startPriority + i));\n\n  return {\n    applicationRuleCollections,\n    natRuleCollections,\n    networkRuleCollections,\n  };\n};\n\ninterface SubnetProps {\n  subnetName: string;\n  //The Key name used to create resource group and Vnet\n  vnetKeyName: string;\n}\n\n/**Get Subnet Id from Naming rules*/\nexport const getSubnetIdByName = ({\n  subnetName,\n  vnetKeyName,\n}: SubnetProps): Output<string> => {\n  const vnetName = getVnetName(vnetKeyName);\n  const group = getResourceGroupName(vnetKeyName);\n  return interpolate`/subscriptions/${subscriptionId}/resourceGroups/${group}/providers/Microsoft.Network/virtualNetworks/${vnetName}/subnets/${subnetName}`;\n};\n\nexport const getIpAddressId = ({\n  name,\n  groupName,\n}: {\n  name: string;\n  groupName: string;\n}) => {\n  const n = getIpAddressName(name);\n  const group = getResourceGroupName(groupName);\n  return interpolate`/subscriptions/${subscriptionId}/resourceGroups/${group}/providers/Microsoft.Network/publicIPAddresses/${n}`;\n};\n\nexport const getIpAddressResource = ({\n  name,\n  groupName,\n}: {\n  name: string;\n  groupName: string;\n}) => {\n  const n = getIpAddressName(name);\n  const group = getResourceGroupName(groupName);\n\n  return network.getPublicIPAddress({\n    publicIpAddressName: n,\n    resourceGroupName: group,\n  });\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"246be453a918406f2ab49d2b5bb83faed2f72d79","contentHash":"ded8dfa6e12b67f0778ef7e7c47d342e485a3fcdb3885daffb3e4d41890dd747"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateDns.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateDns.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":84}},"26":{"start":{"line":27,"column":15},"end":{"line":27,"column":60}},"27":{"start":{"line":28,"column":17},"end":{"line":28,"column":42}},"28":{"start":{"line":29,"column":15},"end":{"line":29,"column":59}},"29":{"start":{"line":30,"column":22},"end":{"line":30,"column":54}},"30":{"start":{"line":31,"column":19},"end":{"line":48,"column":1}},"31":{"start":{"line":32,"column":4},"end":{"line":35,"column":37}},"32":{"start":{"line":36,"column":4},"end":{"line":47,"column":22}},"33":{"start":{"line":45,"column":67},"end":{"line":45,"column":103}},"34":{"start":{"line":45,"column":83},"end":{"line":45,"column":101}},"35":{"start":{"line":49,"column":0},"end":{"line":49,"column":32}},"36":{"start":{"line":50,"column":29},"end":{"line":59,"column":1}},"37":{"start":{"line":51,"column":21},"end":{"line":51,"column":69}},"38":{"start":{"line":52,"column":4},"end":{"line":58,"column":22}},"39":{"start":{"line":60,"column":0},"end":{"line":60,"column":52}},"40":{"start":{"line":62,"column":0},"end":{"line":83,"column":2}},"41":{"start":{"line":63,"column":17},"end":{"line":67,"column":21}},"42":{"start":{"line":68,"column":4},"end":{"line":76,"column":5}},"43":{"start":{"line":69,"column":8},"end":{"line":75,"column":13}},"44":{"start":{"line":69,"column":49},"end":{"line":75,"column":11}},"45":{"start":{"line":69,"column":64},"end":{"line":75,"column":10}},"46":{"start":{"line":77,"column":4},"end":{"line":81,"column":5}},"47":{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},"48":{"start":{"line":79,"column":12},"end":{"line":79,"column":120}},"49":{"start":{"line":79,"column":40},"end":{"line":79,"column":118}},"50":{"start":{"line":82,"column":4},"end":{"line":82,"column":16}},"51":{"start":{"line":84,"column":23},"end":{"line":87,"column":2}},"52":{"start":{"line":84,"column":64},"end":{"line":87,"column":2}},"53":{"start":{"line":88,"column":0},"end":{"line":88,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":19},"end":{"line":31,"column":20}},"loc":{"start":{"line":31,"column":100},"end":{"line":48,"column":1}},"line":31},"7":{"name":"(anonymous_7)","decl":{"start":{"line":45,"column":58},"end":{"line":45,"column":59}},"loc":{"start":{"line":45,"column":67},"end":{"line":45,"column":103}},"line":45},"8":{"name":"(anonymous_8)","decl":{"start":{"line":45,"column":75},"end":{"line":45,"column":76}},"loc":{"start":{"line":45,"column":83},"end":{"line":45,"column":101}},"line":45},"9":{"name":"(anonymous_9)","decl":{"start":{"line":50,"column":29},"end":{"line":50,"column":30}},"loc":{"start":{"line":50,"column":114},"end":{"line":59,"column":1}},"line":50},"10":{"name":"(anonymous_10)","decl":{"start":{"line":62,"column":18},"end":{"line":62,"column":19}},"loc":{"start":{"line":62,"column":88},"end":{"line":83,"column":1}},"line":62},"11":{"name":"(anonymous_11)","decl":{"start":{"line":69,"column":41},"end":{"line":69,"column":42}},"loc":{"start":{"line":69,"column":49},"end":{"line":75,"column":11}},"line":69},"12":{"name":"(anonymous_12)","decl":{"start":{"line":69,"column":56},"end":{"line":69,"column":57}},"loc":{"start":{"line":69,"column":64},"end":{"line":75,"column":10}},"line":69},"13":{"name":"(anonymous_13)","decl":{"start":{"line":79,"column":33},"end":{"line":79,"column":34}},"loc":{"start":{"line":79,"column":40},"end":{"line":79,"column":118}},"line":79},"14":{"name":"(anonymous_14)","decl":{"start":{"line":84,"column":23},"end":{"line":84,"column":24}},"loc":{"start":{"line":84,"column":64},"end":{"line":87,"column":2}},"line":84}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":31,"column":32},"end":{"line":31,"column":56}},"type":"default-arg","locations":[{"start":{"line":31,"column":40},"end":{"line":31,"column":56}}],"line":31},"17":{"loc":{"start":{"line":36,"column":47},"end":{"line":40,"column":37}},"type":"cond-expr","locations":[{"start":{"line":37,"column":10},"end":{"line":37,"column":23}},{"start":{"line":38,"column":10},"end":{"line":40,"column":37}}],"line":36},"18":{"loc":{"start":{"line":38,"column":10},"end":{"line":40,"column":37}},"type":"cond-expr","locations":[{"start":{"line":39,"column":14},"end":{"line":39,"column":28}},{"start":{"line":40,"column":14},"end":{"line":40,"column":37}}],"line":38},"19":{"loc":{"start":{"line":50,"column":42},"end":{"line":50,"column":66}},"type":"default-arg","locations":[{"start":{"line":50,"column":50},"end":{"line":50,"column":66}}],"line":50},"20":{"loc":{"start":{"line":56,"column":29},"end":{"line":56,"column":57}},"type":"binary-expr","locations":[{"start":{"line":56,"column":29},"end":{"line":56,"column":48}},{"start":{"line":56,"column":52},"end":{"line":56,"column":57}}],"line":56},"21":{"loc":{"start":{"line":62,"column":27},"end":{"line":62,"column":51}},"type":"default-arg","locations":[{"start":{"line":62,"column":35},"end":{"line":62,"column":51}}],"line":62},"22":{"loc":{"start":{"line":68,"column":4},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":76,"column":5}},{"start":{"line":68,"column":4},"end":{"line":76,"column":5}}],"line":68},"23":{"loc":{"start":{"line":77,"column":4},"end":{"line":81,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":81,"column":5}},{"start":{"line":77,"column":4},"end":{"line":81,"column":5}}],"line":77},"24":{"loc":{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},"type":"if","locations":[{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},{"start":{"line":78,"column":8},"end":{"line":80,"column":9}}],"line":78},"25":{"loc":{"start":{"line":84,"column":32},"end":{"line":84,"column":56}},"type":"default-arg","locations":[{"start":{"line":84,"column":40},"end":{"line":84,"column":56}}],"line":84}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":2,"16":2,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":1,"37":0,"38":0,"39":1,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[2,0],"12":[2,2],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0],"17":[0,0],"18":[0,0],"19":[0],"20":[0,0],"21":[0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateDns.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/VNet/PrivateDns.ts"],"names":[],"mappings":"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","sourcesContent":["import * as native from '@pulumi/azure-native';\nimport { Input, all, Resource, output } from '@pulumi/pulumi';\nimport * as global from '../Common/GlobalEnv';\nimport { getResourceInfoFromId } from '../Common/ResourceEnv';\nimport { ResourceGroupInfo } from '../types';\n\ninterface RecordProps {\n  zoneName: Input<string>;\n  /**Default is Global Resource Group*/\n  group?: ResourceGroupInfo;\n  recordName: string;\n  ipAddresses: Input<string[]>;\n  dependsOn?: Input<Input<Resource>[]> | Input<Resource>;\n}\nexport const addARecord = ({\n  zoneName,\n  group = global.groupInfo,\n  recordName,\n  ipAddresses,\n  dependsOn,\n}: RecordProps) => {\n  recordName = recordName\n    .replace(\"https://\",\"\")\n    .replace(\"http://\",\"\")\n    .replace(`.${zoneName}`,'');\n\n  return new native.network.PrivateRecordSet(\n    recordName === '*'\n      ? 'All-ARecord'\n      : recordName === '@'\n        ? 'Root-ARecord'\n        : `${recordName}-ARecord`,\n    {\n      privateZoneName: zoneName,\n      ...group,\n      relativeRecordSetName: recordName,\n      recordType: 'A',\n      aRecords: output(ipAddresses).apply((ips) =>\n        ips.map((i) => ({ ipv4Address: i }))\n      ),\n      ttl: 3600,\n    },\n    { dependsOn }\n  );\n}\n\ninterface VnetToPrivateDnsProps {\n  zoneName: string;\n  vnetId: string;\n  registrationEnabled?: boolean;\n  group?: ResourceGroupInfo;\n  dependsOn?: Input<Input<Resource>[]> | Input<Resource>;\n}\n\nexport const linkVnetToPrivateDns = ({\n  zoneName,\n  group = global.groupInfo,\n  vnetId,\n  registrationEnabled,\n  dependsOn,\n}: VnetToPrivateDnsProps) => {\n  const vnetInfo = getResourceInfoFromId(vnetId);\n\n  return new native.network.VirtualNetworkLink(\n    `${zoneName}-link-${vnetInfo!.name}`,\n    {\n      ...group,\n      location: global.globalKeyName,\n      privateZoneName: zoneName,\n      registrationEnabled: registrationEnabled || false,\n      virtualNetwork: { id: vnetId },\n    },\n    { dependsOn }\n  );\n};\n\ninterface Props {\n  name: string;\n  vnetIds?: Input<string>[];\n  group?: ResourceGroupInfo;\n  records?: {\n    aRecords: Array<Pick<RecordProps, 'recordName' | 'ipAddresses'>>;\n  };\n  dependsOn?: Input<Input<Resource>[]> | Input<Resource>;\n}\n\n/** Create Private DNS zone. This should be created in the Global resource group. */\nexport default ({\n  name,\n  group = global.groupInfo,\n  vnetIds,\n  records,\n  dependsOn,\n}: Props) => {\n  const zone = new native.network.PrivateZone(\n    name,\n    {\n      privateZoneName: name,\n      ...group,\n      location: 'global',\n    },\n    { dependsOn }\n  );\n\n  if (vnetIds) {\n    all(vnetIds).apply((vn) =>\n      vn.map((id) =>\n        linkVnetToPrivateDns({\n          vnetId: id,\n          zoneName: name,\n          group,\n          registrationEnabled: false,\n          dependsOn: zone,\n        })\n      )\n    );\n  }\n\n  if (records) {\n    if (records.aRecords) {\n      records.aRecords.map((a) =>\n        addARecord({ ...a, group, zoneName: zone.name, dependsOn: zone })\n      );\n    }\n  }\n\n  return zone;\n};\n\nexport const getPrivateZone = ({\n  name,\n  group = global.groupInfo,\n}: Omit<Props, 'vnetIds'>) =>\n  native.network.getPrivateZone({\n    privateZoneName: name,\n    resourceGroupName: group.resourceGroupName,\n  });\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c8b22e5bd1d9a1e137c7373ec0fee97d5a2c5a8e","contentHash":"8841029e0f26e9e7dde1645c72076ddf0f0f6a1aa5d80d6eaab92227bb4aed4a"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/CustomHelper.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/CustomHelper.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":62}},"2":{"start":{"line":4,"column":17},"end":{"line":4,"column":42}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":44}},"4":{"start":{"line":6,"column":22},"end":{"line":6,"column":63}},"5":{"start":{"line":8,"column":27},"end":{"line":19,"column":1}},"6":{"start":{"line":9,"column":4},"end":{"line":10,"column":39}},"7":{"start":{"line":10,"column":8},"end":{"line":10,"column":39}},"8":{"start":{"line":11,"column":4},"end":{"line":12,"column":66}},"9":{"start":{"line":12,"column":8},"end":{"line":12,"column":66}},"10":{"start":{"line":13,"column":4},"end":{"line":18,"column":7}},"11":{"start":{"line":20,"column":0},"end":{"line":20,"column":48}},"12":{"start":{"line":42,"column":24},"end":{"line":52,"column":1}},"13":{"start":{"line":43,"column":14},"end":{"line":43,"column":70}},"14":{"start":{"line":45,"column":4},"end":{"line":51,"column":22}},"15":{"start":{"line":47,"column":64},"end":{"line":47,"column":71}},"16":{"start":{"line":53,"column":0},"end":{"line":53,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":27},"end":{"line":8,"column":28}},"loc":{"start":{"line":8,"column":73},"end":{"line":19,"column":1}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":42,"column":24},"end":{"line":42,"column":25}},"loc":{"start":{"line":42,"column":108},"end":{"line":52,"column":1}},"line":42},"2":{"name":"(anonymous_2)","decl":{"start":{"line":47,"column":57},"end":{"line":47,"column":58}},"loc":{"start":{"line":47,"column":64},"end":{"line":47,"column":71}},"line":47}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":4},"end":{"line":10,"column":39}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":10,"column":39}},{"start":{"line":9,"column":4},"end":{"line":10,"column":39}}],"line":9},"1":{"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":24}},"type":"binary-expr","locations":[{"start":{"line":9,"column":8},"end":{"line":9,"column":14}},{"start":{"line":9,"column":18},"end":{"line":9,"column":24}}],"line":9},"2":{"loc":{"start":{"line":11,"column":4},"end":{"line":12,"column":66}},"type":"if","locations":[{"start":{"line":11,"column":4},"end":{"line":12,"column":66}},{"start":{"line":11,"column":4},"end":{"line":12,"column":66}}],"line":11},"3":{"loc":{"start":{"line":43,"column":14},"end":{"line":43,"column":70}},"type":"cond-expr","locations":[{"start":{"line":43,"column":30},"end":{"line":43,"column":34}},{"start":{"line":43,"column":37},"end":{"line":43,"column":70}}],"line":43},"4":{"loc":{"start":{"line":47,"column":15},"end":{"line":47,"column":77}},"type":"cond-expr","locations":[{"start":{"line":47,"column":23},"end":{"line":47,"column":72}},{"start":{"line":47,"column":75},"end":{"line":47,"column":77}}],"line":47},"5":{"loc":{"start":{"line":47,"column":64},"end":{"line":47,"column":71}},"type":"binary-expr","locations":[{"start":{"line":47,"column":64},"end":{"line":47,"column":65}},{"start":{"line":47,"column":69},"end":{"line":47,"column":71}}],"line":47},"6":{"loc":{"start":{"line":49,"column":21},"end":{"line":49,"column":40}},"type":"binary-expr","locations":[{"start":{"line":49,"column":21},"end":{"line":49,"column":32}},{"start":{"line":49,"column":36},"end":{"line":49,"column":40}}],"line":49}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":0,"15":0,"16":1},"f":{"0":0,"1":0,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/CustomHelper.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/KeyVault/CustomHelper.ts"],"names":[],"mappings":";;;AAAA,2CAAgE;AAChE,6CAAiD;AACjD,gEAAqE;AAUrE,4EAA4E;AACrE,MAAM,kBAAkB,GAAG,KAAK,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,SAAS,EAAS,EAAE,EAAE;IACpF,IAAI,MAAM,IAAI,CAAC,KAAK;QAAE,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IACrD,IAAI,CAAC,KAAK;QAAE,MAAM,IAAI,KAAK,CAAC,iBAAiB,IAAI,mBAAmB,CAAC,CAAC;IAEtE,MAAM,IAAA,uBAAe,EAAC;QACpB,IAAI;QACJ,KAAK;QACL,SAAS;QACT,WAAW,EAAE,kBAAkB;KAChC,CAAC,CAAC;AACL,CAAC,CAAC;AAVW,QAAA,kBAAkB,sBAU7B;AAeF,2BAA2B;AAC3B,UAAU;AACV,eAAe;AACf,UAAU;AACV,eAAe;AACf,sDAAsD;AACtD,mCAAmC;AACnC,mCAAmC;AACnC,YAAY;AACZ,QAAQ;AACR,iBAAiB;AACjB,wBAAwB;AACxB,uBAAuB;AACvB,kCAAkC;AAClC,mFAAmF;AACnF,cAAc;AACd,SAAS;AACT,oBAAoB;AACpB,OAAO;AACP,KAAK;AAEL,iHAAiH;AAC1G,MAAM,eAAe,GAAG,KAAK,EAAE,EACpC,IAAI,EACJ,aAAa,EACb,SAAS,EACT,KAAK,EACL,WAAW,EACX,IAAI,EACJ,SAAS,GACG,EAAE,EAAE;IAChB,MAAM,CAAC,GAAG,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAA,sBAAa,EAAC,IAAI,CAAC,CAAC;IACrD,4DAA4D;IAC5D,OAAO,IAAI,iCAAmB,CAC5B,IAAI,EACJ;QACE,IAAI,EAAE,CAAC;QACP,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,IAAA,eAAM,EAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;QACvD,SAAS;QACT,WAAW,EAAE,WAAW,IAAI,IAAI;QAChC,IAAI;KACL,EACD,EAAE,SAAS,EAAE,CACd,CAAC;AACJ,CAAC,CAAC;AAtBW,QAAA,eAAe,mBAsB1B","sourcesContent":["import { Input, output, Resource,Config } from \"@pulumi/pulumi\";\nimport { getSecretName } from \"../Common/Naming\";\nimport { VaultSecretResource } from \"../CustomProviders/VaultSecret\";\nimport { KeyVaultInfo } from \"../types\";\n\ninterface Props {\n  name: string;\n  value?: Input<string>;\n  config?: Config;\n  vaultInfo: KeyVaultInfo;\n}\n\n/**Add key vault secret from a value or from pulumi configuration secret. */\nexport const addVaultSecretFrom = async ({ name, value, config, vaultInfo }: Props) => {\n  if (config && !value) value = config.getSecret(name);\n  if (!value) throw new Error(`The value of \"${name}\" is not defined.`);\n\n  await addCustomSecret({\n    name,\n    value,\n    vaultInfo,\n    contentType: 'config variables',\n  });\n};\n\ntype SecretProps = {\n  name: string;\n  /**Use the name directly without applying naming format*/\n  formattedName?: boolean;\n  value: Input<string>;\n  vaultInfo: KeyVaultInfo;\n  contentType?: Input<string>;\n  tags?: Input<{\n    [key: string]: string;\n  }>;\n  dependsOn?: Input<Resource> | Input<Input<Resource>[]>;\n};\n\n// export const addKey = ({\n//   name,\n//   vaultInfo,\n//   tags,\n//   dependsOn,\n// }: Omit<SecretProps, 'value' | 'contentType'>) => {\n//   const n = getSecretName(name);\n//   return new azure.keyvault.Key(\n//     name,\n//     {\n//       name: n,\n//       keyType: 'RSA',\n//       keySize: 2048,\n//       keyVaultId: vaultInfo.id,\n//       keyOpts: ['decrypt', 'encrypt', 'sign', 'verify', 'wrapKey', 'unwrapKey'],\n//       tags,\n//     },\n//     { dependsOn }\n//   );\n// };\n\n/** Add variable to Key Vault. This will auto recover the deleted item and update with a new value if existed. */\nexport const addCustomSecret = async ({\n  name,\n  formattedName,\n  vaultInfo,\n  value,\n  contentType,\n  tags,\n  dependsOn,\n}: SecretProps) => {\n  const n = formattedName ? name : getSecretName(name);\n  //This KeyVault Secret is not auto recovery the deleted one.\n  return new VaultSecretResource(\n    name,\n    {\n      name: n,\n      value: value ? output(value).apply((v) => v || \"\") : \"\",\n      vaultInfo,\n      contentType: contentType || name,\n      tags,\n    },\n    { dependsOn }\n  );\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c7cfddc4d49ebfc3b0b1b0b66fd78781c2d5d266","contentHash":"8b4252032188573f2c48279e8a0fe59c1ba3fa36fd482d3f5096eb2178744d12"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/VaultSecret.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/VaultSecret.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":27},"end":{"line":4,"column":61}},"3":{"start":{"line":5,"column":15},"end":{"line":5,"column":32}},"4":{"start":{"line":9,"column":8},"end":{"line":9,"column":25}},"5":{"start":{"line":11,"column":14},"end":{"line":11,"column":23}},"6":{"start":{"line":13,"column":8},"end":{"line":14,"column":32}},"7":{"start":{"line":14,"column":12},"end":{"line":14,"column":32}},"8":{"start":{"line":15,"column":20},"end":{"line":15,"column":74}},"9":{"start":{"line":16,"column":8},"end":{"line":16,"column":95}},"10":{"start":{"line":17,"column":8},"end":{"line":17,"column":28}},"11":{"start":{"line":20,"column":23},"end":{"line":20,"column":59}},"12":{"start":{"line":21,"column":8},"end":{"line":21,"column":80}},"13":{"start":{"line":21,"column":69},"end":{"line":21,"column":78}},"14":{"start":{"line":24,"column":23},"end":{"line":24,"column":59}},"15":{"start":{"line":25,"column":24},"end":{"line":25,"column":61}},"16":{"start":{"line":27,"column":8},"end":{"line":28,"column":89}},"17":{"start":{"line":28,"column":12},"end":{"line":28,"column":89}},"18":{"start":{"line":31,"column":8},"end":{"line":31,"column":43}},"19":{"start":{"line":32,"column":23},"end":{"line":32,"column":59}},"20":{"start":{"line":33,"column":19},"end":{"line":37,"column":10}},"21":{"start":{"line":38,"column":8},"end":{"line":38,"column":66}},"22":{"start":{"line":41,"column":19},"end":{"line":41,"column":42}},"23":{"start":{"line":43,"column":8},"end":{"line":44,"column":115}},"24":{"start":{"line":44,"column":12},"end":{"line":44,"column":115}},"25":{"start":{"line":44,"column":53},"end":{"line":44,"column":113}},"26":{"start":{"line":45,"column":8},"end":{"line":45,"column":18}},"27":{"start":{"line":48,"column":8},"end":{"line":54,"column":9}},"28":{"start":{"line":49,"column":27},"end":{"line":49,"column":63}},"29":{"start":{"line":50,"column":12},"end":{"line":50,"column":55}},"30":{"start":{"line":58,"column":24},"end":{"line":58,"column":60}},"31":{"start":{"line":59,"column":8},"end":{"line":66,"column":10}},"32":{"start":{"line":72,"column":8},"end":{"line":72,"column":93}},"33":{"start":{"line":73,"column":8},"end":{"line":73,"column":25}},"34":{"start":{"line":76,"column":0},"end":{"line":76,"column":50}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":22},"end":{"line":10,"column":5}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":25},"end":{"line":18,"column":5}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":37},"end":{"line":22,"column":5}},"line":19},"3":{"name":"(anonymous_3)","decl":{"start":{"line":21,"column":63},"end":{"line":21,"column":64}},"loc":{"start":{"line":21,"column":69},"end":{"line":21,"column":78}},"line":21},"4":{"name":"(anonymous_4)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":34},"end":{"line":29,"column":5}},"line":23},"5":{"name":"(anonymous_5)","decl":{"start":{"line":30,"column":4},"end":{"line":30,"column":5}},"loc":{"start":{"line":30,"column":24},"end":{"line":39,"column":5}},"line":30},"6":{"name":"(anonymous_6)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":33},"end":{"line":46,"column":5}},"line":40},"7":{"name":"(anonymous_7)","decl":{"start":{"line":44,"column":46},"end":{"line":44,"column":47}},"loc":{"start":{"line":44,"column":53},"end":{"line":44,"column":113}},"line":44},"8":{"name":"(anonymous_8)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":28},"end":{"line":55,"column":5}},"line":47},"9":{"name":"(anonymous_9)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":41},"end":{"line":67,"column":5}},"line":56},"10":{"name":"(anonymous_10)","decl":{"start":{"line":71,"column":4},"end":{"line":71,"column":5}},"loc":{"start":{"line":71,"column":34},"end":{"line":74,"column":5}},"line":71}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":8},"end":{"line":14,"column":32}},"type":"if","locations":[{"start":{"line":13,"column":8},"end":{"line":14,"column":32}},{"start":{"line":13,"column":8},"end":{"line":14,"column":32}}],"line":13},"1":{"loc":{"start":{"line":27,"column":8},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":28,"column":89}},{"start":{"line":27,"column":8},"end":{"line":28,"column":89}}],"line":27},"2":{"loc":{"start":{"line":38,"column":21},"end":{"line":38,"column":50}},"type":"binary-expr","locations":[{"start":{"line":38,"column":21},"end":{"line":38,"column":37}},{"start":{"line":38,"column":41},"end":{"line":38,"column":50}}],"line":38},"3":{"loc":{"start":{"line":43,"column":8},"end":{"line":44,"column":115}},"type":"if","locations":[{"start":{"line":43,"column":8},"end":{"line":44,"column":115}},{"start":{"line":43,"column":8},"end":{"line":44,"column":115}}],"line":43},"4":{"loc":{"start":{"line":43,"column":12},"end":{"line":43,"column":82}},"type":"binary-expr","locations":[{"start":{"line":43,"column":12},"end":{"line":43,"column":35}},{"start":{"line":43,"column":39},"end":{"line":43,"column":82}}],"line":43},"5":{"loc":{"start":{"line":61,"column":21},"end":{"line":65,"column":63}},"type":"binary-expr","locations":[{"start":{"line":61,"column":21},"end":{"line":61,"column":41}},{"start":{"line":62,"column":16},"end":{"line":62,"column":49}},{"start":{"line":63,"column":16},"end":{"line":63,"column":69}},{"start":{"line":64,"column":16},"end":{"line":64,"column":51}},{"start":{"line":65,"column":16},"end":{"line":65,"column":63}}],"line":61}},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/VaultSecret.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/CustomProviders/VaultSecret.ts"],"names":[],"mappings":";;;AAAA,8DAAuD;AAIvD,iCAOgB;AAchB,MAAM,2BAA2B;IAGX;IAApB,YAAoB,IAAY;QAAZ,SAAI,GAAJ,IAAI,CAAQ;IAAG,CAAC;IAC5B,OAAO,GAA6B,SAAS,CAAC;IAEtD,SAAS,CAAC,SAAiB;QACzB,IAAI,IAAI,CAAC,OAAO;YAAE,OAAO,IAAI,CAAC,OAAO,CAAC;QAEtC,MAAM,GAAG,GAAG,WAAW,SAAS,kCAAkC,CAAC;QACnE,IAAI,CAAC,OAAO,GAAG,IAAI,+BAAY,CAAC,GAAG,EAAE,IAAI,uBAAgB,EAAE,CAAC,CAAC;QAC7D,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAED,KAAK,CAAC,mBAAmB,CAAC,KAAwB;QAChD,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACpD,OAAO,MAAM,MAAM,CAAC,gBAAgB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC,CAAC;IAC1E,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,KAAwB;QAC7C,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACpD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;QACtD,uBAAuB;QACvB,IAAI,OAAO;YACT,MAAM,CACJ,MAAM,MAAM,CAAC,yBAAyB,CAAC,OAAO,CAAC,IAAI,CAAC,CACrD,CAAC,aAAa,EAAE,CAAC;IACtB,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,KAAwB;QACnC,MAAM,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QAEnC,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACpD,MAAM,EAAE,GAAG,MAAM,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,EAAE;YACzD,OAAO,EAAE,IAAI;YACb,WAAW,EAAE,KAAK,CAAC,WAAW;YAC9B,IAAI,EAAE,KAAK,CAAC,IAAI;SACjB,CAAC,CAAC;QAEH,OAAO,EAAE,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,EAAE,IAAI,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;IAC5D,CAAC;IAED,KAAK,CAAC,MAAM,CACV,EAAU,EACV,IAAwB,EACxB,IAAuB;QAEvB,MAAM,EAAE,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAEnC,uBAAuB;QACvB,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC,SAAS,CAAC,IAAI;YACxE,MAAM,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CACtC,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAC7D,CAAC;QAEJ,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,KAAyB;QAChD,IAAI;YACF,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YACpD,MAAM,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAC5C;QAAC,MAAM;YACN,QAAQ;SACT;IACH,CAAC;IAED,KAAK,CAAC,IAAI,CACR,EAAU,EACV,cAAkC,EAClC,IAAuB;QAEvB,8DAA8D;QAC9D,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;QAErD,OAAO;YACL,mBAAmB,EAAE,KAAK;YAC1B,OAAO,EACL,OAAO,IAAI,SAAS;gBACpB,cAAc,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;gBACjC,cAAc,CAAC,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC,SAAS,CAAC,IAAI;gBACrD,cAAc,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK;gBACnC,cAAc,CAAC,WAAW,KAAK,IAAI,CAAC,WAAW;SAClD,CAAC;IACJ,CAAC;CACF;AAED,MAAa,mBAAoB,SAAQ,mBAGxC;IACiB,IAAI,CAAS;IAE7B,YACE,IAAY,EACZ,IAAoC,EACpC,IAAmC;QAEnC,KAAK,CACH,IAAI,2BAA2B,CAAC,IAAI,CAAC,EACrC,oBAAoB,IAAI,EAAE,EAC1B,IAAI,EACJ,IAAI,CACL,CAAC;QACF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACnB,CAAC;CACF;AAnBD,kDAmBC","sourcesContent":["import { SecretClient } from \"@azure/keyvault-secrets\";\nimport * as pulumi from \"@pulumi/pulumi\";\nimport { KeyVaultInfo } from \"../types\";\n\nimport {\n  BaseOptions,\n  BaseProvider,\n  BaseResource,\n  ClientCredential,\n  DefaultInputs,\n  DefaultOutputs,\n} from \"./Base\";\n\ninterface VaultSecretInputs extends DefaultInputs {\n  name: string;\n  value: string;\n  vaultInfo: KeyVaultInfo;\n  contentType?: string;\n  tags?: {\n    [key: string]: string;\n  };\n}\n\ninterface VaultSecretOutputs extends VaultSecretInputs, DefaultOutputs {}\n\nclass VaultSecretResourceProvider\n  implements BaseProvider<VaultSecretInputs, VaultSecretOutputs>\n{\n  constructor(private name: string) {}\n  private _client: SecretClient | undefined = undefined;\n\n  getClient(vaultName: string) {\n    if (this._client) return this._client;\n\n    const url = `https://${vaultName}.vault.azure.net?api-version=7.0`;\n    this._client = new SecretClient(url, new ClientCredential());\n    return this._client;\n  }\n\n  async tryGetDeletedSecret(props: VaultSecretInputs) {\n    const client = this.getClient(props.vaultInfo.name);\n    return await client.getDeletedSecret(props.name).catch(() => undefined);\n  }\n\n  async tryRecoverSecret(props: VaultSecretInputs): Promise<void> {\n    const client = this.getClient(props.vaultInfo.name);\n    const deleted = await this.tryGetDeletedSecret(props);\n    //Recover deleted items\n    if (deleted)\n      await (\n        await client.beginRecoverDeletedSecret(deleted.name)\n      ).pollUntilDone();\n  }\n\n  async create(props: VaultSecretInputs): Promise<pulumi.dynamic.CreateResult> {\n    await this.tryRecoverSecret(props);\n\n    const client = this.getClient(props.vaultInfo.name);\n    const ss = await client.setSecret(props.name, props.value, {\n      enabled: true,\n      contentType: props.contentType,\n      tags: props.tags,\n    });\n\n    return { id: ss.properties.id || this.name, outs: props };\n  }\n\n  async update(\n    id: string,\n    olds: VaultSecretOutputs,\n    news: VaultSecretInputs\n  ): Promise<pulumi.dynamic.UpdateResult> {\n    const rs = await this.create(news);\n\n    //Delete the old Secret\n    if (olds.name !== news.name || olds.vaultInfo.name !== news.vaultInfo.name)\n      await this.delete(id, olds).catch((e) =>\n        console.log(`Cannot delete ${this.name}`, e?.resource?.data)\n      );\n\n    return rs;\n  }\n\n  async delete(id: string, props: VaultSecretOutputs): Promise<void> {\n    try {\n      const client = this.getClient(props.vaultInfo.name);\n      await client.beginDeleteSecret(props.name);\n    } catch {\n      //Ignore\n    }\n  }\n\n  async diff(\n    id: string,\n    previousOutput: VaultSecretOutputs,\n    news: VaultSecretInputs\n  ): Promise<pulumi.dynamic.DiffResult> {\n    //check if secret is delete then commit changes to recover it.\n    const deleted = await this.tryGetDeletedSecret(news);\n\n    return {\n      deleteBeforeReplace: false,\n      changes:\n        deleted != undefined ||\n        previousOutput.name !== news.name ||\n        previousOutput.vaultInfo.name !== news.vaultInfo.name ||\n        previousOutput.value !== news.value ||\n        previousOutput.contentType !== news.contentType,\n    };\n  }\n}\n\nexport class VaultSecretResource extends BaseResource<\n  VaultSecretInputs,\n  VaultSecretOutputs\n> {\n  public readonly name: string;\n\n  constructor(\n    name: string,\n    args: BaseOptions<VaultSecretInputs>,\n    opts?: pulumi.CustomResourceOptions\n  ) {\n    super(\n      new VaultSecretResourceProvider(name),\n      `csp:VaultSecrets:${name}`,\n      args,\n      opts\n    );\n    this.name = name;\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ab532b5a61329b48b12c84fb91548826321879fa","contentHash":"4fcdaeeb59588cf755ebc8b0eb73b389303d3a8ff81fd2bd2cc2678aaa99e2dc"},"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Aks/index.ts":{"path":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Aks/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"25":{"start":{"line":26,"column":4},"end":{"line":26,"column":62}},"26":{"start":{"line":28,"column":0},"end":{"line":28,"column":62}},"27":{"start":{"line":29,"column":0},"end":{"line":29,"column":25}},"28":{"start":{"line":30,"column":15},"end":{"line":30,"column":60}},"29":{"start":{"line":31,"column":17},"end":{"line":31,"column":42}},"30":{"start":{"line":32,"column":23},"end":{"line":32,"column":65}},"31":{"start":{"line":33,"column":19},"end":{"line":33,"column":48}},"32":{"start":{"line":34,"column":17},"end":{"line":34,"column":59}},"33":{"start":{"line":35,"column":19},"end":{"line":35,"column":57}},"34":{"start":{"line":36,"column":15},"end":{"line":36,"column":55}},"35":{"start":{"line":37,"column":19},"end":{"line":37,"column":48}},"36":{"start":{"line":38,"column":18},"end":{"line":38,"column":44}},"37":{"start":{"line":39,"column":17},"end":{"line":39,"column":44}},"38":{"start":{"line":40,"column":21},"end":{"line":40,"column":67}},"39":{"start":{"line":41,"column":17},"end":{"line":41,"column":42}},"40":{"start":{"line":42,"column":21},"end":{"line":65,"column":1}},"41":{"start":{"line":43,"column":30},"end":{"line":43,"column":34}},"42":{"start":{"line":44,"column":20},"end":{"line":44,"column":21}},"43":{"start":{"line":45,"column":19},"end":{"line":45,"column":20}},"44":{"start":{"line":46,"column":19},"end":{"line":46,"column":20}},"45":{"start":{"line":47,"column":4},"end":{"line":58,"column":5}},"46":{"start":{"line":48,"column":8},"end":{"line":57,"column":9}},"47":{"start":{"line":50,"column":16},"end":{"line":50,"column":29}},"48":{"start":{"line":51,"column":16},"end":{"line":51,"column":22}},"49":{"start":{"line":55,"column":16},"end":{"line":55,"column":29}},"50":{"start":{"line":56,"column":16},"end":{"line":56,"column":22}},"51":{"start":{"line":59,"column":4},"end":{"line":64,"column":6}},"52":{"start":{"line":66,"column":24},"end":{"line":83,"column":1}},"53":{"start":{"line":85,"column":0},"end":{"line":106,"column":56}},"54":{"start":{"line":87,"column":4},"end":{"line":87,"column":57}},"55":{"start":{"line":89,"column":4},"end":{"line":89,"column":48}},"56":{"start":{"line":91,"column":4},"end":{"line":91,"column":50}},"57":{"start":{"line":93,"column":4},"end":{"line":93,"column":51}},"58":{"start":{"line":95,"column":4},"end":{"line":95,"column":56}},"59":{"start":{"line":97,"column":4},"end":{"line":97,"column":54}},"60":{"start":{"line":99,"column":4},"end":{"line":99,"column":57}},"61":{"start":{"line":101,"column":4},"end":{"line":101,"column":52}},"62":{"start":{"line":103,"column":4},"end":{"line":103,"column":53}},"63":{"start":{"line":105,"column":4},"end":{"line":105,"column":55}},"64":{"start":{"line":108,"column":0},"end":{"line":375,"column":2}},"65":{"start":{"line":115,"column":20},"end":{"line":115,"column":50}},"66":{"start":{"line":116,"column":4},"end":{"line":116,"column":64}},"67":{"start":{"line":126,"column":28},"end":{"line":133,"column":19}},"68":{"start":{"line":134,"column":23},"end":{"line":141,"column":19}},"69":{"start":{"line":139,"column":71},"end":{"line":139,"column":81}},"70":{"start":{"line":143,"column":4},"end":{"line":146,"column":5}},"71":{"start":{"line":144,"column":8},"end":{"line":144,"column":57}},"72":{"start":{"line":145,"column":8},"end":{"line":145,"column":25}},"73":{"start":{"line":147,"column":4},"end":{"line":150,"column":5}},"74":{"start":{"line":148,"column":8},"end":{"line":148,"column":56}},"75":{"start":{"line":149,"column":8},"end":{"line":149,"column":25}},"76":{"start":{"line":152,"column":24},"end":{"line":158,"column":19}},"77":{"start":{"line":160,"column":16},"end":{"line":336,"column":6}},"78":{"start":{"line":224,"column":49},"end":{"line":238,"column":9}},"79":{"start":{"line":242,"column":61},"end":{"line":242,"column":75}},"80":{"start":{"line":337,"column":4},"end":{"line":339,"column":5}},"81":{"start":{"line":338,"column":8},"end":{"line":338,"column":76}},"82":{"start":{"line":340,"column":4},"end":{"line":359,"column":5}},"83":{"start":{"line":341,"column":8},"end":{"line":358,"column":11}},"84":{"start":{"line":342,"column":12},"end":{"line":343,"column":23}},"85":{"start":{"line":343,"column":16},"end":{"line":343,"column":23}},"86":{"start":{"line":345,"column":12},"end":{"line":357,"column":15}},"87":{"start":{"line":368,"column":4},"end":{"line":373,"column":7}},"88":{"start":{"line":374,"column":4},"end":{"line":374,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":56},"end":{"line":25,"column":57}},"loc":{"start":{"line":25,"column":71},"end":{"line":27,"column":1}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":42,"column":21},"end":{"line":42,"column":22}},"loc":{"start":{"line":42,"column":40},"end":{"line":65,"column":1}},"line":42},"8":{"name":"(anonymous_8)","decl":{"start":{"line":85,"column":1},"end":{"line":85,"column":2}},"loc":{"start":{"line":85,"column":20},"end":{"line":106,"column":1}},"line":85},"9":{"name":"(anonymous_9)","decl":{"start":{"line":108,"column":18},"end":{"line":108,"column":19}},"loc":{"start":{"line":114,"column":50},"end":{"line":375,"column":1}},"line":114},"10":{"name":"(anonymous_10)","decl":{"start":{"line":139,"column":64},"end":{"line":139,"column":65}},"loc":{"start":{"line":139,"column":71},"end":{"line":139,"column":81}},"line":139},"11":{"name":"(anonymous_11)","decl":{"start":{"line":224,"column":41},"end":{"line":224,"column":42}},"loc":{"start":{"line":224,"column":49},"end":{"line":238,"column":9}},"line":224},"12":{"name":"(anonymous_12)","decl":{"start":{"line":242,"column":53},"end":{"line":242,"column":54}},"loc":{"start":{"line":242,"column":61},"end":{"line":242,"column":75}},"line":242},"13":{"name":"(anonymous_13)","decl":{"start":{"line":341,"column":21},"end":{"line":341,"column":22}},"loc":{"start":{"line":341,"column":35},"end":{"line":358,"column":9}},"line":341}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":51}},{"start":{"line":25,"column":56},"end":{"line":27,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":61}},"type":"cond-expr","locations":[{"start":{"line":26,"column":37},"end":{"line":26,"column":40}},{"start":{"line":26,"column":43},"end":{"line":26,"column":61}}],"line":26},"18":{"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":33}},"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":33}}],"line":26},"19":{"loc":{"start":{"line":47,"column":4},"end":{"line":58,"column":5}},"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":58,"column":5}},{"start":{"line":47,"column":4},"end":{"line":58,"column":5}}],"line":47},"20":{"loc":{"start":{"line":48,"column":8},"end":{"line":57,"column":9}},"type":"switch","locations":[{"start":{"line":49,"column":12},"end":{"line":51,"column":22}},{"start":{"line":52,"column":12},"end":{"line":52,"column":27}},{"start":{"line":53,"column":12},"end":{"line":53,"column":26}},{"start":{"line":54,"column":12},"end":{"line":56,"column":22}}],"line":48},"21":{"loc":{"start":{"line":61,"column":19},"end":{"line":61,"column":60}},"type":"cond-expr","locations":[{"start":{"line":61,"column":39},"end":{"line":61,"column":48}},{"start":{"line":61,"column":51},"end":{"line":61,"column":60}}],"line":61},"22":{"loc":{"start":{"line":62,"column":18},"end":{"line":62,"column":58}},"type":"cond-expr","locations":[{"start":{"line":62,"column":38},"end":{"line":62,"column":46}},{"start":{"line":62,"column":49},"end":{"line":62,"column":58}}],"line":62},"23":{"loc":{"start":{"line":63,"column":18},"end":{"line":63,"column":58}},"type":"cond-expr","locations":[{"start":{"line":63,"column":38},"end":{"line":63,"column":46}},{"start":{"line":63,"column":49},"end":{"line":63,"column":58}}],"line":63},"24":{"loc":{"start":{"line":67,"column":23},"end":{"line":67,"column":69}},"type":"cond-expr","locations":[{"start":{"line":67,"column":42},"end":{"line":67,"column":57}},{"start":{"line":67,"column":60},"end":{"line":67,"column":69}}],"line":67},"25":{"loc":{"start":{"line":106,"column":13},"end":{"line":106,"column":54}},"type":"binary-expr","locations":[{"start":{"line":106,"column":13},"end":{"line":106,"column":28}},{"start":{"line":106,"column":33},"end":{"line":106,"column":53}}],"line":106},"26":{"loc":{"start":{"line":108,"column":66},"end":{"line":108,"column":94}},"type":"default-arg","locations":[{"start":{"line":108,"column":86},"end":{"line":108,"column":94}}],"line":108},"27":{"loc":{"start":{"line":110,"column":14},"end":{"line":110,"column":28}},"type":"default-arg","locations":[{"start":{"line":110,"column":26},"end":{"line":110,"column":28}}],"line":110},"28":{"loc":{"start":{"line":110,"column":41},"end":{"line":110,"column":89}},"type":"default-arg","locations":[{"start":{"line":110,"column":56},"end":{"line":110,"column":89}}],"line":110},"29":{"loc":{"start":{"line":110,"column":91},"end":{"line":114,"column":1}},"type":"default-arg","locations":[{"start":{"line":110,"column":99},"end":{"line":114,"column":1}}],"line":110},"30":{"loc":{"start":{"line":114,"column":3},"end":{"line":114,"column":14}},"type":"default-arg","locations":[{"start":{"line":114,"column":10},"end":{"line":114,"column":14}}],"line":114},"31":{"loc":{"start":{"line":114,"column":16},"end":{"line":114,"column":30}},"type":"default-arg","locations":[{"start":{"line":114,"column":28},"end":{"line":114,"column":30}}],"line":114},"32":{"loc":{"start":{"line":116,"column":24},"end":{"line":116,"column":63}},"type":"binary-expr","locations":[{"start":{"line":116,"column":24},"end":{"line":116,"column":41}},{"start":{"line":116,"column":45},"end":{"line":116,"column":63}}],"line":116},"33":{"loc":{"start":{"line":126,"column":28},"end":{"line":133,"column":19}},"type":"cond-expr","locations":[{"start":{"line":127,"column":10},"end":{"line":132,"column":10}},{"start":{"line":133,"column":10},"end":{"line":133,"column":19}}],"line":126},"34":{"loc":{"start":{"line":134,"column":23},"end":{"line":141,"column":19}},"type":"cond-expr","locations":[{"start":{"line":135,"column":10},"end":{"line":140,"column":10}},{"start":{"line":141,"column":10},"end":{"line":141,"column":19}}],"line":134},"35":{"loc":{"start":{"line":143,"column":4},"end":{"line":146,"column":5}},"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":146,"column":5}},{"start":{"line":143,"column":4},"end":{"line":146,"column":5}}],"line":143},"36":{"loc":{"start":{"line":147,"column":4},"end":{"line":150,"column":5}},"type":"if","locations":[{"start":{"line":147,"column":4},"end":{"line":150,"column":5}},{"start":{"line":147,"column":4},"end":{"line":150,"column":5}}],"line":147},"37":{"loc":{"start":{"line":147,"column":8},"end":{"line":147,"column":44}},"type":"binary-expr","locations":[{"start":{"line":147,"column":8},"end":{"line":147,"column":23}},{"start":{"line":147,"column":27},"end":{"line":147,"column":44}}],"line":147},"38":{"loc":{"start":{"line":152,"column":24},"end":{"line":158,"column":19}},"type":"cond-expr","locations":[{"start":{"line":153,"column":10},"end":{"line":157,"column":10}},{"start":{"line":158,"column":10},"end":{"line":158,"column":19}}],"line":152},"39":{"loc":{"start":{"line":168,"column":32},"end":{"line":170,"column":20}},"type":"cond-expr","locations":[{"start":{"line":169,"column":18},"end":{"line":169,"column":52}},{"start":{"line":170,"column":18},"end":{"line":170,"column":20}}],"line":168},"40":{"loc":{"start":{"line":169,"column":18},"end":{"line":169,"column":52}},"type":"binary-expr","locations":[{"start":{"line":169,"column":18},"end":{"line":169,"column":46}},{"start":{"line":169,"column":50},"end":{"line":169,"column":52}}],"line":169},"41":{"loc":{"start":{"line":177,"column":24},"end":{"line":181,"column":31}},"type":"cond-expr","locations":[{"start":{"line":178,"column":22},"end":{"line":180,"column":21}},{"start":{"line":181,"column":22},"end":{"line":181,"column":31}}],"line":177},"42":{"loc":{"start":{"line":189,"column":25},"end":{"line":191,"column":51}},"type":"binary-expr","locations":[{"start":{"line":189,"column":25},"end":{"line":189,"column":64}},{"start":{"line":190,"column":20},"end":{"line":190,"column":43}},{"start":{"line":191,"column":20},"end":{"line":191,"column":51}}],"line":189},"43":{"loc":{"start":{"line":195,"column":24},"end":{"line":197,"column":31}},"type":"cond-expr","locations":[{"start":{"line":196,"column":22},"end":{"line":196,"column":67}},{"start":{"line":197,"column":22},"end":{"line":197,"column":31}}],"line":195},"44":{"loc":{"start":{"line":201,"column":24},"end":{"line":206,"column":31}},"type":"cond-expr","locations":[{"start":{"line":202,"column":22},"end":{"line":205,"column":21}},{"start":{"line":206,"column":22},"end":{"line":206,"column":31}}],"line":201},"45":{"loc":{"start":{"line":210,"column":24},"end":{"line":214,"column":31}},"type":"cond-expr","locations":[{"start":{"line":211,"column":22},"end":{"line":213,"column":21}},{"start":{"line":214,"column":22},"end":{"line":214,"column":31}}],"line":210},"46":{"loc":{"start":{"line":228,"column":19},"end":{"line":228,"column":46}},"type":"cond-expr","locations":[{"start":{"line":228,"column":41},"end":{"line":228,"column":42}},{"start":{"line":228,"column":45},"end":{"line":228,"column":46}}],"line":228},"47":{"loc":{"start":{"line":239,"column":22},"end":{"line":244,"column":23}},"type":"cond-expr","locations":[{"start":{"line":240,"column":14},"end":{"line":243,"column":13}},{"start":{"line":244,"column":14},"end":{"line":244,"column":23}}],"line":239},"48":{"loc":{"start":{"line":268,"column":33},"end":{"line":273,"column":23}},"type":"cond-expr","locations":[{"start":{"line":269,"column":14},"end":{"line":272,"column":13}},{"start":{"line":273,"column":14},"end":{"line":273,"column":23}}],"line":268},"49":{"loc":{"start":{"line":274,"column":28},"end":{"line":280,"column":23}},"type":"cond-expr","locations":[{"start":{"line":275,"column":14},"end":{"line":279,"column":13}},{"start":{"line":280,"column":14},"end":{"line":280,"column":23}}],"line":274},"50":{"loc":{"start":{"line":287,"column":33},"end":{"line":287,"column":79}},"type":"cond-expr","locations":[{"start":{"line":287,"column":46},"end":{"line":287,"column":67}},{"start":{"line":287,"column":70},"end":{"line":287,"column":79}}],"line":287},"51":{"loc":{"start":{"line":297,"column":26},"end":{"line":299,"column":67}},"type":"cond-expr","locations":[{"start":{"line":298,"column":18},"end":{"line":298,"column":73}},{"start":{"line":299,"column":18},"end":{"line":299,"column":67}}],"line":297},"52":{"loc":{"start":{"line":297,"column":26},"end":{"line":297,"column":82}},"type":"binary-expr","locations":[{"start":{"line":297,"column":26},"end":{"line":297,"column":48}},{"start":{"line":297,"column":52},"end":{"line":297,"column":82}}],"line":297},"53":{"loc":{"start":{"line":300,"column":29},"end":{"line":304,"column":25}},"type":"cond-expr","locations":[{"start":{"line":303,"column":18},"end":{"line":303,"column":28}},{"start":{"line":304,"column":18},"end":{"line":304,"column":25}}],"line":300},"54":{"loc":{"start":{"line":300,"column":29},"end":{"line":302,"column":46}},"type":"binary-expr","locations":[{"start":{"line":300,"column":29},"end":{"line":300,"column":67}},{"start":{"line":301,"column":16},"end":{"line":301,"column":38}},{"start":{"line":302,"column":16},"end":{"line":302,"column":46}}],"line":300},"55":{"loc":{"start":{"line":305,"column":33},"end":{"line":319,"column":27}},"type":"cond-expr","locations":[{"start":{"line":307,"column":18},"end":{"line":318,"column":17}},{"start":{"line":319,"column":18},"end":{"line":319,"column":27}}],"line":305},"56":{"loc":{"start":{"line":305,"column":33},"end":{"line":306,"column":75}},"type":"binary-expr","locations":[{"start":{"line":305,"column":33},"end":{"line":305,"column":58}},{"start":{"line":306,"column":16},"end":{"line":306,"column":75}}],"line":305},"57":{"loc":{"start":{"line":306,"column":18},"end":{"line":306,"column":74}},"type":"binary-expr","locations":[{"start":{"line":306,"column":18},"end":{"line":306,"column":40}},{"start":{"line":306,"column":44},"end":{"line":306,"column":74}}],"line":306},"58":{"loc":{"start":{"line":311,"column":40},"end":{"line":317,"column":35}},"type":"cond-expr","locations":[{"start":{"line":312,"column":26},"end":{"line":316,"column":25}},{"start":{"line":317,"column":26},"end":{"line":317,"column":35}}],"line":311},"59":{"loc":{"start":{"line":323,"column":19},"end":{"line":325,"column":23}},"type":"cond-expr","locations":[{"start":{"line":324,"column":14},"end":{"line":324,"column":54}},{"start":{"line":325,"column":14},"end":{"line":325,"column":23}}],"line":323},"60":{"loc":{"start":{"line":337,"column":4},"end":{"line":339,"column":5}},"type":"if","locations":[{"start":{"line":337,"column":4},"end":{"line":339,"column":5}},{"start":{"line":337,"column":4},"end":{"line":339,"column":5}}],"line":337},"61":{"loc":{"start":{"line":340,"column":4},"end":{"line":359,"column":5}},"type":"if","locations":[{"start":{"line":340,"column":4},"end":{"line":359,"column":5}},{"start":{"line":340,"column":4},"end":{"line":359,"column":5}}],"line":340},"62":{"loc":{"start":{"line":342,"column":12},"end":{"line":343,"column":23}},"type":"if","locations":[{"start":{"line":342,"column":12},"end":{"line":343,"column":23}},{"start":{"line":342,"column":12},"end":{"line":343,"column":23}}],"line":342}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":1,"27":1,"28":1,"29":1,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[1,0],"12":[1,1],"13":[0,0],"14":[0,0],"15":[0,0],"16":[1,1,1],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0,0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0],"27":[0],"28":[0],"29":[0],"30":[0],"31":[0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Aks/index.ts","sources":["/Volumes/VMs_2T/_STADIOS/Pulse.Infra/_Shared/Aks/index.ts"],"names":[],"mappings":"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","sourcesContent":["import * as native from \"@pulumi/azure-native\";\nimport * as pulumi from \"@pulumi/pulumi\";\nimport { Input, output } from \"@pulumi/pulumi\";\nimport vmsDiagnostic from \"./VmSetMonitor\";\nimport vmsAutoScale from \"./VmSetAutoScale\";\nimport { BasicMonitorArgs, BasicResourceArgs, KeyVaultInfo } from \"../types\";\nimport { currentEnv, Environments, isPrd, tenantId } from \"../Common/AzureEnv\";\nimport Locker from \"../Core/Locker\";\nimport aksIdentityCreator from \"./Identity\";\nimport roleCreator from \"../AzAd/Role\";\nimport { stack } from \"../Common/StackEnv\";\nimport { createDiagnostic } from \"../Logs/Helpers\";\nimport { getAksName } from \"../Common/Naming\";\nimport PrivateDns from \"../VNet/PrivateDns\";\nimport { getVnetIdFromSubnetId } from \"../VNet/Helper\";\n\nconst autoScaleFor = (\n  env: Environments,\n  nodeType: \"Default\" | \"System\" | \"User\"\n) => {\n  const enableAutoScaling = true;\n  let nodeCount = 1;\n  let minCount = 1;\n  let maxCount = 3;\n\n  if (env === Environments.Prd) {\n    switch (nodeType) {\n      case \"User\":\n        maxCount = 5;\n        break;\n\n      case \"Default\":\n      case \"System\":\n      default:\n        maxCount = 3;\n        break;\n    }\n  }\n\n  return {\n    enableAutoScaling,\n    nodeCount: enableAutoScaling ? undefined : nodeCount,\n    minCount: enableAutoScaling ? minCount : undefined,\n    maxCount: enableAutoScaling ? maxCount : undefined,\n  };\n};\n\nconst defaultNodePool = {\n  availabilityZones: isPrd ? [\"1\", \"2\", \"3\"] : undefined,\n  type: native.containerservice.AgentPoolType.VirtualMachineScaleSets,\n  vmSize: \"Standard_B2s\",\n  ...autoScaleFor(currentEnv, \"Default\"),\n  maxPods: 50,\n  enableFIPS: false,\n  enableNodePublicIP: false,\n\n  osDiskSizeGB: 128,\n  osDiskType: native.containerservice.OSDiskType.Managed,\n\n  nodeLabels: {\n    environment: currentEnv,\n    stack,\n  },\n\n  tags: {\n    environment: currentEnv,\n  },\n};\n\nexport enum VmSizes {\n  /** 32G RAM - 4CPU - $221.92 */\n  Standard_E4as_v4_221 = \"Standard_E4as_v4\",\n  /** 4G RAM - 2CPU - $38.54 */\n  Standard_B2s_38 = \"Standard_B2s\",\n  /** 8G RAM - 2CPU - $77.38 */\n  Standard_B2ms_77 = \"Standard_B2ms\",\n  /** 16G RAM - 4CPU - $154.03 */\n  Standard_B4ms_154 = \"Standard_B4ms\",\n  /** 8G RAM - 2CPU - 87.60 */\n  Standard_D2as_v4_87 = \"Standard_D2as_v4\",\n  /** 8G RAM - 2CPU - 87.60 */\n  Standard_D2s_v3_87 = \"Standard_D2s_v3\",\n  /** 16G RAM - 4CPU - $175.20 */\n  Standard_D4as_v4_175 = \"Standard_D4as_v4\",\n  /** 4G RAM - 2CPU - $69.35 */\n  Standard_A2_v2_69 = \"Standard_A2_v2\",\n  /** 8G RAM - 4CPU - $144.54 */\n  Standard_A4_v2_144 = \"Standard_A4_v2\",\n  /** 32G RAM - 4CPU - $205.13 */\n  Standard_A4m_v2_205 = \"Standard_A4m_v2\",\n}\n\ninterface NodePoolProps {\n  name: string;\n  mode: native.containerservice.AgentPoolMode;\n  vmSize?: VmSizes;\n  maxPods?: number;\n  osDiskSizeGB?: number;\n  osDiskType?: native.containerservice.OSDiskType;\n  /**Not all machine is support this feature*/\n  enableEncryptionAtHost?: boolean;\n}\n\ninterface Props extends BasicResourceArgs {\n  nodeResourceGroup?: string;\n\n  addon?: {\n    enableAzureKeyVault?: boolean;\n    enableAzurePolicy?: boolean;\n    enableKubeDashboard?: boolean;\n    enableVirtualHost?: boolean;\n    applicationGateway?: { gatewaySubnetId: pulumi.Input<string> };\n  };\n\n  linux?: {\n    adminUsername: Input<string>;\n    sshKeys: Array<pulumi.Input<string>>;\n  };\n\n  kubernetesVersion?: \"1.22.6\";\n  nodePools: Array<Omit<NodePoolProps, \"subnetId\" | \"aksId\">>;\n  //enableVMAutoScale?: boolean;\n\n  featureFlags?: {\n    createServicePrincipal?: boolean;\n    enablePodIdentity?: boolean;\n    enableDiagnosticSetting?: boolean;\n  };\n\n  aksAccess?: {\n    enableAzureRBAC?:\n      | boolean\n      | { adminMembers: Array<{ objectId: Input<string> }> };\n    enablePrivateCluster?: boolean;\n    authorizedIPRanges?: Input<string>[];\n    //privateDNSName?: string;\n  };\n\n  network: {\n    subnetId?: pulumi.Input<string>;\n    virtualHostSubnetName?: pulumi.Input<string>;\n\n    enableFirewall?: boolean;\n\n    outboundIpAddress?: {\n      ipAddressId: pulumi.Input<string>;\n      ipAddressPrefixId?: pulumi.Input<string>;\n    };\n  };\n\n  vaultInfo: KeyVaultInfo;\n  log?: BasicMonitorArgs;\n  /**Lock resource from delete*/\n  lock?: boolean;\n  dependsOn?: pulumi.Input<pulumi.Resource>[];\n  importFrom?: string;\n}\n\n//Using this to enable the preview feature https://azurecloudai.blog/2019/10/16/aks-enabling-and-using-preview-features-such-as-nodepools-using-cli/\nexport default async ({\n  group,\n  nodeResourceGroup,\n  name,\n  linux,\n  kubernetesVersion = \"1.22.6\",\n  nodePools,\n  //enableVMAutoScale,\n  network,\n  log,\n  aksAccess = {},\n  vaultInfo,\n  featureFlags = { enableDiagnosticSetting: true },\n  addon = {\n    enableAzurePolicy: true,\n    enableAzureKeyVault: true,\n    enableKubeDashboard: false,\n  },\n  lock = true,\n  dependsOn = [],\n  importFrom,\n}: Props) => {\n  const aksName = getAksName(name);\n  nodeResourceGroup = nodeResourceGroup || `${aksName}-nodes`;\n\n  // const appGateway =\n  //   addon.applicationGateway && network.outboundIpAddress\n  //     ? await AppGateway({\n  //         name,\n  //         group,\n  //         publicIpAddressId: network.outboundIpAddress.ipAddressId,\n  //         subnetId: addon.applicationGateway.gatewaySubnetId,\n  //       })\n  //     : undefined;\n\n  const serviceIdentity = featureFlags.createServicePrincipal\n    ? await aksIdentityCreator({\n        name: aksName,\n        group,\n        privateCluster: aksAccess.enablePrivateCluster,\n        vaultInfo,\n      })\n    : undefined;\n\n  const adminGroup =\n    typeof aksAccess.enableAzureRBAC === \"object\"\n      ? roleCreator({\n          env: currentEnv,\n          appName: name,\n          roleName: \"Aks-Admin\",\n          members: aksAccess.enableAzureRBAC.adminMembers.map(\n            (m) => m.objectId\n          ),\n        })\n      : undefined;\n\n  //=================Validate ===================================/\n  if (!network?.subnetId) {\n    console.error(\"Aks subnetId is required:\", name);\n    return undefined;\n  }\n  if (!linux?.sshKeys || !linux.sshKeys[0]) {\n    console.error(\"Aks sshKeys is required:\", name);\n    return undefined;\n  }\n\n  //Private DNS Zone for Private CLuster\n  const privateZone = aksAccess.enablePrivateCluster\n    ? PrivateDns({\n        name: \"privatelink.southeastasia.azmk8s.io\",\n        group,\n        vnetIds: [output(network.subnetId).apply(getVnetIdFromSubnetId)],\n      })\n    : undefined;\n\n  //Create AKS Cluster\n  const aks = new native.containerservice.ManagedCluster(\n    aksName,\n    {\n      resourceName: aksName,\n      ...group,\n      nodeResourceGroup,\n      dnsPrefix: aksName,\n      kubernetesVersion,\n\n      enableRBAC: Boolean(aksAccess.enableAzureRBAC),\n      apiServerAccessProfile: {\n        authorizedIPRanges: !aksAccess.enablePrivateCluster\n          ? aksAccess.authorizedIPRanges || []\n          : [],\n\n        enablePrivateCluster: aksAccess.enablePrivateCluster,\n        privateDNSZone: privateZone?.id,\n      },\n      //fqdnSubdomain: '',\n\n      addonProfiles: {\n        azureKeyvaultSecretsProvider: {\n          config: addon.enableAzureKeyVault\n            ? {\n                enableSecretRotation: \"true\",\n              }\n            : undefined,\n          enabled: Boolean(addon.enableAzureKeyVault),\n        },\n\n        azurePolicy: { enabled: Boolean(addon.enableAzurePolicy) },\n        kubeDashboard: { enabled: Boolean(addon.enableKubeDashboard) },\n        //If there is no public P address provided the public app can access via HTTP app routing only and feature only support HTTP.\n        //TO enable HTTPS support need to create cluster with an public IP address.\n        httpApplicationRouting: {\n          enabled:\n            !network.outboundIpAddress?.ipAddressId &&\n            !network.enableFirewall &&\n            !aksAccess.enablePrivateCluster,\n        },\n\n        aciConnectorLinux: {\n          enabled: Boolean(network.virtualHostSubnetName),\n          config: network.virtualHostSubnetName\n            ? { SubnetName: network.virtualHostSubnetName }\n            : undefined,\n        },\n\n        ingressApplicationGateway: {\n          enabled: Boolean(addon.applicationGateway),\n          config: addon.applicationGateway\n            ? {\n                gatewayName: `${name}-gateway`,\n                subnetId: addon.applicationGateway.gatewaySubnetId,\n              }\n            : undefined,\n        },\n\n        omsAgent: {\n          enabled: Boolean(log?.logWpId),\n          config: log\n            ? {\n                logAnalyticsWorkspaceResourceID: log.logWpId!,\n              }\n            : undefined,\n        },\n      },\n\n      sku: {\n        name: native.containerservice.ManagedClusterSKUName.Basic,\n        tier: native.containerservice.ManagedClusterSKUTier.Free,\n        // tier: isPrd\n        //   ? native.containerservice.ManagedClusterSKUTier.Paid\n        //   : native.containerservice.ManagedClusterSKUTier.Free,\n      },\n\n      agentPoolProfiles: nodePools.map((p) => ({\n        ...defaultNodePool,\n        ...p,\n\n        //name: `${p.name}-${p.mode}`,\n        count: p.mode === \"System\" ? 1 : 0,\n        orchestratorVersion: kubernetesVersion,\n        vnetSubnetID: network.subnetId,\n\n        kubeletDiskType: \"OS\",\n        osSKU: \"Ubuntu\",\n        osType: \"Linux\",\n\n        tags: {\n          ...defaultNodePool.tags,\n          mode: p.mode,\n        },\n      })),\n\n      linuxProfile: linux\n        ? {\n            adminUsername: linux.adminUsername,\n            ssh: { publicKeys: linux.sshKeys.map((k) => ({ keyData: k })) },\n          }\n        : undefined,\n\n      autoScalerProfile: {\n        balanceSimilarNodeGroups: \"true\",\n        expander: \"random\",\n        maxEmptyBulkDelete: \"10\",\n        maxGracefulTerminationSec: \"600\",\n        maxNodeProvisionTime: \"15m\",\n        maxTotalUnreadyPercentage: \"45\",\n        newPodScaleUpDelay: \"0s\",\n        okTotalUnreadyCount: \"3\",\n        scaleDownDelayAfterAdd: \"30m\",\n        scaleDownDelayAfterDelete: \"60s\",\n        scaleDownDelayAfterFailure: \"10m\",\n        scaleDownUnneededTime: \"10m\",\n        scaleDownUnreadyTime: \"20m\",\n        scaleDownUtilizationThreshold: \"0.5\",\n        scanInterval: \"60s\",\n        skipNodesWithLocalStorage: \"false\",\n        skipNodesWithSystemPods: \"true\",\n      },\n\n      // identity: !featureFlags.createServicePrincipal\n      //   ? { type: 'SystemAssigned' }\n      //   : undefined,\n      //identityProfile: {},\n\n      servicePrincipalProfile: serviceIdentity\n        ? {\n            clientId: serviceIdentity.clientId,\n            secret: serviceIdentity.clientSecret!,\n          }\n        : undefined,\n\n      podIdentityProfile: featureFlags.enablePodIdentity\n        ? {\n            enabled: featureFlags.enablePodIdentity,\n            //Not allow pod to use kublet command\n            allowNetworkPluginKubenet: false,\n          }\n        : undefined,\n\n      //Preview Features\n      //disableLocalAccounts: auth.enableAzureRBAC,\n      //autoUpgradeProfile: { upgradeChannel: containerservice.UpgradeChannel.Patch },\n\n      aadProfile: {\n        enableAzureRBAC: Boolean(aksAccess.enableAzureRBAC),\n        managed: true,\n        adminGroupObjectIDs: adminGroup ? [adminGroup.objectId] : undefined,\n        tenantID: tenantId,\n      },\n\n      networkProfile: {\n        networkMode: native.containerservice.NetworkMode.Transparent,\n        networkPolicy: native.containerservice.NetworkPolicy.Azure,\n        networkPlugin: native.containerservice.NetworkPlugin.Azure,\n\n        dnsServiceIP: \"10.0.0.10\",\n        dockerBridgeCidr: \"172.17.0.1/16\",\n        serviceCidr: \"10.0.0.0/16\",\n\n        outboundType:\n          network.enableFirewall || aksAccess.enablePrivateCluster\n            ? native.containerservice.OutboundType.UserDefinedRouting\n            : native.containerservice.OutboundType.LoadBalancer,\n\n        loadBalancerSku:\n          network.outboundIpAddress?.ipAddressId ||\n          network.enableFirewall ||\n          aksAccess.enablePrivateCluster\n            ? \"Standard\"\n            : \"Basic\",\n\n        loadBalancerProfile:\n          network.outboundIpAddress &&\n          !(network.enableFirewall || aksAccess.enablePrivateCluster)\n            ? {\n                outboundIPs: {\n                  publicIPs: [{ id: network.outboundIpAddress.ipAddressId }],\n                },\n                outboundIPPrefixes: network.outboundIpAddress.ipAddressPrefixId\n                  ? {\n                      publicIPPrefixes: [\n                        { id: network.outboundIpAddress.ipAddressPrefixId },\n                      ],\n                    }\n                  : undefined,\n              }\n            : undefined,\n      },\n    },\n    {\n      protect: lock,\n      dependsOn: serviceIdentity\n        ? [...dependsOn, serviceIdentity.resource]\n        : dependsOn,\n      import: importFrom,\n      deleteBeforeReplace: true,\n      //replaceOnChanges: [ 'servicePrincipalProfile'],\n      ignoreChanges: [\n        \"privateLinkResources\",\n        \"networkProfile\",\n        \"linuxProfile\",\n        //'windowsProfile',\n        //'servicePrincipalProfile.secret',\n      ],\n    }\n  );\n\n  if (lock) {\n    Locker({ name, resourceId: aks.id, dependsOn: aks });\n  }\n\n  if (featureFlags.enableDiagnosticSetting) {\n    aks.id.apply(async (id) => {\n      if (!id) return;\n\n      //Diagnostic\n      await createDiagnostic({\n        name,\n        targetResourceId: id,\n        ...log,\n        logsCategories: [\n          \"guard\",\n          \"kube-controller-manager\",\n          \"kube-audit-admin\",\n          \"kube-audit\",\n          \"kube-scheduler\",\n          \"cluster-autoscaler\",\n        ],\n      });\n    });\n  }\n\n  // if (enableVMAutoScale) {\n  //   //Apply auto scale\n  //   await vmsAutoScale({\n  //     group: { resourceGroupName: nodeResourceGroup },\n  //     dependsOn: aks,\n  //   });\n  // }\n\n  //Apply monitoring for VMScale Sets\n  await vmsDiagnostic({\n    group: { resourceGroupName: nodeResourceGroup },\n    ...log,\n    vaultInfo,\n    dependsOn: aks,\n  });\n\n  return { aks, privateZone };\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b7f0f5b52979dc7bd7187c7077f222f733a32224","contentHash":"deca56a5f97341d6dd64944f0c9f4bbb6246f1e5c273077e5212bda8165ed316"}}